<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Android-CTF | Bosh's Blog</title><meta name="author" content="bosh"><meta name="copyright" content="bosh"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="菜逼！！啥都记录一点 ISCC-2025整好借着打ISCC,顺便写两道WP ISCC2025-whereisflagAPK直接打开看一眼，直接看activity里面的MainActivity 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354packa">
<meta property="og:type" content="article">
<meta property="og:title" content="Android-CTF">
<meta property="og:url" content="http://example.com/2025/05/22/Android-CTF/index.html">
<meta property="og:site_name" content="Bosh&#39;s Blog">
<meta property="og:description" content="菜逼！！啥都记录一点 ISCC-2025整好借着打ISCC,顺便写两道WP ISCC2025-whereisflagAPK直接打开看一眼，直接看activity里面的MainActivity 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354packa">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://z-bosh.github.io/img/Android2.jpg">
<meta property="article:published_time" content="2025-05-22T00:00:00.000Z">
<meta property="article:modified_time" content="2025-06-01T04:57:10.980Z">
<meta property="article:author" content="bosh">
<meta property="article:tag" content="Android">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://z-bosh.github.io/img/Android2.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2025/05/22/Android-CTF/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        if (name && globalFn[key][name]) return
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Android-CTF',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-06-01 04:57:10'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/background1.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">32</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://z-bosh.github.io/img/Android2.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Bosh's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Android-CTF</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Android-CTF</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-05-22T00:00:00.000Z" title="发表于 2025-05-22 00:00:00">2025-05-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-06-01T04:57:10.980Z" title="更新于 2025-06-01 04:57:10">2025-06-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91/">安卓逆向</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>23分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>菜逼！！啥都记录一点</p>
<h1 id="ISCC-2025"><a href="#ISCC-2025" class="headerlink" title="ISCC-2025"></a>ISCC-2025</h1><p>整好借着打ISCC,顺便写两道WP</p>
<h2 id="ISCC2025-whereisflag"><a href="#ISCC2025-whereisflag" class="headerlink" title="ISCC2025-whereisflag"></a>ISCC2025-whereisflag</h2><p>APK直接打开看一眼，直接看activity里面的MainActivity</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.whereisflag;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"><span class="keyword">import</span> com.example.whereisflag.databinding.ActivityMainBinding;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> ActivityMainBinding binding;</span><br><span class="line">    <span class="keyword">private</span> EditText flagEditText;</span><br><span class="line">    <span class="keyword">private</span> Button submitButton;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.loadLibrary(<span class="string">&quot;whereisflag&quot;</span>);</span><br><span class="line">    &#125;<span class="comment">///加载本地的动态链接库，在windows就是dll，在Linux就是so</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle bundle)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(bundle);    <span class="comment">//初始化activity</span></span><br><span class="line">        </span><br><span class="line">        <span class="type">ActivityMainBinding</span> <span class="variable">inflate</span> <span class="operator">=</span> ActivityMainBinding.inflate(getLayoutInflater());</span><br><span class="line">        <span class="built_in">this</span>.binding = inflate;<span class="comment">//使用View Binding功能将XML中的控件绑定到Java中</span></span><br><span class="line">        setContentView(inflate.getRoot());<span class="comment">//加载UI界面</span></span><br><span class="line">        </span><br><span class="line">        <span class="built_in">this</span>.flagEditText = <span class="built_in">this</span>.binding.editTextFlag;</span><br><span class="line">        <span class="type">Button</span> <span class="variable">button</span> <span class="operator">=</span> <span class="built_in">this</span>.binding.button;</span><br><span class="line">        <span class="built_in">this</span>.submitButton = button;<span class="comment">//把EditText(输入flag的地方)和Button(提交按钮)分别绑定到flagEditText和submitButton成员变量。</span></span><br><span class="line">        </span><br><span class="line">        button.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123; <span class="comment">// from class: com.example.whereisflag.MainActivity.1</span></span><br><span class="line">            <span class="meta">@Override</span> <span class="comment">// android.view.View.OnClickListener</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">obj</span> <span class="operator">=</span> MainActivity.<span class="built_in">this</span>.flagEditText.getText().toString();</span><br><span class="line">                <span class="comment">//给按钮设置点击事件</span></span><br><span class="line">                <span class="comment">//当点击按钮时，取出用户在EditText中输入的文本obj</span></span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> (obj.length() != <span class="number">16</span>) &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="string">&quot;flag长度错误，请继续寻找&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                    <span class="comment">//设置判断长度</span></span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">a</span>().b(obj)) &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="string">&quot;恭喜你找到了正确的flag&quot;</span>, <span class="number">1</span>).show();</span><br><span class="line">                    <span class="comment">//调用a的方法b(obj)来校验flag是否正确</span></span><br><span class="line">                    </span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="string">&quot;flag错误，请继续寻找&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                    <span class="comment">//如果都不满足就输出失败</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>很明显，最简单的，看一下调用a的方法b</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.whereisflag;  <span class="comment">//表明这个类属于com.example.whereisflag包</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">a</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">native</span> String <span class="title function_">compute</span><span class="params">(String str)</span>;</span><br><span class="line">    <span class="comment">//compute是一个native方法，它的实现不在java中，而是在C/C++的本地代码中，通常是.so的动态链接库</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">b</span><span class="params">(String str)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (str.startsWith(<span class="string">&quot;ISCC&#123;&quot;</span>) &amp;&amp; str.endsWith(<span class="string">&quot;&#125;&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> compute(str.substring(<span class="number">5</span>, <span class="number">15</span>)).equals(<span class="string">&quot;iB3A7kSISR&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//下面就是一个校验逻辑了，我们最后的形式必须是iB3A7kSISR！</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>显而易见，这就是我们需要的flag了</p>
<p>flag的包装头ISCC{xxxxxx}</p>
<p>肯定是有加密的，让我们简单分析一下</p>
</blockquote>
<p>分析完毕，我们拆包去lib中找我们需要的加密逻辑。</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top7/202505222002856.png" alt="image-20250522200206677"></p>
<p>简单逆向分析一下咯，直接看encrypt函数 </p>
<p>喂给ai</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top7/202505222016197.png" alt="image-20250522201623078"></p>
<p><del>没有ai我怎么活呢?</del>，很明显了首先有个字符串反转，~~~然后有个换表，这里说错了，只是进行了凯撒加密，只不过对应的表换了，并不是我们常见的A-C这样~~，然后进行了凯撒加密，偏移是3</p>
<p>先找一下表吧</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top7/202505222022921.png" alt="image-20250522202232842"></p>
<p>找到了捏，<code>WHEReISFLAGBCDJKMNOPQTUVXYZabcdfghijklmnopqrstuvwxyz0123456789</code></p>
<p>逆向的话，仔细看你就会发现它其实是对着表进行偏移的，就是上面的表</p>
<p>也就是我们只需要偏移回去在倒转即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加密映射表（来自 C++ 中的 qword_4ED70）</span></span><br><span class="line">ABC = <span class="string">&quot;WHEReISFLAGBCDJKMNOPQTUVXYZabcdefghijklmnopqrstuvwxyz0123456789&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密函数（偏移 -2 后再反转）</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">encrypted: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([ABC[(ABC.index(ch) - <span class="number">2</span>) % <span class="built_in">len</span>(ABC)] <span class="keyword">for</span> ch <span class="keyword">in</span> encrypted])[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># 将 compute() 返回的密文粘贴到这里：</span></span><br><span class="line">    secret = <span class="string">&quot;iB3A7kSISR&quot;</span>  <span class="comment"># 示例密文，来自你的 Java 代码 b(str) 中的比较值</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 解密出 flag 中间部分</span></span><br><span class="line">    content = decode(secret)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 拼出完整 flag</span></span><br><span class="line">    result = <span class="string">f&quot;ISCC&#123;&#123;<span class="subst">&#123;content&#125;</span>&#125;&#125;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;解密结果：&quot;</span>, result)</span><br><span class="line"><span class="comment">##ISCC&#123;HeRei5F1Ag&#125;</span></span><br></pre></td></tr></table></figure>

<p>之后得到了flag。</p>
<p>然后就完事了，唉，怎么说呢！</p>
<p>还是比较简单的</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top7/202505222034130.png" alt="image-20250522203409814"></p>
<p>怎么说呢？现在准备还是一天一道CTF吧。（感觉做不到）</p>
<h1 id="攻防世界"><a href="#攻防世界" class="headerlink" title="攻防世界"></a>攻防世界</h1><h2 id="Android2-0"><a href="#Android2-0" class="headerlink" title="Android2.0"></a>Android2.0</h2><p>2025.5.25</p>
<p>怎么说，JADX打开，简单来说是直接看Activity</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top7/202505251258449.png" alt="image-20250525125615163"></p>
<p>基本来说，加密逻辑就在MainActivity里了</p>
<p>直接看Activity的生命周期</p>
<blockquote>
<p>onCreate()–&gt;onStart()–&gt;onResume()–&gt;onPause()–&gt;onStop()–&gt;onDestory()</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.test.ctf03;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.support.v7.app.AppCompatActivity;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    Button button;</span><br><span class="line">    EditText pwd;</span><br><span class="line">    TextView textView;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.support.v7.app.AppCompatActivity, android.support.v4.app.FragmentActivity, android.support.v4.app.BaseFragmentActivityGingerbread, android.app.Activity</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);<span class="comment">//设置布局文件activity_main.xml</span></span><br><span class="line">        init();<span class="comment">//简单来说就是初始化的</span></span><br><span class="line">        <span class="built_in">this</span>.button.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123; <span class="comment">// from class: com.example.test.ctf03.MainActivity.1</span></span><br><span class="line">            <span class="meta">@Override</span> <span class="comment">// android.view.View.OnClickListener</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">               </span><br><span class="line">                <span class="comment">///主要的逻辑在这</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> MainActivity.<span class="built_in">this</span>.pwd.getText().toString();</span><br><span class="line">                <span class="comment">///获取用户输入的字符串str</span></span><br><span class="line">                <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> JNI.getResult(str);</span><br><span class="line">                <span class="comment">///调用本地JNI方法JNI.getResult(str),传入输入进行验证</span></span><br><span class="line">                </span><br><span class="line">                MainActivity.<span class="built_in">this</span>.Show(result);  <span class="comment">//显示结果的没啥说的</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.pwd = (EditText) findViewById(R.id.pwd); <span class="comment">//输入框</span></span><br><span class="line">        <span class="built_in">this</span>.button = (Button) findViewById(R.id.button); <span class="comment">//按钮</span></span><br><span class="line">        <span class="built_in">this</span>.textView = (TextView) findViewById(R.id.result); <span class="comment">//文本显示区域</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">Show</span><span class="params">(<span class="type">int</span> type)</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                <span class="built_in">this</span>.textView.setText(<span class="string">&quot;Wrong&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                <span class="built_in">this</span>.textView.setText(<span class="string">&quot;Great&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>所以找到核心的验证加密逻辑<code>JNI.getResult(str)</code>，点进去看看</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top7/202505251312129.png" alt="image-20250525131214322"></p>
<p>加密逻辑一看就在Native层了，拆包看一下。正好lib中也只有一个.so文件（动态链接库）</p>
<p>点进去看见是ARM-32位的。</p>
<p>我点进去是先看的函数栏，找加密逻辑喽</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top7/202505251318357.png" alt="image-20250525131849300"></p>
<p>看着像分成了三段</p>
<p>其实感觉就是一个简单的拼接</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top7/202505251324079.png" alt="image-20250525132430026"></p>
<p>这个第二段和第三段在一块</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top7/202505251326323.png" alt="image-20250525132537627"></p>
<p>感觉不太对，转不成ASCLL码</p>
<p>先拼接一下试试，不太对</p>
<p>第一部分：LN^dl</p>
<p>第二部分： 5-</p>
<p>第三部分：AFBo}</p>
<p>想太多</p>
<p>我们直接看<code>Java_com_example_test_ctf03_JNI_getResult</code>这个函数，直接喂给ai看反汇编代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">Java_com_example_test_ctf03_JNI_getResult</span><span class="params">(JNIEnv *env, jobject thiz, jstring input)</span> &#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *user_input = (*env)-&gt;GetStringUTFChars(env, input, <span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> result = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strlen</span>(user_input) != <span class="number">15</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Init</span><span class="params">(<span class="type">char</span> *out1, <span class="type">char</span> *out2, <span class="type">char</span> *out3, <span class="type">const</span> <span class="type">char</span> *in, <span class="type">int</span> len)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (len &lt; <span class="number">1</span>) &#123;</span><br><span class="line">        out1[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        out2[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        out3[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义用于模拟取模操作的魔数</span></span><br><span class="line">    <span class="type">uint32_t</span> div3_magic = <span class="number">0x55555556</span>;  <span class="comment">// 1/3的乘法倒数（右移可得余数）</span></span><br><span class="line">    <span class="type">uint32_t</span> div3_magic_2 = <span class="number">0xAAAAAAAB</span>;  <span class="comment">// 类似用于除法操作</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="type">int</span> mod = i % <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (mod) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>: &#123; <span class="comment">// out1</span></span><br><span class="line">                <span class="type">uint32_t</span> idx = (i * div3_magic_2) &gt;&gt; <span class="number">1</span>;  <span class="comment">// 等效于除以2</span></span><br><span class="line">                out1[idx] = in[i];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>: &#123; <span class="comment">// out2</span></span><br><span class="line">                <span class="type">uint32_t</span> idx = (i * div3_magic_2) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                out2[idx] = in[i];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>: &#123; <span class="comment">// out3</span></span><br><span class="line">                <span class="type">uint32_t</span> idx = (i * div3_magic_2) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                out3[idx] = in[i];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 添加结束符</span></span><br><span class="line">    out1[len / <span class="number">3</span>] = <span class="number">0</span>;</span><br><span class="line">    out2[len / <span class="number">3</span>] = <span class="number">0</span>;</span><br><span class="line">    out3[len / <span class="number">3</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="type">int</span> <span class="title function_">First</span><span class="params">(<span class="type">char</span> *buf)</span> &#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> xor_key = <span class="number">0x80</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 解码前4个字节</span></span><br><span class="line">    <span class="keyword">while</span> (i &lt; <span class="number">4</span>) &#123;</span><br><span class="line">        buf[i] = (xor_key ^ (buf[i] &lt;&lt; <span class="number">1</span>)) &amp; <span class="number">0xFF</span>;  <span class="comment">// 等价于 EOR.W R3, R2, R3,LSL#1</span></span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 比较处理后的 buf 是否等于 &quot;LN^dl&quot;</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(buf, <span class="string">&quot;LN^dl&quot;</span>) == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 分配内存</span></span><br><span class="line">    <span class="type">char</span> *buf1 = <span class="built_in">malloc</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="type">char</span> *buf2 = <span class="built_in">malloc</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="type">char</span> *buf3 = <span class="built_in">malloc</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> len = <span class="number">15</span>;</span><br><span class="line">    Init(buf1, buf2, buf3, user_input, len);  <span class="comment">// 模糊处理，具体实现未知</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 如果 First(buf1) 返回非 0</span></span><br><span class="line">    <span class="keyword">if</span> (First(buf1)) &#123;</span><br><span class="line">        <span class="comment">// buf2[i] ^= buf1[i] for i in 0..3</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">            buf2[i] ^= buf1[i];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 比较 buf2 和 &quot; 5-&quot;</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">strcmp</span>(buf2, <span class="string">&quot; 5-&quot;</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">                buf3[i] ^= buf2[i];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 比较 buf3 和 &quot;AFBo&#125;&quot;</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">strcmp</span>(buf3, <span class="string">&quot;AFBo&#125;&quot;</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">                result = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>怎么说，ai还是强大的</p>
<blockquote>
<p>这里直接建议用ida9打开就好了</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top7/202505272017758.png" alt="image-20250527201725689"></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top7/202505272017255.png" alt="image-20250527201737145"></p>
</blockquote>
<p>首先知道我们要的flag长度是15，init函数把我们的字符串分成三段。first函数的加密逻辑<code>(xor_key ^ (buf[i] &lt;&lt; 1)) &amp; 0xFF;</code>，异或0x80并且左移一位，然后和<code>LN^dl</code>比较。buf2是异或buf1，buf3是异或buf2，分别与 <code>5-</code>和<code>AFBo&#125;</code>比较。</p>
<p>所以直接进行逆向解密</p>
<p><strong>part1</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">src=<span class="built_in">list</span>(<span class="string">&quot;LN^dl&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="number">0x80</span>^(<span class="built_in">ord</span>(src[i])&gt;&gt;<span class="number">1</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">dst = <span class="built_in">list</span>(<span class="string">&quot;LN^dl&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    after = <span class="built_in">ord</span>(dst[i])</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">0x80</span> ^ (c &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xFF</span>) == after:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">chr</span>(c), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="comment">###fgor</span></span><br><span class="line"><span class="comment">###注意这里只对前4个数进行了操作，所以第五个数不用变          </span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fgorl</span><br></pre></td></tr></table></figure>



<p>这里笔者进行逆向是发现不对，只能暴力破解为好</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top7/202505251424239.png" alt="image-20250525142434958"></p>
<p><strong>part2</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">buf1=<span class="string">&quot;LN^dl&quot;</span></span><br><span class="line">buf2=[<span class="number">0x20</span>, <span class="number">0x35</span>, <span class="number">0x2D</span>, <span class="number">0x16</span>, <span class="number">0x61</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(buf2[i]^<span class="built_in">ord</span>(buf1[i])),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#l&#123;sr</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###我去，这里是对加密后的buf1进行操作的</span></span><br></pre></td></tr></table></figure>

<p>看反编译代码只对前四个进行了操作，则第五个不动吗？？？？</p>
<p>所以第五个还是a</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">l&#123;sra</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意buf2肯定也还是五字节的</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top7/202505251508755.png" alt="image-20250525150821692"></p>
<p>只不过有些无法转成ASCLL而已</p>
</blockquote>
<p><strong>part3</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">buf3=<span class="string">&quot;AFBo&#125;&quot;</span></span><br><span class="line">buf2=[<span class="number">0x20</span>, <span class="number">0x35</span>, <span class="number">0x2D</span>, <span class="number">0x16</span>, <span class="number">0x61</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(buf2[i]^<span class="built_in">ord</span>(buf3[i])),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#asoy    </span></span><br></pre></td></tr></table></figure>

<p>加上第五个字符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">asoy&#125;</span><br></pre></td></tr></table></figure>

<p><strong>最终</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">buf1=<span class="string">&quot;fgorl&quot;</span></span><br><span class="line">buf2=<span class="string">&quot;l&#123;sra&quot;</span></span><br><span class="line">buf3=<span class="string">&quot;asoy&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line"> <span class="built_in">print</span>(buf1[i]+buf2[i]+buf3[i],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;sosorryla&#125;</span></span><br></pre></td></tr></table></figure>





<p><strong>总结：</strong></p>
<p>我去我去,注意笔者在part1的时候没有注意只对前4个字节进行了操作，所以踩坑了。part2的时候没注意是对加密后的buf1进行操作的又踩坑了，最终的拼接是要flag形状的。</p>
<p>怎么说呢！题出的还是非常好的</p>
<h2 id="APK逆向"><a href="#APK逆向" class="headerlink" title="APK逆向"></a>APK逆向</h2><p>—-2025.5.27</p>
<p>老样子直接拖进JADX里面看看，直接看<code>activity</code>里的<code>MainActivity</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.crackme; <span class="comment">//包名</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.Activity;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.Menu;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"><span class="comment">//导入的模块</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">Activity</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Button btn_register;  <span class="comment">//注册按钮</span></span><br><span class="line">    <span class="keyword">private</span> EditText edit_sn; <span class="comment">//输入框</span></span><br><span class="line">    String edit_userName;<span class="comment">//用户名</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.app.Activity</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);   <span class="comment">//调用父类的onCreate方法，必不可少</span></span><br><span class="line">        setContentView(R.layout.activity_main); <span class="comment">//设置页面布局的</span></span><br><span class="line">        setTitle(R.string.unregister); <span class="comment">//设置窗口标题为&quot;未注册&quot;</span></span><br><span class="line">        <span class="built_in">this</span>.edit_userName = <span class="string">&quot;Tenshine&quot;</span>;<span class="comment">//写死用户名&quot;Tenshine&quot;</span></span><br><span class="line">        <span class="built_in">this</span>.edit_sn = (EditText) findViewById(R.id.edit_sn);<span class="comment">//通过ID找到界面的输入框</span></span><br><span class="line">        <span class="built_in">this</span>.btn_register = (Button) findViewById(R.id.button_register);<span class="comment">//通过ID找到界面的注册按钮</span></span><br><span class="line">        <span class="built_in">this</span>.btn_register.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123; <span class="comment">// from class:  监听的    com.example.crackme.MainActivity.1</span></span><br><span class="line">            <span class="meta">@Override</span> <span class="comment">// android.view.View.OnClickListener</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123; <span class="comment">//点击按钮执行函数</span></span><br><span class="line">                <span class="keyword">if</span> (!MainActivity.<span class="built_in">this</span>.checkSN(MainActivity.<span class="built_in">this</span>.edit_userName.trim(),                                       MainActivity.<span class="built_in">this</span>.edit_sn.getText().toString().trim())) </span><br><span class="line">                    <span class="comment">//checkSN()方法验证用户名和序列号是否匹配</span></span><br><span class="line">                    <span class="comment">//trim()是去除空格</span></span><br><span class="line">                &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="built_in">this</span>, R.string.unsuccessed, <span class="number">0</span>).show();</span><br><span class="line">                    <span class="comment">//注册不成功</span></span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                Toast.makeText(MainActivity.<span class="built_in">this</span>, R.string.successed, <span class="number">0</span>).show();</span><br><span class="line">                  <span class="comment">//注册成功</span></span><br><span class="line">                MainActivity.<span class="built_in">this</span>.btn_register.setEnabled(<span class="literal">false</span>);</span><br><span class="line">                  <span class="comment">//禁用按钮</span></span><br><span class="line">                MainActivity.<span class="built_in">this</span>.setTitle(R.string.registered);</span><br><span class="line">                  <span class="comment">//更改注册表为已注册</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.app.Activity</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onCreateOptionsMenu</span><span class="params">(Menu menu)</span> &#123;</span><br><span class="line">        getMenuInflater().inflate(R.menu.activity_main, menu);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//创建菜单的</span></span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<p>然后我们可以雷电模拟运行一下这个APP</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top7/202505271822873.png" alt="image-20250527182215452"></p>
<p>看主要的校验逻辑吧</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">/* JADX INFO: Access modifiers changed from: private */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">checkSN</span><span class="params">(String userName, String sn)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (userName == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (userName.length() == <span class="number">0</span> || sn == <span class="literal">null</span> || sn.length() != <span class="number">22</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                <span class="comment">//限制长度和和序列号</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">MessageDigest</span> <span class="variable">digest</span> <span class="operator">=</span> MessageDigest.getInstance(<span class="string">&quot;MD5&quot;</span>);</span><br><span class="line">            digest.reset();</span><br><span class="line">            digest.update(userName.getBytes()); </span><br><span class="line">            <span class="type">byte</span>[] bytes = digest.digest();</span><br><span class="line">            <span class="comment">//创建MD5摘要器</span></span><br><span class="line">            <span class="comment">//将用户名转为字节数组进行MD5哈希计算</span></span><br><span class="line">            <span class="comment">//bytes是MD5结果</span></span><br><span class="line">            </span><br><span class="line">            <span class="type">String</span> <span class="variable">hexstr</span> <span class="operator">=</span> toHexString(bytes, <span class="string">&quot;&quot;</span>);</span><br><span class="line">            <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; hexstr.length(); i += <span class="number">2</span>) &#123;</span><br><span class="line">                sb.append(hexstr.charAt(i));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//每个一个字符取一个，拼接出新的字符串userSN</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">userSN</span> <span class="operator">=</span> sb.toString();</span><br><span class="line">            <span class="comment">//得到最终部分</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>().append(<span class="string">&quot;flag&#123;&quot;</span>).append(userSN).append(<span class="string">&quot;&#125;&quot;</span>).toString().equalsIgnoreCase(sn);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">//拼接flag&#123;userSN&#125;,并和用户输入的sn比较</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">toHexString</span><span class="params">(<span class="type">byte</span>[] bytes, String separator)</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">hexString</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">byte</span> b : bytes) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">hex</span> <span class="operator">=</span> Integer.toHexString(b &amp; <span class="number">255</span>);</span><br><span class="line">            <span class="keyword">if</span> (hex.length() == <span class="number">1</span>) &#123;</span><br><span class="line">                hexString.append(<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            hexString.append(hex).append(separator);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> hexString.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//把一个字节数组转换为十六进制字符串。</span></span><br><span class="line"><span class="comment">//例如 0x1f 会变成 &quot;1f&quot;，0x03 会变成 &quot;03&quot;。</span></span><br><span class="line"><span class="comment">//separator 参数用来控制是否在每两个字符中间插入分隔符（此程序传入 &quot;&quot;，即不加分隔）。</span></span><br><span class="line"><span class="comment">//没啥用辅助功能</span></span><br></pre></td></tr></table></figure>

<p>现在我们知道的用户名就是<code>Tenshine</code>，我们简单的MD5加密一下<code>B9C77224FF234F27AC6BADF83B855C76</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">src=<span class="string">&quot;B9C77224FF234F27AC6BADF83B855C76&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(src), <span class="number">2</span>):</span><br><span class="line">    <span class="built_in">print</span>(src[i],end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment">#BC72F242A6AF3857  </span></span><br><span class="line">flag&#123;BC72F242A6AF3857&#125;</span><br></pre></td></tr></table></figure>

<p>然后试一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top7/202505271842518.png" alt="image-20250527184249386"></p>
<blockquote>
<p>额，行吧，交的时候注意换成32小写即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bc72f242a6af3857</span><br></pre></td></tr></table></figure>
</blockquote>
<p>像这道题就是直接在Java层中找加密逻辑</p>
<h3 id="APK中的结构"><a href="#APK中的结构" class="headerlink" title="APK中的结构"></a>APK中的结构</h3><table>
<thead>
<tr>
<th>层级</th>
<th>说明</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>💡 应用层（App Layer）</td>
<td>你写的代码，比如 <code>MainActivity.java</code></td>
<td><code>com.example.crackme.MainActivity</code></td>
</tr>
<tr>
<td>🔧 Framework 层（Java Framework）</td>
<td>Android 提供的类库，比如 <code>Activity</code>, <code>Button</code>, <code>Toast</code></td>
<td><code>android.app.Activity</code></td>
</tr>
<tr>
<td>⚙️ Native 层（Native Libraries）</td>
<td>用 C&#x2F;C++ 编写的库，NDK、libc、libcrypto 等</td>
<td>可能用来做更隐蔽的加密</td>
</tr>
<tr>
<td>🧩 HAL &#x2F; Kernel 层</td>
<td>驱动层，硬件访问层</td>
<td>与 CrackMe 无关</td>
</tr>
</tbody></table>
<h2 id="人民的名义-抓捕赵德汉1-200"><a href="#人民的名义-抓捕赵德汉1-200" class="headerlink" title="人民的名义-抓捕赵德汉1-200"></a>人民的名义-抓捕赵德汉1-200</h2><p>2025.5.28</p>
<p>这次下载完是jar后缀</p>
<p>不到是啥意思，直接使用JADX打开</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top7/202505281330170.png" alt="image-20250528133009826"></p>
<p>感觉主要的加密逻辑就在这了</p>
<p>喂给ai，这是一个动态加载类并验证密码的实列过程，它把真正验证密码的类加密后嵌入资源中，运行时再动态加载并调用。</p>
<p><del>怎么说？frida hook一下吗？</del></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top7/202505281346965.png" alt="image-20250528134629882"></p>
<p>我先看看idea能进行打个断点调试吗？</p>
<p>没源码吗？这是打不开反正</p>
<p>这里也是直接看WP了</p>
<p>第一次发现jar包还能直接运行呢</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Java -jar jar包名</span><br></pre></td></tr></table></figure>

<p>然后就能运行了</p>
<blockquote>
<p>java版本太高运行不起来是正常的</p>
<p>换个低版本即可</p>
</blockquote>
<p>没啥说的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fa3733c647dca53a66cf8df953c2d539</span><br><span class="line">md5解密得到flag</span><br><span class="line">monkey99    </span><br></pre></td></tr></table></figure>

<p>这题出的不好</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/shadow20080578/article/details/124013876">XCTF_MOBILE15_人民的名义-抓捕赵德汉1-200-CSDN博客</a></p>
<h2 id="ill-intentions"><a href="#ill-intentions" class="headerlink" title="ill-intentions"></a>ill-intentions</h2><p>2025.5.31</p>
<p>JADX打开，老样子直接进行看MainActivity</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.application;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.Activity;</span><br><span class="line"><span class="keyword">import</span> android.content.BroadcastReceiver;</span><br><span class="line"><span class="keyword">import</span> android.content.IntentFilter;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"><span class="keyword">import</span> com.example.hellojni.Manifest;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">Activity</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.app.Activity</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        <span class="type">TextView</span> <span class="variable">tv</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TextView</span>(getApplicationContext());</span><br><span class="line">        tv.setText(<span class="string">&quot;Select the activity you wish to interact with.To-Do: Add buttons to select activity, for now use Send_to_Activity&quot;</span>);</span><br><span class="line">        setContentView(tv);</span><br><span class="line">        <span class="type">IntentFilter</span> <span class="variable">filter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IntentFilter</span>();</span><br><span class="line">        filter.addAction(<span class="string">&quot;com.ctf.INCOMING_INTENT&quot;</span>);</span><br><span class="line">        <span class="type">BroadcastReceiver</span> <span class="variable">receiver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Send_to_Activity</span>();</span><br><span class="line">        registerReceiver(receiver, filter, Manifest.permission._MSG, <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>简单翻译一下这句英文</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top7/202505311316835.png" alt="image-20250531131524639"></p>
<p>简单模拟一下这个APK看一下</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top7/202505311317955.png" alt="image-20250531131709886"></p>
<p>简单ai了一下MainActivity主要是显示一段引导文字，提醒用户暂时通过广播与指定的Activity交互，注册了一个广播接收器<code>Send_to_Activity</code>，监听 <code>com.ctf.INCOMING_INTENT</code>。</p>
<p>然后我们主要看<code>Send_to_Activity</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.application;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.BroadcastReceiver;</span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Send_to_Activity</span> <span class="keyword">extends</span> <span class="title class_">BroadcastReceiver</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.content.BroadcastReceiver</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onReceive</span><span class="params">(Context context, Intent intent)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">msgText</span> <span class="operator">=</span> intent.getStringExtra(<span class="string">&quot;msg&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (msgText.equalsIgnoreCase(<span class="string">&quot;ThisIsTheRealOne&quot;</span>)) &#123;</span><br><span class="line">            <span class="type">Intent</span> <span class="variable">outIntent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(context, (Class&lt;?&gt;) ThisIsTheRealOne.class);</span><br><span class="line">            context.startActivity(outIntent);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (msgText.equalsIgnoreCase(<span class="string">&quot;IsThisTheRealOne&quot;</span>)) &#123;</span><br><span class="line">            <span class="type">Intent</span> <span class="variable">outIntent2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(context, (Class&lt;?&gt;) IsThisTheRealOne.class);</span><br><span class="line">            context.startActivity(outIntent2);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (msgText.equalsIgnoreCase(<span class="string">&quot;DefinitelyNotThisOne&quot;</span>)) &#123;</span><br><span class="line">            <span class="type">Intent</span> <span class="variable">outIntent3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(context, (Class&lt;?&gt;) DefinitelyNotThisOne.class);</span><br><span class="line">            context.startActivity(outIntent3);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Toast.makeText(context, <span class="string">&quot;Which Activity do you wish to interact with?&quot;</span>, <span class="number">1</span>).show();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>监听”msg”字段的广播，根据其值启动不同的Activity</p>
<ul>
<li><p><code>&quot;ThisIsTheRealOne&quot;</code> → 启动 <code>ThisIsTheRealOne</code> 活动</p>
</li>
<li><p><code>&quot;IsThisTheRealOne&quot;</code> → 启动 <code>IsThisTheRealOne</code> 活动</p>
</li>
<li><p><code>&quot;DefinitelyNotThisOne&quot;</code> → 启动 <code>DefinitelyNotThisOne</code> 活动</p>
</li>
</ul>
<p>看一下这三个Activity会发现它的每个类都加载了一个名为hello-jni的本地库。每个类都定义了若干native方法，每个类在界面中提供了一个按钮，点击后会发送一个广播<code>com.ctf.OUTGOING_INTENT</code>，其中附带了一段加密&#x2F;处理过的<code>msg</code></p>
<p>这下简单了，直接进行拆包，看动态加载库即可</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">Java_com_example_application_IsThisTheRealOne_perhapsThis</span><span class="params">(</span></span><br><span class="line"><span class="params">        __int64 a1,</span></span><br><span class="line"><span class="params">        __int64 a2,</span></span><br><span class="line"><span class="params">        __int64 a3,</span></span><br><span class="line"><span class="params">        __int64 a4,</span></span><br><span class="line"><span class="params">        __int64 a5)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v5; <span class="comment">// r15</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *v8; <span class="comment">// r12</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *v9; <span class="comment">// rbp</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *v10; <span class="comment">// rbx</span></span><br><span class="line">  <span class="type">char</span> *v11; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v12; <span class="comment">// si</span></span><br><span class="line">  <span class="type">char</span> v14[<span class="number">80</span>]; <span class="comment">// [rsp+0h] [rbp-188h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v15[<span class="number">80</span>]; <span class="comment">// [rsp+50h] [rbp-138h] BYREF</span></span><br><span class="line">  <span class="type">char</span> dest[<span class="number">80</span>]; <span class="comment">// [rsp+A0h] [rbp-E8h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v17[<span class="number">88</span>]; <span class="comment">// [rsp+F0h] [rbp-98h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v5 = <span class="number">0LL</span>;</span><br><span class="line">  v8 = (*(*a1 + <span class="number">1352LL</span>))(a1, a3, <span class="number">0LL</span>);</span><br><span class="line">  v9 = (*(*a1 + <span class="number">1352LL</span>))(a1, a4, <span class="number">0LL</span>);</span><br><span class="line">  v10 = (*(*a1 + <span class="number">1352LL</span>))(a1, a5, <span class="number">0LL</span>);</span><br><span class="line">  v11 = &amp;v8[<span class="built_in">strlen</span>(v8)];</span><br><span class="line">  *v11 = <span class="string">&#x27;&#123;barGwnw&#x27;</span>;</span><br><span class="line">  <span class="built_in">strcpy</span>(v11 + <span class="number">16</span>, <span class="string">&quot;tfqm&#125;&quot;</span>);</span><br><span class="line">  *(v11 + <span class="number">1</span>) = <span class="string">&#x27;Cr\x7FhbtuO&#x27;</span>;</span><br><span class="line">  <span class="built_in">strncpy</span>(dest, v8, <span class="string">&#x27;L&#x27;</span>);</span><br><span class="line">  <span class="built_in">strncpy</span>(v14, v9, <span class="string">&#x27;L&#x27;</span>);</span><br><span class="line">  <span class="built_in">strncpy</span>(v15, v10, <span class="string">&#x27;L&#x27;</span>);</span><br><span class="line">  dest[<span class="number">76</span>] = <span class="number">0</span>;</span><br><span class="line">  v15[<span class="number">76</span>] = <span class="number">0</span>;</span><br><span class="line">  v14[<span class="number">76</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v12 = dest[v5] ^ v14[v5] ^ v15[v5];</span><br><span class="line">    v17[v5++] = v12;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%c\n&quot;</span>, v12);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v5 != <span class="number">76</span> );</span><br><span class="line">  v17[<span class="number">76</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Here is your Reply: %s&quot;</span>, v17);</span><br><span class="line">  <span class="keyword">return</span> (*(*a1 + <span class="number">1336LL</span>))(a1, v17);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">__int64 __fastcall <span class="title function_">Java_com_example_application_ThisIsTheRealOne_orThat</span><span class="params">(</span></span><br><span class="line"><span class="params">        __int64 a1,</span></span><br><span class="line"><span class="params">        __int64 a2,</span></span><br><span class="line"><span class="params">        __int64 a3,</span></span><br><span class="line"><span class="params">        __int64 a4,</span></span><br><span class="line"><span class="params">        __int64 a5)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v5; <span class="comment">// r15</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *v8; <span class="comment">// r12</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *v9; <span class="comment">// rbp</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *v10; <span class="comment">// rbx</span></span><br><span class="line">  <span class="type">char</span> *v11; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v12; <span class="comment">// si</span></span><br><span class="line">  <span class="type">char</span> v14[<span class="number">80</span>]; <span class="comment">// [rsp+0h] [rbp-188h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v15[<span class="number">80</span>]; <span class="comment">// [rsp+50h] [rbp-138h] BYREF</span></span><br><span class="line">  <span class="type">char</span> dest[<span class="number">80</span>]; <span class="comment">// [rsp+A0h] [rbp-E8h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v17[<span class="number">88</span>]; <span class="comment">// [rsp+F0h] [rbp-98h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v5 = <span class="number">0LL</span>;</span><br><span class="line">  v8 = (*(*a1 + <span class="number">1352LL</span>))(a1, a3, <span class="number">0LL</span>);</span><br><span class="line">  v9 = (*(*a1 + <span class="number">1352LL</span>))(a1, a4, <span class="number">0LL</span>);</span><br><span class="line">  v10 = (*(*a1 + <span class="number">1352LL</span>))(a1, a5, <span class="number">0LL</span>);</span><br><span class="line">  v11 = &amp;v8[<span class="built_in">strlen</span>(v8)];</span><br><span class="line">  *v11 = <span class="string">&#x27;[\x7FLElYIJ&#x27;</span>;</span><br><span class="line">  *(v11 + <span class="number">1</span>) = <span class="string">&#x27;n`xuz`jx&#x27;</span>;</span><br><span class="line">  *(v11 + <span class="number">2</span>) = <span class="string">&#x27;AOfz\x7FvO\x7F&#x27;</span>;</span><br><span class="line">  <span class="built_in">strcpy</span>(v11 + <span class="number">24</span>, <span class="string">&quot;RkiPkYmbFftKqusfn&#125;flhQfsqxr\\TeaSgnmdc!&quot;</span>);</span><br><span class="line">  <span class="built_in">strncpy</span>(dest, v8, <span class="string">&#x27;L&#x27;</span>);</span><br><span class="line">  <span class="built_in">strncpy</span>(v14, v9, <span class="string">&#x27;L&#x27;</span>);</span><br><span class="line">  <span class="built_in">strncpy</span>(v15, v10, <span class="string">&#x27;L&#x27;</span>);</span><br><span class="line">  dest[<span class="number">76</span>] = <span class="number">0</span>;</span><br><span class="line">  v15[<span class="number">76</span>] = <span class="number">0</span>;</span><br><span class="line">  v14[<span class="number">76</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v12 = dest[v5] ^ v14[v5] ^ v15[v5];</span><br><span class="line">    v17[v5++] = v12;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%c\n&quot;</span>, v12);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v5 != <span class="number">76</span> );</span><br><span class="line">  v17[<span class="number">76</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Here is your Reply: %s&quot;</span>, v17);</span><br><span class="line">  <span class="keyword">return</span> (*(*a1 + <span class="number">1336LL</span>))(a1, v17);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">__int64 __fastcall <span class="title function_">Java_com_example_application_DefinitelyNotThisOne_definitelyNotThis</span><span class="params">(</span></span><br><span class="line"><span class="params">        __int64 a1,</span></span><br><span class="line"><span class="params">        __int64 a2,</span></span><br><span class="line"><span class="params">        __int64 a3,</span></span><br><span class="line"><span class="params">        __int64 a4)</span></span><br><span class="line">&#123;</span><br><span class="line">  (*(*a1 + <span class="number">1352LL</span>))(a1, a3, <span class="number">0LL</span>);</span><br><span class="line">  (*(*a1 + <span class="number">1352LL</span>))(a1, a4, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">return</span> (*(*a1 + <span class="number">1336LL</span>))(a1, <span class="string">&quot;Told you so!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这三段代码里<code>ThisIsTheRealOne</code>是我们真正想要的,本来是想要动态调试一下这个.so文件的，有报错没调试起来。上网找了找</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top7/202505311500201.png" alt="image-20250531150045938"></p>
<p>照着<a target="_blank" rel="noopener" href="https://juejin.cn/post/7415725134595489804">文章</a>整了整，但是把你会发现报错，我们调试<code>android_server64</code>时他会报错<strong>Segmentation fault</strong>，然后呢我们换成<code>android x64 server</code>进行调试的时候，你又会发现我们ida又会报错</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top7/202505311504162.png" alt="image-20250531150404086"></p>
<p>SO，笔者的建议还是使用frida进行hook好了，但是笔者这里不会搓脚本，然后也是使用ai编写的了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(<span class="title class_">Module</span>.<span class="title function_">getExportByName</span>(<span class="literal">null</span>, <span class="string">&quot;dlopen&quot;</span>), &#123;</span><br><span class="line">    <span class="attr">onEnter</span>: <span class="keyword">function</span> (<span class="params">args</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">path</span> = <span class="title class_">Memory</span>.<span class="title function_">readCString</span>(args[<span class="number">0</span>]);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onLeave</span>: <span class="keyword">function</span> (<span class="params">retval</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">path</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;libhello-jni.so&quot;</span>) !== -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[*] libhello-jni.so loaded&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> base = <span class="title class_">Module</span>.<span class="title function_">findBaseAddress</span>(<span class="string">&quot;libhello-jni.so&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[*] Base address:&quot;</span>, base);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 这里根据你 readelf 得到的 offset 修改</span></span><br><span class="line">            <span class="keyword">var</span> target = base.<span class="title function_">add</span>(<span class="number">0x6c0</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[*] Hook target function at&quot;</span>, target);</span><br><span class="line"></span><br><span class="line">            <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(target, &#123;</span><br><span class="line">                <span class="attr">onEnter</span>: <span class="keyword">function</span> (<span class="params">args</span>) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[*] Function called&quot;</span>);</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Arg0: &quot;</span> + args[<span class="number">0</span>]);</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Arg1: &quot;</span> + args[<span class="number">1</span>]);</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">onLeave</span>: <span class="keyword">function</span> (<span class="params">retval</span>) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[*] Return value:&quot;</span>, retval);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>不咋会用frida</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top7/202505311518148.png" alt="image-20250531151801026"></p>
<p>hook之后应该做什么哇？这里直接也是看WP了</p>
<p>下面直接贴hook脚本了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">DefinitelyNotThisOneHandler</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;com.example.application.DefinitelyNotThisOne&#x27;</span>)</span><br><span class="line">    <span class="title class_">DefinitelyNotThisOneHandler</span>.<span class="property">definitelyNotThis</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">arg0, arg1</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;DefinitelyNotThisOneHandler called: &#x27;</span> + arg0 + <span class="string">&quot;  \n&quot;</span> + arg1)</span><br><span class="line">        <span class="keyword">var</span> ret = <span class="variable language_">this</span>.<span class="title function_">definitelyNotThis</span>(arg0, arg1)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;DefinitelyNotThisOneHandler ret: &#x27;</span> + ret )</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">ThisIsTheRealOneHandler</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;com.example.application.ThisIsTheRealOne&#x27;</span>)</span><br><span class="line">    <span class="title class_">ThisIsTheRealOneHandler</span>.<span class="property">orThat</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">arg0, arg1, arg2</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ThisIsTheRealOneHandler called: &#x27;</span> + arg0 + <span class="string">&quot;  \n&quot;</span> + arg1 + <span class="string">&quot;  \n&quot;</span> + arg2)</span><br><span class="line">        <span class="keyword">var</span> ret =  <span class="variable language_">this</span>.<span class="title function_">orThat</span>(arg0, arg1, arg2)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ThisIsTheRealOneHandler ret: &#x27;</span> + ret )</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">IsThisTheRealOneHandler</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;com.example.application.IsThisTheRealOne&#x27;</span>)</span><br><span class="line">    <span class="title class_">IsThisTheRealOneHandler</span>.<span class="property">perhapsThis</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">arg0, arg1, arg2</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;IsThisTheRealOneHandler called: &#x27;</span> + arg0 + <span class="string">&quot;  \n&quot;</span> + arg1 + <span class="string">&quot;  \n&quot;</span> + arg2)</span><br><span class="line">        <span class="keyword">var</span> ret =  <span class="variable language_">this</span>.<span class="title function_">perhapsThis</span>(arg0, arg1, arg2)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;IsThisTheRealOneHandler ret: &#x27;</span> + ret )</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main)</span><br><span class="line"></span><br><span class="line"><span class="comment">//firda-ps -U</span></span><br><span class="line"><span class="comment">//frida -U -n &quot;CTF Application&quot; -l hook.js</span></span><br></pre></td></tr></table></figure>

<p>步骤就不说了，<del>不会hook的，简单去学一下吧，或者看一下笔者的另一篇文章。</del></p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top7/202505311611928.png" alt="image-20250531161101809"></p>
<p>hook上之后，要在模拟器那边简单触发一下。</p>
<blockquote>
<p>这里讲一下<code>objection</code></p>
<p>它是基于frida的命令工具，主要用于对 <strong>Android 和 iOS 应用的动态分析</strong>，尤其适合逆向工程、安全测试和 CTF 挖洞。</p>
<p>常见的功能如下：</p>
<table>
<thead>
<tr>
<th>功能</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>explore</code></td>
<td>进入应用交互控制台</td>
</tr>
<tr>
<td><code>android hooking</code></td>
<td>Hook Java 方法、类和 native 函数</td>
</tr>
<tr>
<td><code>android intent</code></td>
<td>启动 Activity，查看 intent 内容</td>
</tr>
<tr>
<td><code>android memory</code></td>
<td>查看内存中的字符串、对象等</td>
</tr>
<tr>
<td><code>android keystore</code></td>
<td>与系统 Keystore 交互</td>
</tr>
<tr>
<td><code>android file download</code></td>
<td>下载应用内部的文件</td>
</tr>
<tr>
<td><code>android sslpinning disable</code></td>
<td>绕过 SSL Pinning（HTTPS 拦截）</td>
</tr>
<tr>
<td><code>android misc</code></td>
<td>常用的辅助操作，如截图、剪贴板查看等</td>
</tr>
</tbody></table>
<p>命令</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;objection -g com.example.hellojni explore</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;CLI中输入</span><br><span class="line">&gt;android intent launch_activity com.example.application.IsThisTheRealOne</span><br><span class="line">&gt;android hooking watch class_method android.content.Intent.putExtra --dump-return --dump-args --dump-backtrace</span><br></pre></td></tr></table></figure>

<p>然后我们hook的时候就可以看见把拦截的信息打印下来了</p>
<p><img src="https://raw.githubusercontent.com/Z-bosh/picture/img/img/top7/202505311608496.png" alt="image-20250531160841428"></p>
<p>bananaship师傅说还是很好用的，简单了解一下吧</p>
</blockquote>
<p><strong>总结：</strong></p>
<p>学的东西还是挺多的，至少ida的对安卓设备的调试会了，虽说没有用上。hook也是学上了，对frida的了解又加深了。对hook脚本的编写希望能在进一些。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">bosh</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2025/05/22/Android-CTF/">http://example.com/2025/05/22/Android-CTF/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://example.com" target="_blank">Bosh's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Android/">Android</a></div><div class="post-share"><div class="social-share" data-image="https://z-bosh.github.io/img/Android2.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="next-post pull-full" href="/2025/05/20/%E5%88%9D%E8%AF%86Android/" title="初识Android"><img class="cover" src="https://z-bosh.github.io/img/Android1.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">初识Android</div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a href="/2025/05/02/Android%E9%80%86%E5%90%91/" title="Android逆向"><img class="cover" src="https://z-bosh.github.io/img/Android.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-02</div><div class="title">Android逆向</div></div></a><a href="/2025/05/20/%E5%88%9D%E8%AF%86Android/" title="初识Android"><img class="cover" src="https://z-bosh.github.io/img/Android1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-20</div><div class="title">初识Android</div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">bosh</div><div class="author-info-description">努力学习中~</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">32</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Z-bosh"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">阿拉山口卖囊的小伙说：阿达西！买囊不？</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ISCC-2025"><span class="toc-number">1.</span> <span class="toc-text">ISCC-2025</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ISCC2025-whereisflag"><span class="toc-number">1.1.</span> <span class="toc-text">ISCC2025-whereisflag</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C"><span class="toc-number">2.</span> <span class="toc-text">攻防世界</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Android2-0"><span class="toc-number">2.1.</span> <span class="toc-text">Android2.0</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#APK%E9%80%86%E5%90%91"><span class="toc-number">2.2.</span> <span class="toc-text">APK逆向</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#APK%E4%B8%AD%E7%9A%84%E7%BB%93%E6%9E%84"><span class="toc-number">2.2.1.</span> <span class="toc-text">APK中的结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%BA%E6%B0%91%E7%9A%84%E5%90%8D%E4%B9%89-%E6%8A%93%E6%8D%95%E8%B5%B5%E5%BE%B7%E6%B1%891-200"><span class="toc-number">2.3.</span> <span class="toc-text">人民的名义-抓捕赵德汉1-200</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ill-intentions"><span class="toc-number">2.4.</span> <span class="toc-text">ill-intentions</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/05/22/Android-CTF/" title="Android-CTF"><img src="https://z-bosh.github.io/img/Android2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android-CTF"/></a><div class="content"><a class="title" href="/2025/05/22/Android-CTF/" title="Android-CTF">Android-CTF</a><time datetime="2025-05-22T00:00:00.000Z" title="发表于 2025-05-22 00:00:00">2025-05-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/20/%E5%88%9D%E8%AF%86Android/" title="初识Android"><img src="https://z-bosh.github.io/img/Android1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="初识Android"/></a><div class="content"><a class="title" href="/2025/05/20/%E5%88%9D%E8%AF%86Android/" title="初识Android">初识Android</a><time datetime="2025-05-20T00:00:00.000Z" title="发表于 2025-05-20 00:00:00">2025-05-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/02/Android%E9%80%86%E5%90%91/" title="Android逆向"><img src="https://z-bosh.github.io/img/Android.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android逆向"/></a><div class="content"><a class="title" href="/2025/05/02/Android%E9%80%86%E5%90%91/" title="Android逆向">Android逆向</a><time datetime="2025-05-02T00:00:00.000Z" title="发表于 2025-05-02 00:00:00">2025-05-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/26/shellcode%E5%92%8C%E5%8A%A0%E8%BD%BD%E5%99%A8/" title="shellcode和加载器"><img src="https://z-bosh.github.io/img/kill.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="shellcode和加载器"/></a><div class="content"><a class="title" href="/2025/03/26/shellcode%E5%92%8C%E5%8A%A0%E8%BD%BD%E5%99%A8/" title="shellcode和加载器">shellcode和加载器</a><time datetime="2025-03-26T00:00:00.000Z" title="发表于 2025-03-26 00:00:00">2025-03-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/20/%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%AE%BE%E5%A4%87%E5%90%8E%E9%97%A8%E4%B8%8Eshellcode%E7%94%9F%E6%88%90%E5%B7%A5%E5%85%B7/" title="嵌入式设备后门工具的利用"><img src="https://z-bosh.github.io/img/leak3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="嵌入式设备后门工具的利用"/></a><div class="content"><a class="title" href="/2025/03/20/%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%AE%BE%E5%A4%87%E5%90%8E%E9%97%A8%E4%B8%8Eshellcode%E7%94%9F%E6%88%90%E5%B7%A5%E5%85%B7/" title="嵌入式设备后门工具的利用">嵌入式设备后门工具的利用</a><time datetime="2025-03-20T00:00:00.000Z" title="发表于 2025-03-20 00:00:00">2025-03-20</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/background.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2025 By bosh</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="Rweb,Pwn,Reverse,Linux,CTF,heap,stack" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>